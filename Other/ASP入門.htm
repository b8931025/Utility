<head>
<meta http-equiv="Content-Language" content="zh-tw">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>ASP入門班課程講義</title>
<style>
<!--

	ul {color:darkred;}
body         { font-size: 11 pt; letter-spacing: 1pt; vertical-align: medium }
a:active     { color: #000080 }
-->
</style>
</head>
<body style="font-size: 11 pt" topmargin="2" leftmargin="2">

<h1 style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
<font face="標楷體">
<span style="letter-spacing: 1pt; vertical-align: baseline"><span lang="en-us">
ASP</span></span></font><span style="vertical-align: baseline"><font face="標楷體">程式寫作入門</font></span></h1>

<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="right">
編寫：黃自強&nbsp; 　<a href="mailto:dd@tp.edu.tw">dd@mail.ysps.tp.edu.tw</a> </p>

<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="right">
李忠憲 <a href="mailto:shane@mail.spps.tp.edu.tw">shane@mail.spps.tp.edu.tw</a> </p>
<h3 style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
寫在前面</h3>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　　不管您是為了個人興趣，或是純粹為了工作需要來學習ASP程式設計，學習方法上是很重要的。從不斷嚐試錯誤中學習而得的經驗固然可貴，但是在學習效果上並不好。</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  　　這裡建議的能力培養順序應該是：</p>
  <ol>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    熟練 html 語法（學習網頁編寫能力）</li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    了解IIS／ASP的運作原理（系統管理能力）</li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    了解IE4.0以上的DHTML／CSS（網頁元件物件控制能力）</li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    Java/VB 等Client端 Script( Client 端檢查/控制能力）</li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    ASP六大物件和語法及ActiveX元件使用（Server 端 Script 控制能力）</li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    資料庫設計/分析（資料庫規劃能力）</li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    SQL語法（資料庫增刪修等管理能力）</li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    ActiveX元件設計／網頁美工設計（非必要能力，會的話更好）</li>
  </ol>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  　　以上條列的能力對非資訊專長出身的國小教師來說，是零散、複雜需逐步整合及長時間進修培養的。<span style="letter-spacing: 1pt; vertical-align: baseline">尋找坊間的書籍和網路上的ASP教學站台，罕有人把這些學習內容整合成教學文件 ，能夠讓學習者以〝站在高崗上向下望〞的角度去學習ASP程式設計。除了 Html 和 
  ActiveX<span lang="en-us"> </span>兩項外，本文嘗試盡量以介紹／實作的方式，來循序介紹以上系列課程。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  希望您讀完本課程後，再從眼底看網頁程式寫作這件事情，能像 Matrix(駭客任務)片尾 Neo 眼裡所看到的電腦人和牆壁一樣，變得條理清晰、了然於心。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  <span style="vertical-align: baseline">　</span><span style="letter-spacing: 1pt; vertical-align: baseline">　雖然 
  ASP.NET 好像又要開始在 Windows Server 2003 上引領風騷、Linux/windows 上Unix/PC 雙作業系統都能跑的 
  Apache / PHP / MySQL 
  也不斷推出整合、功能強大又完善、而且免費的新套件，但是對台北市中小學目前的系管/網管需求而言，ASP還算是滿好用的工具，因為它簡單且能快速上手，非常適合WEB應用程式開發入門。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">　</p>
</blockquote>
<h3 style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
壹<b>、ＡＳＰ簡介</b></h3>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">　　微軟公司的ASP (Active 
  Server Pages) 是一種在伺服器端執行的描述程式稿(Server Side Scripting ) 。ASP<span lang="en-us">
  </span>程式碼在<span lang="en-us"> </span>Server<span lang="en-us"> </span>端執行後，Web 
  Server(IIS)<span lang="en-us"> </span>會送出<span lang="en-us"> </span>HTML<span lang="en-us">
  </span>標籤與文件給用戶端，用戶端就可以從瀏覽器上看到互動的網頁資料和內容。它不像一般的用戶端描述程式稿(如<span lang="en-us">
  </span>Java 
  Script<span lang="en-us"> </span>)是在客戶端電腦上的瀏覽器執行，因此<span lang="en-us"> </span>ASP<span lang="en-us">
  </span>程式並不會發生因為使用者用了不同的瀏覽器而有因為不完全支援程式設計者所寫的<span lang="en-us"> </span>Script<span lang="en-us">
  </span>的情況。也就是說使用<span lang="en-us"> </span>ASP，一般來說不用擔心用戶端的瀏覽器是否版本支援程式創作者的程式稿。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline; font-weight:700">
  ASP的執行環境</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  目前支援<span lang="en-us"> </span>ASP<span lang="en-us"> </span>的Web Server<span lang="en-us">
  </span>有<span lang="en-us"> </span>MicroSoft WinNT/2000/XP<span lang="en-us">
  </span>的IIS 4.0/5.0/5.1 及<span lang="en-us"> </span>Windows 
  98/SE/ME<span lang="en-us"> </span>的<span lang="en-us"> </span>PWS(Personal Web Server)。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  　　您可以在自己的<span lang="en-us"> </span>Windows98/ME/NT/2000/XP<span lang="en-us">
  </span>電腦上安裝<span lang="en-us"> </span>IIS/PWS 作<span lang="en-us"> </span>ASP<span lang="en-us">
  </span>程式寫作練習，然後再用瀏覽器透過 
  http（內定為Port80）的方式，來連上自己電腦上的<span lang="en-us"> </span>WEB&nbsp; Server，並可看到自己的<span lang="en-us">
  </span>ASP<span lang="en-us"> </span>執行後的結果，開啟的方法有：</span></p>
  <table border="1" cellpadding="2" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="90%" id="AutoNumber18">
    <tr>
      <td width="100%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      開啟本機站台，無需網路連線：&nbsp;<a href="http://localhost/">http://localhost/</a>&nbsp;&nbsp;
      <a href="http://127.0.0.1/">http://127.0.0.1/</a>&nbsp;
      <a href="http://john/">http://john/</a></span></td>
    </tr>
    <tr>
      <td width="100%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      開啟遠端站台，有網路連線：[虛擬ip]<a href="http://192.x.x.1/">http://192.x.x.1/</a>&nbsp; 
      [真實ip]<a href="http://163.21.224.4/">http://163.21.224.4/</a>&nbsp;&nbsp; 
      [區網內]<a href="http://john/">http://john/</a></span></td>
    </tr>
    <tr>
      <td width="100%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      開啟遠端站台，有網路連線及dns註冊登記： <a href="http://dd.ysps.tp.edu.tw/">
      http://dd.ysps.tp.edu.tw/</a></span></td>
    </tr>
  </table>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">　在本機安裝 IIS 
  的做法，通常是網頁設計者在網頁設計階段使用的，Windwos 2000 
  Professional<span lang="en-us"> </span>版也和<span lang="en-us"> </span>ＰＷＳ<span lang="en-us">
  </span>一樣小器，有10個連線上限的限制。真的要架設<span lang="en-us"> </span>IIS<span lang="en-us">
  </span>網站伺服器，應該在有安裝<span lang="en-us"> </span>Win2000 
  Server<span lang="en-us"> </span>版的機器上安裝<span lang="en-us"> </span>IIS。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline; font-weight:700">ASP的優缺點</span></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt; font-weight:700">
    ASP的優勢</span></p>
  </blockquote>
  <ol>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    使用描述程式稿語言<span lang="en-us"> </span>(Javascript 或 VBScript)<span lang="en-us">
    </span>編寫。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    簡單易學，不太需要高深的程式設計基礎。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    用記事本就可拿來編寫，縮短網路程式開發時間。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    完全嵌入<span lang="en-us"> </span>HTML<span lang="en-us"> </span>裡頭，與<span lang="en-us">
    </span>HTML、Script<span lang="en-us"> </span>語言結合 。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    不需要經過手動編譯(compile)或透過連結程式（Linker）來聯結函式。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">可以抓來的或是自製的 
    ActiveX 元件擴充程式功能。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    可存取多種類型資料庫(SQL、mdb、xls、text...)。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    可用多種程式語言(VB、Delphi、VC....)設計自己的<span lang="en-us"> </span>ActiveX Server<span lang="en-us">
    </span>元件，不用考慮瀏覽器的相容性問題 。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    程式碼是隱藏的，在用戶端僅可看到由<span lang="en-us"> </span>ASP<span lang="en-us"> </span>輸出的動態<span lang="en-us">
    </span>DHTML<span lang="en-us"> </span>文件。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    網路上教學範例站台多，範例程式和學習資源都非常豐富。</span></li>
  </ol>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt; font-weight:700">
    ASP的缺憾</span></p>
  </blockquote>
  <ol>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    只能使用<span lang="en-us"> </span>Microsoft的NT/2000 Server<span lang="en-us">
    </span>的<span lang="en-us"> </span>IIS<span lang="en-us"> </span>當<span lang="en-us">
    </span>Web Server，Unix<span lang="en-us"> </span>上執行需另外安裝<span lang="en-us"> 
    mod_perl </span>和 mod_asp 套件。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    Win98/ME/NT/2000/XP<span lang="en-us"> </span>等<span lang="en-us"> </span>WorkStation(Professional)<span lang="en-us">
    </span>版的作業系統上，安裝 PWS / IIS<span lang="en-us"> </span>有10個連線的限制。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    Windows/IIS 作業系統的漏洞百出，需要管理者經常關心修補(patch)，以避免駭客或 Cracker 利用系統漏洞入侵IIS竊取或毀損重要資料。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">Windows Server 主機 
    軟體昂貴，需要另外購買 SQL 存取使用權。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">MS-</span><span style="letter-spacing: 1pt; vertical-align: baseline">SQL 資料庫 
    效率高但軟體版權昂貴。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    大量使用者上線時，用 MDB 當後端資料庫站台的效能不是很好。</span></li>
  </ol>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline; letter-spacing: 1pt; font-weight:700">
  ASP程式設計/編修工具</span></p>
  <ol>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    記事本：無行號，免費，最陽春的工具，必須熟悉 HTML 及 VBscript 語法；而且，必須自己找上傳的工具，例如 ftp 程式。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">微軟(MS) script 
    Debugger：有行號，免費，不錯的工具，使用介面友善，認得 HTML 及 VBscript 語法，有專案管理的功能，但是沒有上傳的工具。 </span></li>
  </ol>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht102.jpg" width="718" height="537"></span><ol>
    <li value="3">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    微軟(MS)Frontpage2000/2002：有行號于狀態列顯示，專業的網頁設計工具，使用介面友善，認得 HTML 及 VBscript 語法，有網站管理的功能，提供 Web 發送精靈上傳網頁。但 FrontPage 有時會把 
    ASP 網頁當作 HTML 而改成亂七八糟，一般都是把使用者介面、表單等先用 FrontPage 設計好，再使用 editpule 等工具編寫 ASP 程式碼。</span></li>
  </ol>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.03.gif" width="677" height="513"></span><ol>
    <li value="4">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    (Macromedia)Dreamweaver<span lang="en-us">/UltraDev</span>：專業的網頁設計工具，獲得多項所見即所得獎項，使用介面友善，支援 CSS，認得 HTML、Javascript 及 VBscript、ASP 語法，有網站管理的功能，提供 ftp 上傳的介面工具。</span></li>
  </ol>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其他編輯軟體，推薦 
  Editplus2：ShareWare，支援中文、有程式行號、支援正規表示式、巨集取代、函數自動變色、認得HTML、Javascript 及 VBscript、ASP、Perl、PHP、C 等語法，支援 PC/Mac/UNIX 檔案格式，有 html 預覽功能，直接拖曳圖片自動產生 html 
  tag 等等功能，是小而美的軟體。下載 
  <a href="http://www.spps.tp.edu.tw/download/win/文書編輯/editplus.zip">
  editplus.zip</a> ShareWare版。</span></p>
  </blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;</span><script language="JavaScript">
  </script><img border="0" src="images/ASP.04.gif" width="583" height="403"></p>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#808080">習題：請把電腦上的Editplus安裝和進階設定完成。</font></p>
  </blockquote>
<hr>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
<h3 style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
貳<b>、</b><span style="vertical-align: baseline">ASP與六大物件的運作方式:</span></h3>
<blockquote>
  <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
  　　ASP 是一種內嵌在網頁中的 CGI（共通閘道介面）。CGI 是一種由 Web Server 
  執行的應用程式，執行時間上因為 CGI 要將程式處理的結果丟回給 Web Server，因此有時間上的限制（預設值為 90 
  秒）。也就是說，我們在設計程式的時後要考量執行效率，不能超過 Time Out，常見的做法是將大型系統分解成許多小支程式來撰寫。</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">　</span><span style="letter-spacing: 1pt; vertical-align: baseline">　ASP 
  與傳統 CGI 應用程式不同之處，在於<span lang="en-us"> CGI </span>是以獨立程序在獨立記憶體空間執行，<span lang="en-us">ASP
  </span>則是以<span lang="en-us"> Web Server </span>的子程序在<span lang="en-us"> Web 
  Server </span>規劃的記憶體內執行，前者安全性較高，後者效能較好。由於<span lang="en-us"> CGI </span>
  採用的語言比較艱深冷僻，寫作難度較高，而 ASP 是為了大幅簡化開發 Web<span lang="en-us"> Computing</span> 所設計的
  ，採用<span lang="en-us"> VB Script </span>這種初階基礎語言，比較友善易於親近。</span></p>
  <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
  　　我們來看看ASP 是怎樣透過六個內建物件，來完成其 CGI 運作機制的：<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 400">&nbsp;</span></p>
  <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8" align="left">
  <span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  ASP運作概圖（取自IIS Help）</span></p>
  <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8" align="center">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  <img src="images/00_02.gif" width="428" height="346"></span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <ol>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      當Web Server開機跑起來後，首先執行的是 <b>Application物件</b>，它定義了啟動IIS後Web站台運作所需的整體變數，並且會把這些變數一直放在記憶體中，等待ASP程式存取，一直到IIS 
      Shutdown才消失。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      當我們打開瀏覽器並輸入網址，也就是對Web Server送出 Request 要求，Web Server會自動進行 <b>MIME 判別</b>，並採取Windows一貫慣用的方法，也就是從檔案的附加檔名去判斷要交給哪個<span lang="en-us">
      </span>DLL<span lang="en-us"> </span>來執行或解譯。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      如果發現要處理的檔案附檔名是 .ASP 類型的檔案，就將此檔案交給 ASP.DLL 這個動態連結函式庫處理，它會將先將 Web Server 
      所收到的 URI 處理好，並儲存到記憶體裡面， 我們在寫 ASP 程式時可以用 <b>Request 物件</b>將這些資料取出來使用，同時讀取程式碼進行解譯和執行。Request 
      變數的有效期間較短，只能維持到 ASP 程式執行完畢之前。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      執行ASP程式時如果發生錯誤，就會進行錯誤處理，自動將程序中斷，並且傳送錯誤訊息給Web伺服器傳送給瀏覽器。如果能順利執行完畢，則將結果使用 
      <b>Response</b> <b>物件</b>傳送給Web Server，然後再由<span lang="en-us"> Web Server
      </span>將網頁傳給使用者的瀏覽器。Response 變數會在 buffer 停留很短的時間，當 buffer 功能未開啟時，則直接送回給參觀者，而不儲存在記憶體內。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      ASP 動態函式庫一旦執行，就會常駐在記憶體內，一直到關機為止才結束(稱為 in-process)，因此它的執行效能遠高於附加檔名是 exe 或 
      com 的應用程式(通常這一類應用程式的執行方式就稱為 out-process)。由於使用 in-process 方式處理，所以 ASP 的內建物件 
      Application 才有辦法運作。也正因為ASP屬於 in-process 的關係，所以如果想要變更 ASP 
      相關的系統設定，必須將伺服器重新開機才會生效。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      <b>Session 物件</b>用來維護每個瀏覽器連線的資訊，當我們要讓ASP程式能夠根據不同身分執行不同功能的時候，就會使用 
      Session 變數。此變數的有效時間預設是20分鐘，但是有〝連選得連任〞的特性，也就是說當網頁重新整理(Reload)後，Session的有效時間也跟著延長。但最長也只能維持到瀏覽器關閉，或清除 cookie 為止。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      與伺服器有關的相關設定，則是透過<b> Server 物件</b>來與 Web Server 溝通，例如：呼叫自家的函式庫、修改 Timeout 
      設定、讀取主目錄的絕對路徑、使用 HTML 或 URL 編碼(Encode) 法來處理 Response 變數等。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      <b>ObjectContext</b> 物件則是與 CGI 運作機制不相干的物件，它用來管理 MTS（Microsoft Transaction 
      Server）。MTS<span lang="en-us"> </span>允許在執行程式前先紀錄伺服器狀態，如果有部分程式執行失敗，則可以退回到
      先前的狀態，只有當所有相關程式跑完且執行成功後，才會真正登錄改變後的伺服器狀態，就像是我們為 ASP 
      程式設定了還原點一樣，可以避免程式執行失敗之後，要自行復原伺服器狀態的麻煩。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      MTS 通常使用在有需要較高的安全性、和多個程式需要作〝同步〞的場合，一般我們是用不到的。由於 MTS 
      對於記憶體的需求較高，如果我們網站設計上沒有這個需要，卻故意去使用它，那麼將會白白浪費許多Web Server 的系統資源。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      ASP 僅能以 IUSR_WebServer 這個帳號來執行，造成許多伺服器管理的工作必須以 administrator 權限來執行，所以 ASP 
      無法呼叫 WindowsAPI 來取得系統帳號和應用在伺服器管理工作上，例如：帳號管理、設定檔案目錄權限、修改系統登錄......等等。 </li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      ActiveX 物件是將想要達成特定目的的程式封存在一起，形成一個獨立自足的物件。我們只要在ASP程式中對系統提出建立該物件的需要( 
      Server.CreatObject)，就可以完成特定工作，不需要再去編寫程式碼。ActiveX 
      物件讓我們可以像堆積木一樣的方式來設計程式，使得程式設計越來越快，越來越容易。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      微軟公司基於ASP受限較多，因此開發了一些給 ASP 專用的 ActiveX 物件，例如我們常見的 計數器、廣告輪撥器（Ad 
      Rotator）、檔案系統物件（FSO）、資料庫物件（ADO）、SMTP元件...等等。</li>
      <li>
      <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8">
      ASP 所編寫的程式，並無法編譯成 ActiveX 
      物件，這就讓許多程式設計師，無法將成果作品編譯後打包發行，如果想要分享就必須公開原始程式碼，再不然只能 
      把程式碼編密；前者會與作者的利益衝突，後者則需保留原始程式碼，每次修改後都還要再進行一次編密，超難維護。</li>
    </ol>
    <p style="word-spacing: 1; line-height: 150%; margin-top: 8; margin-bottom: 8" align="right">
    <font color="#808080">本文編修自李忠憲老師 asp概論一文,原文網址: </font>
    <a href="http://www.spps.tp.edu.tw/documents/memo/asp_web_design.htm">
    <font color="#808080">
    http://www.spps.tp.edu.tw/documents/memo/asp_web_design.htm</font></a><font color="#808080">
    </font>
  </div>
<p align="left" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<font color="#808080">作業:請用自己的方式敘述 IIS與六大物件的運作關係</font></p>
</blockquote>
<hr>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
　</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
<b><font size="4">&#21441;、ＡＳＰ程式設計</font></b></p>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  經過上面的暖身，您是不是已經手癢想要開始設計ASP程式了呢？</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  關於程式設計這個議題，先要給各位的建議是：多看、多思考、多寫和不怕錯！</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(一)、ASP 基礎練習</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  　　現在假設您已經安裝好了IIS，我們可以用文字編輯器，如<span lang="en-us"> </span>EditPlus，開啟一個<span lang="en-us">
  </span>HTML<span lang="en-us"> </span>文件，當作編寫<span lang="en-us"> </span>ASP<span lang="en-us">
  </span>程式的視窗，並且把文件存成副檔名為 .asp 
  存檔到<span lang="en-us"> </span>c:\Inetpub\wwwroot\test.asp；另外再用瀏覽器輸入網址 <u>
  <font color="#0000FF">http://你的電腦名稱/test.asp</font></u> 來一面寫，一面測試自己寫的ASP程式。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  我們先來看看ASP程式碼怎樣放到html文件中使用</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  &nbsp;&lt;html&gt;</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">&nbsp;&nbsp;&nbsp; 
  &lt;body&gt;</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  <b>&nbsp;&nbsp; &lt;% ...這一段是ASP程式碼...... %&gt;</b></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">&nbsp;&nbsp;&nbsp; 
  &lt;body&gt;</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  &lt;/html&gt;</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">以下幾種使用&lt;% %&gt;符號來把 
  asp 程式碼放入HTML中的方法，都是合語法規定可被接受的：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">左右夾</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    例：<b>&lt;% response.write &quot;我來了!&quot; %&gt;</b></span></div>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">換行夾:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 例：<b>&lt;% response.write &quot;我來了!親愛的asp!&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    %&gt;</b></span></div>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">三明治夾法:<br>
    <b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    &lt;%<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;我來了!親愛的asp!&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    %&gt;</b></span></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  有時候，我們會在程式碼裡面加註一些說明文字，來幫助我們在編寫程式或偵錯程式時，容易閱讀，寫法像這樣：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; </span>
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% 　' 
    這個是註解的符號，這行asp不會被執行</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '第二行也是一樣</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;Hello World !&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    　%&gt;</div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  我們也習慣用鍵盤左邊的定位鍵(Tab鍵)來把程式碼作縮排，以方便閱讀和判斷程式區塊，例如：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    &lt;%<br>
&nbsp;&nbsp;&nbsp; if sex = &quot;boy&quot;&nbsp; then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write &quot;你是男生&quot;</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    else</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;你是女生&quot;</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    end if<br>
    %&gt;</div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  以上幾種方法我們要常常提醒自己，養成寫作習慣，對未來寫作ＡＳＰ程式幫助很大。</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>Response<span lang="en-us"> </span>物件裡的<span lang="en-us"> </span>Write<span lang="en-us">
  </span>方法</b></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    　　ASP 中使用 <b>物件<span lang="en-us">.</span>方法</b> 這樣的語法，這跟前面介紹的<span lang="en-us"> 
    JavaScript </span>是一樣的: </p>
  </blockquote>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <b>&nbsp;&nbsp;&nbsp; </b>Response.Write &quot;要印出來的字串&quot;</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <b>&nbsp;&nbsp;&nbsp; </b>response.write &quot;要印出來的字串&quot;</div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　　這樣的語法用來把文字印到瀏覽器上，您一定已經從上面的例子了解了。值得注意的是，ASP 
  程式碼中使用到的物件，其實是不分大小寫的，這和<span lang="en-us"> JavaScript </span>會區分大小寫是不同的，但為了容易閱讀，大家還是習慣把字首大寫。</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  Response.write 除了可以印出字串以外，他也可以用來印出函數或變數的值，例如我想印出現在的日期和時間，可以用：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">&lt;%&nbsp;&nbsp; 
    response.write now( ) %&gt;</span></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline; letter-spacing: 1pt">　　其中 now() 
  是一個<span lang="en-us"> </span>VB<span lang="en-us"> </span>的內建函式，所謂內建函式，簡單來說，就是古聖先賢已經替您寫好的程式碼片段，而您只要呼叫他來用就好了。利用函
  式我們可以節省很多的程式撰寫時間，就像我們要去旅行，開車去加油站加無鉛汽油就好了，不必自己買設備和原油來煉油。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline; letter-spacing: 1pt">在ASP裡面我們可以把 &lt;% 
  response.write&nbsp; 變數或函式%&gt; 簡化寫成&lt;% = 變數或函式 %&gt; ，下面兩行印出的結果是一樣的︰</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">&lt;%&nbsp;&nbsp; 
    response.write now( ) %&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">&lt;%&nbsp;&nbsp; = 
    now( ) %&gt;</span></div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="vertical-align: baseline; letter-spacing: 1pt"><br>
</span>
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(二)、</span><span style="vertical-align: baseline; letter-spacing: 1pt"><b>使用變數</b></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">ASP 
  跟大多數的程式語言一樣，指定值給變數的方法是相同的：</span><span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  變數名稱</span><span style="letter-spacing: 1pt; vertical-align: baseline">　＝　值</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">例如：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <blockquote>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%　<font color="#808080">'指定數值 
      40 給變數 cake</font><br>
&nbsp;&nbsp;&nbsp; cake = 40 </span></p>
    </blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;<font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '把變數 text 的值印到瀏覽器上</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;奶油蛋糕單價 = &quot;&nbsp; &amp; text&nbsp; &amp; &quot;元&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    %&gt;</span></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  本段程式碼中的新面孔〝＆〞符號的功能是用來連接<span lang="en-us"> </span>Response.write<span lang="en-us">
  </span>後面的　&#65282;字串&#65282;和　&#65282;變數&#65282;的。回想一下，<span lang="en-us">JavaScript
  </span>則是使用〝<span lang="en-us">+</span>〞，不要搞混了！</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  上面這段程式印出的是：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">奶油蛋糕單價 = 40元</span></div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(三)、</span><span style="vertical-align: baseline; font-weight: 700">函數裡的函數?</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  函數可以在括弧中再引用另一個函數，例如：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&lt;% = year(now())</span><span style="letter-spacing: 1pt; vertical-align: baseline"> 
    %&gt;</span></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">處理的順序是先用括弧裡的 now() 
  函數取得現在的日期，再把這個值傳回給 year() 函數，<span lang="en-us">year() </span>
  函數會篩選出年份部分的資料，最後會印出目前的西元年份</span><span style="vertical-align: baseline; letter-spacing: 1pt">。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">看看下面的程式：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">用now( )函數印出日期時間 
    : &lt;% =now()%&gt; </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;hr&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    用幾種不同的時間函數分別印出:&lt;br&gt;<br>
    今天是中華民國<br>
    &lt;% =year(now())-1911 %&gt; 年<br>
    &lt;% =month(now()) %&gt; 月<br>
    &lt;% =day(now()) %&gt; 日<br>
    星期 &lt;% =weekday(now())-1 %&gt;<br>
    時間是&lt;% =time() %&gt;</span></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">結果是：</span></p>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="50%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <img border="0" src="images/ASP.as5.jpg" width="640" height="384"></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(四)、</span><span style="letter-spacing: 1pt; vertical-align: baseline; font-weight:700"><a href="http://dd.ysps.tp.edu.tw/ASP範例/範例2_簡單的for-next迴圈.asp" target="_blank" style="text-decoration: none"><font color="#000000">簡單的<span lang="en-us"> 
F</span>or<span lang="en-us">...N</span>ext<span lang="en-us"> </span>迴圈</font></a></span></p>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
我們可以把重複性的工作交給迴圈。ASP<span lang="en-us"> </span>延襲<span lang="en-us"> </span>VB<span lang="en-us">
</span>的 For... Next<span lang="en-us"> </span>迴圈語法，例如：</span></p>
<blockquote>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;!-- 以下是簡單的迴圈 
    --&gt; </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
    &lt;%</span><span style="vertical-align: baseline"> '由小到大</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp; 
    for i = 1 to 7 %&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    第&lt;% =i %&gt;次:&lt;font size=&quot;&lt;% =i %&gt;&quot; face=&quot;標楷體&quot;&gt;印出字形尺寸由小到大[font size=</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span><span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% =i%&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span><span style="letter-spacing: 1pt; vertical-align: baseline">
    ]&lt;br&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
    &lt;% next %&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;hr&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
    &lt;%</span><span style="vertical-align: baseline"> '由大到小</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    for i = 7 to 1 step -1 %&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    第&lt;% =i %&gt;次:&lt;font size=&quot;&lt;% =i %&gt;&quot; face=&quot;標楷體&quot;&gt;印出字形尺寸由大到小[font size=</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span><span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% =i%&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span><span style="letter-spacing: 1pt; vertical-align: baseline">
    ]&lt;br&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% next %&gt;</span></div>
  <p>印出的結果是:</p>
</blockquote>
<div align="center">
  <center>
  <table width="90%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="100%">
      <!-- 以下是簡單的迴圈 --><img border="0" src="images/ASP.as6.jpg" width="629" height="424"><br>
　</td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  For ...Next 迴圈中使用step = -1 來控制變數 i 的值由大到小，網頁程式中我們常常會看到有年、月、日可以挑選的下拉式表單</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    請挑選：<select size="1" name="year">
    <option><% =year(now()) - 1911+1 %></option>
    <option selected><% =year(now()) - 1911%></option>
    <option><% =year(now()) - 1911 -1 %></option>
    </select>年<select size="1" name="month"><% for i = 1 to 12 %>
    <% if i = month(now()) then %>
    <option selected value="<% =i%>"><% =i%></option>
    <% else%>
    <option><% =i%></option>
    <% end if %> <% next%></select>月份的計畫</div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  大部分月份或日期就是用迴圈跑出來的。</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    請挑選：&lt;select size=&quot;1&quot; name=&quot;year&quot;&gt;<br>
    &lt;option&gt;<b>&lt;% =year(now())-1911+1 %&gt;</b>&lt;/option&gt;<br>
    &lt;option&gt;<b>&lt;% =year(now())-1911 %&gt;</b>&lt;/option&gt;<br>
    &lt;option&gt;<b>&lt;% =year(now())-1911-1 %&gt;</b>&lt;/option&gt;<br>
    &lt;/select&gt;年</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    &lt;select size=&quot;1&quot; name=&quot;month&quot;&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;% for i = 1 to 12 </p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    &nbsp;<font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if i &lt; 10 then
    </font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    <font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    i=&quot;0&quot; &amp; i</font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    <font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if</font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">&nbsp;&nbsp;&nbsp; 
    %&gt;</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">&nbsp;&nbsp;&nbsp; 
    &lt;option&gt; &lt;% =i %&gt; &lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;% next %&gt;<br>
    &lt;/select&gt;月份的計畫<br>
　</div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(五)、</span><span style="letter-spacing: 1pt; vertical-align: baseline; font-weight:700"><a href="http://dd.ysps.tp.edu.tw/ASP範例/範例3_簡單的if判斷.asp" style="text-decoration: none"><font color="#000000">If..<span lang="en-us">.</span>Then 
條件判斷</font></a></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
  <span style="vertical-align: baseline">上題的灰色文字部分就是我們常用的 I<span lang="en-us">f</span>.. Then&nbsp;敘述，通常用在程式的流程控制，除了一般的數值大小判斷外、它也可以判斷真、偽值，或字串內容。要特別記住的是：IF..Then 
  敘述以 End 
  IF<span lang="en-us"> </span>來結束判斷。可以使用巢狀判斷式。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">上例中的：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    if i &lt; 10 then </p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    i=&quot;0&quot; &amp; i</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    end if</div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
  意思是：當 i 的值小於10的時候前面要自動補&quot;0&quot;</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  以下是另一個依照現在時間自動判斷要用哪個問候語來問候訪客： </span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">' 
    把現在時間的[時]的值，指定給 my_Hour 這個變數</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">&nbsp;&nbsp;&nbsp; 
    my_Hour = Hour(Now())</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
    If my_Hour &lt; 12 Then </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '判斷式的前段 [if ....then ]</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    Greeting = &quot;現在是&quot; &amp; my_Hour &amp; &quot;點，早起的鳥兒有蟲吃&quot; </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '注意:印出字串要用雙引號來夾住，印出變數則不必.而印出的字串和變數之間要用 &amp;[讀作:and] 符號來連接</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">&nbsp;&nbsp;&nbsp; 
    Else </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp; </span>
    </p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    Greeting = &quot;現在是&quot; &amp; my_Hour &amp; &quot;點，午餐吃的飽嗎?&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
    End If <br>
    '判斷式的結尾 </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline; font-weight:700">
    &lt;%　= Greeting %&gt;</span></div>
  <font color="#800000">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
  執行結果：</p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    <img border="0" src="images/ASP.as7.jpg" width="493" height="271"></p>
  </blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#808080">作業:續接上題例，請寫一個包含年、月、日、時的下拉式表單，並且能自動跳到現在的年月日和時間的ASP程式。</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#808080">（提示：下面的提示幫您做到了年、月請把日、時補上）</font></p>
  </font>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    請挑選：&lt;select size=&quot;1&quot; name=&quot;year&quot;&gt;<br>
    &lt;option&gt; &lt;% =year(now()) - 1911+1 %&gt;&lt;/option&gt;<br>
    &lt;option selected&gt;&lt;% =year(now()) - 1911%&gt;&lt;/option&gt;<br>
    &lt;option&gt;&lt;% =year(now()) - 1911 -1 %&gt;&lt;/option&gt;<br>
    &lt;/select&gt;年&lt;select size=&quot;1&quot; name=&quot;month&quot;&gt;<br>
    &lt;% for i = 1 to 12 %&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;% if i = month(now()) then %&gt;</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    &lt;option selected value=&quot;&lt;% =i%&gt;&quot;&gt;&lt;% =i%&gt;&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;% else%&gt;</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    &lt;option&gt;&lt;% =i%&gt;&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;% end if %&gt;<br>
    &lt;% next%&gt;<br>
    &lt;/select&gt;月份的計畫&lt;/p&gt;</div>
  <font color="#800000"></font>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">　　ASP </span>
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  中所使用的變數，不像其他的程式語言，需要事先宣告，也沒有大小寫的問題。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">　</span><span style="letter-spacing: 1pt; vertical-align: baseline">　ASP中的變數在 
  IIS 
  上實際執行的生命週期，通常只有一瞬間，當程式執行結束，變數也歸零。雖然如此，我們在替變數命名時，還是要盡量避免變數名稱取得太簡單、太接近，因為容易造成誤解造成日後維護程式的困難。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  變數不能用數字來命名，至少要有一個字母。</span><span style="letter-spacing: 1pt; vertical-align: baseline">下面對變數的命名就是一個失敗的例子：</span></p>
  <font color="#800000">
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">7=&quot;7&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">5=&quot;L2&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">21 = 46*3</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">if = 3-4</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">day() &lt;<span lang="en-us"> 
    &quot;String&quot;</span> </span>
  </div>
  </font>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">　</span><span style="letter-spacing: 1pt; vertical-align: baseline">　 
  如果我們養成習慣使用 my_name、start_day、this_table 等方式作為變數名稱，閱讀和維護起來都算清晰容易。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  如果</span><span style="letter-spacing: 1pt; vertical-align: baseline">判斷式要判斷的情形太過複雜，我們可以加上〝 
  Else〞語句，以加廣判斷的範圍，例如：</span></p>
  <font color="#800000">
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&lt;%</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
    my_age=request(&quot;age&quot;)</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp; if my_age &gt;= 
    30 then</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;30而立&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; elseif my_age &gt;= 
    40</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;40而不惑&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; elseif my_age &gt;= 
    50</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;50而知天命&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; else</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    response.write &quot;年輕人,立志向學!&quot;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; end if </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;%&gt;</span></div>
  </font>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(六)、</span><b>Select <span lang="en-us">Case </span>條件判斷</b></p>
  <blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">和<span lang="en-us">
</span>
  <span style="vertical-align: baseline">I<span lang="en-us">f</span>.. Then</span><span lang="en-us">
</span>一樣，用來做分支判斷，但僅適用於判斷同一個值的變化，它會根據<span lang="en-us"> </span>case 的值有所不同，
而執行不同的程式片斷。判斷式的結尾使用<span lang="en-us"> End Select </span>敘述，例如：</p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<b>number </b>= int( request(&quot;my_number&quot;))</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
Select&nbsp; case&nbsp; <b>number</b></p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
case 1 </p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
response.write &quot;number = 1&quot;</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
case 2</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
response.write &quot;number = 2&quot;</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
case 3</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
response.write &quot;number = 3&quot;</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
end Select</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
    </div>
  </blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(七)、</span><b>While...Wend<span lang="en-us"> </span>迴圈</b></p>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
這個迴圈最常被用來作逐筆讀取資料錄用的迴圈，當條件成立執行下面的敘述，直到條件不成立。結尾行是〝Wend〞。</p>
<blockquote>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while not rs.eof</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i=i+1</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rs.movenext</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wend</p>
  </div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(八)、</span><b>Do...<span lang="en-us">L</span>oop 迴圈</b></p>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Do until 
後面跟著條件式，當條件符合的話，執行下面的敘述，直到條件不成立。結尾行是〝loop〞。</p>
<blockquote>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    x=100</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;
    do until x <span lang="en-us">&lt;</span> <span lang="en-us">1</span><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    x = x- 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write x &amp; &quot;&lt;br&gt;&quot;<br>
    &nbsp;&nbsp;&nbsp;
    loop</div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
下面的寫法，作用相同：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    x=100</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    do<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    x = x- 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write x &amp; &quot;&lt;br&gt;&quot;<br>
    &nbsp;&nbsp;&nbsp;
    loop<span lang="en-us"> while</span> x<span lang="en-us">&gt;1</span></div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
　</p>
</blockquote>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(九)、</span><b>For Each x&nbsp; in y&nbsp; 迴圈</b></p>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y 必須是一個陣列或物件集合，<span lang="en-us">x
</span>是一個變數。<span lang="en-us">For Each </span>會逐筆取出 y 
陣列裡面的各個元素，再指定給 x 。結尾行是〝next〞。</p>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
底下這個範例，將會逐一讀取上個網頁所送出的表單資料（<span lang="en-us">Request.Form</span>），並將所有的值輸出在網頁上：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp; 
    for<span lang="en-us"> </span>each <b><span lang="en-us">data</span></b> in 
    <b><span lang="en-us">Request.Form</span></b><p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>&nbsp; response.write
    <span lang="en-us">&quot;</span>表單元件<span lang="en-us">&quot; &amp; data &amp; &quot;</span>的值是<span lang="en-us">&quot; 
    &amp; Request(data) &amp; &quot;&lt;br&gt;&quot;</span><p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp; next</div>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
　</p>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十)、</span><b><span style="vertical-align: baseline">Response.redirect </span>
<span style="letter-spacing: 1pt; vertical-align: baseline">
<a href="http://dd.ysps.tp.edu.tw/ASP範例/範例4_網頁轉向.asp" target="_blank">網頁轉向</a></span></b></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  Response 物件的另外一種常見的用法是 Redirect，它可以讓程式執行到這裡時，對 Server 重新送出新網址的要求，看起來就是從這個網頁轉向到另外一個網頁，寫法為　Response.Redirect。</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 我們也可以使用 
    Server.Trasfer 物件來轉向網頁，不同的是 Server.Trasfer 的處理是由 Server 
    端直接掌管轉向的工作，Response.redirect 則是由 Client 端發送網頁轉向的要求。 </span>
  </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  下一個例子我們要先準備好星期日到星期六的網頁，共計七個檔案。檔名類推是〝星期~.htm〞，網頁內容各編寫成不同的訊息。例如：</span></p>
  <table border="1" cellpadding="2" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="90%" id="AutoNumber25" height="181">
    <tr>
      <td width="23%" align="center" height="30" bgcolor="#E2F7DB">
      <span style="vertical-align: baseline; font-weight: 700">
      html檔名</span></td>
      <td width="77%" height="30" bgcolor="#E2F7DB">
      <p align="center">
      <span style="vertical-align: baseline; font-weight: 700">
      html裡的內容</span></td>
    </tr>
    <tr>
      <td width="23%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期0.htm</span></td>
      <td width="77%" height="16">&lt;html&gt;&lt;body&gt;今天星期日<span style="vertical-align: baseline">，猴子過生日</span>&lt;/body&gt;&lt;/html&gt;</td>
    </tr>
    <tr>
      <td width="23%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期1.htm</span></td>
      <td width="77%" height="16">&lt;html&gt;&lt;body&gt;今天星期一<span style="vertical-align: baseline">，猴子穿新衣</span>&lt;/body&gt;&lt;/html&gt;</td>
    </tr>
    <tr>
      <td width="23%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期2.htm</span></td>
      <td width="77%" height="16">&lt;html&gt;&lt;body&gt;今天星期二<span style="vertical-align: baseline">，猴子肚子餓</span>&lt;/body&gt;&lt;/html&gt;</td>
    </tr>
    <tr>
      <td width="23%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期3.htm</span></td>
      <td width="77%" height="16">&lt;html&gt;&lt;body&gt;今天星期三<span style="vertical-align: baseline">，猴子去爬山</span>&lt;/body&gt;&lt;/html&gt;</td>
    </tr>
    <tr>
      <td width="23%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期4.htm</span></td>
      <td width="77%" height="16">&lt;html&gt;&lt;body&gt;今天星期四<span style="vertical-align: baseline">，猴子要考試</span>&lt;/body&gt;&lt;/html&gt;</td>
    </tr>
    <tr>
      <td width="23%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期5.htm</span></td>
      <td width="77%" height="16">&lt;html&gt;&lt;body&gt;今天星期五<span style="vertical-align: baseline">，猴子去跳舞</span>&lt;/body&gt;&lt;/html&gt;</td>
    </tr>
    <tr>
      <td width="23%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期6.htm</span></td>
      <td width="77%" height="16">&lt;html&gt;&lt;body&gt;今天星期六<span style="vertical-align: baseline">，猴子去斗六</span>&lt;/body&gt;&lt;/html&gt;</td>
    </tr>
  </table>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 想法：我們可以使用 weekday() 
  函數取得今天是星期幾，然後再把網頁轉到這個函數傳回的數值專屬的網頁檔案。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 但是</span><span style="letter-spacing: 1pt; vertical-align: baseline">實際上 
  weekday( ) 函數取得的數值，和我們想法有一點出入：</span></p>
  <table border="1" cellpadding="2" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="90%" id="AutoNumber26" height="205">
    <tr>
      <td width="54%" height="33" bgcolor="#E2F7DB">
      <p align="center"><b>weekday(now())取得的值</b></td>
      <td width="26%" height="33" bgcolor="#E2F7DB">
      <p align="center"><b>要轉向的檔名</b></td>
    </tr>
    <tr>
      <td width="54%" height="16" align="center"><b>weekday(</b><span style="vertical-align: baseline; ">星期日</span><b>) 
      = </b>1</td>
      <td width="26%" height="16">
      <p align="center">
      <span style="vertical-align: baseline; ">星期0.htm</span></td>
    </tr>
    <tr>
      <td width="54%" height="16" align="center"><b>weekday(</b><span style="vertical-align: baseline; ">星期一</span><b>) 
      = </b>2</td>
      <td width="9%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期1.htm</span></td>
    </tr>
    <tr>
      <td width="54%" height="16" align="center"><b>weekday(</b><span style="vertical-align: baseline; ">星期二</span><b>) 
      = </b>3</td>
      <td width="9%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期2.htm</span></td>
    </tr>
    <tr>
      <td width="54%" height="16" align="center"><b>weekday(</b><span style="vertical-align: baseline; ">星期三</span><b>) 
      = </b>4</td>
      <td width="9%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期3.htm</span></td>
    </tr>
    <tr>
      <td width="54%" height="16" align="center"><b>weekday(</b><span style="vertical-align: baseline; ">星期四</span><b>) 
      = </b>5</td>
      <td width="9%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期4.htm</span></td>
    </tr>
    <tr>
      <td width="54%" height="16" align="center"><b>weekday(</b><span style="vertical-align: baseline; ">星期五</span><b>) 
      = </b>6</td>
      <td width="9%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期5.htm</span></td>
    </tr>
    <tr>
      <td width="54%" height="16" align="center"><b>weekday</b><span style="vertical-align: baseline; ">星期六</span><b>) 
      = </b>7</td>
      <td width="9%" align="center" height="16">
      <span style="vertical-align: baseline; ">星期6.htm</span></td>
    </tr>
  </table>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
  所以我們在 weekday(now()) 函數取出星期的值之後，要記得減去<span style="letter-spacing: 1pt; vertical-align: baseline"> 
  1：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&lt;% 
    my_week=weekday(now()-1)%&gt; </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% 
    response.redirect &quot;星期&quot; &amp; my_week &amp; &quot;.htm&quot; %&gt;</span></div>
  <p>今天是星期六，執行後出現的結果是：</p>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td width="50%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <img border="0" src="images/ASP.as8.jpg" width="493" height="271"></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  上例這種網頁轉向的功能可以用來讓訪客一周裡面的每一天都看到不同的網頁，我們也可以用校內外電腦的ＩＰ來做自動判斷，如此，就可以讓校內師生和校外訪客看到的網頁內容不一樣了。</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十一)、A<a href="http://dd.ysps.tp.edu.tw/ASP範例/範例5_application網頁計數器.asp" style="text-decoration: none"><font color="#000000">pplication<span lang="en-us">
</span>物件</font></a>的應用</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  Application變數始於IIS啟動，一直要到關機才消失。算是壽命最長的變數了，我們可以利用Application 的這個特性來做網頁訪客計數器：</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' 先鎖住application變數，避免多位瀏覽者同時存取<br>
&nbsp;&nbsp;&nbsp; application.lock </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span><span style="letter-spacing: 1pt; vertical-align: baseline">
    '把application變數的值加一後，重新指定給application變數<br>
&nbsp;&nbsp;&nbsp; application(&quot;count&quot;)=application(&quot;count&quot;)+1</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '記得要解除</span><span style="letter-spacing: 1pt; vertical-align: baseline">application變數</span><span style="vertical-align: baseline; letter-spacing: 1pt">鎖定<br>
&nbsp;&nbsp;&nbsp; application.unlock</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">%&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">您是本站第 &lt;% 
    =application(&quot;count&quot;) %&gt; 位參觀者</span></div>
  <p>結果是：</p>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="50%"><img border="0" src="images/ASP.as4.jpg" width="506" height="269"></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
  <blockquote>
    <p align="left" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">註:</span></p>
    <p align="left" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">　Application 變數在 
    IIS 關掉後就會消失，所以要設計可靠的訪客計數器，比較可行的方法是用<span lang="en-us"> </span>FSO<span lang="en-us">
    </span>物件寫入文字檔，或將訪客數寫入資料庫中。</span></p>
    <p align="left" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp; 
    常見的使用 Application 的例子是聊天室和線上人數這兩類的程式。</span><span style="vertical-align: baseline">也因為<span lang="en-us">
    </span></span><span style="letter-spacing: 1pt; vertical-align: baseline">Application 
    變數存活期間很長，相對要耗用主機上較多的系統資源，不斷耗用系統資源造成系統資源不足主機當機，只好重新啟動電腦才能將資源釋出，所以一個好的網站管理員
    會有節制的使用<span lang="en-us"> </span>Application<span lang="en-us"> </span>物件。</span></p>
  </blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十二)、<a href="http://dd.ysps.tp.edu.tw/ASP範例/範例6_網址列傳值.asp" target="_blank" style="text-decoration: none"><font color="#000000">網址列傳值</font></a></span></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">ASP程式可以透過<span lang="en-us"> Request
    </span>物件取得從網址列輸入的資料，請看以下範例：</span></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% 
      my_answer=request(&quot;ans&quot;) %&gt; </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      請在網址列輸入→?ans=1~9 或A~Z</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;hr&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%<font color="#008000"> 
      '如果有輸入了</font><br>
      if my_answer&lt;&gt;&quot;&quot; then %&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
      您輸入的 ans = &lt;font color=&quot;red&quot; size=&quot;7&quot;&gt;&lt;% =my_answer%&gt; </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%
      <font color="#008000">'否則印出尚未輸入的訊息</font><br>
      else %&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
      您尚未在網址列輸入資料</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% end if %&gt;</span></div>
    <p>本範例執行的結果：</p>
  </blockquote>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="39%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <img border="0" src="images/ASP.as2.jpg" width="509" height="295"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <img border="0" src="images/ASP.as3.jpg" width="509" height="295"></td>
    </tr>
  </table>
  </center>
</div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十三)、<a href="http://dd.ysps.tp.edu.tw/ASP範例/範例7_利用表單傳值.asp" target="_blank" style="text-decoration: none"><font color="#000000">表單傳值</font></a></span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% 
    my_answer=request(&quot;ans&quot;) %&gt; </span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">form 
    method=&quot;POST&quot;&nbsp; name=&quot;ex7&quot;&nbsp; action=&quot;範例7_利用表單傳值.asp&quot;&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;請輸入您的暱稱 : 
    &lt;input type=&quot;text&quot; name=&quot;ans&quot; size=&quot;20&quot;&gt; <br>
    &lt;input type=&quot;submit&quot; value=&quot;提交&quot; name=&quot;B1&quot;&gt;&lt;input type=&quot;reset&quot; value=&quot;重新設定&quot; 
    name=&quot;B2&quot;&gt;&lt;/p&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;/form&gt;&lt;hr&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的暱稱是 : &lt;font 
    color=&quot;red&quot; size=&quot;7&quot;&gt;</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% =my_answer%&gt; </span></div>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td width="50%">
      <form name="ex77" action="http://dd.ysps.tp.edu.tw/範例7_利用表單傳值.asp" method="post">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">請輸入您的暱稱 :
        <font face="新細明體"><input name="ans" size="20"></font> </span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <font face="新細明體">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        <input type="submit" value="提交" name="B1"><input type="reset" value="重新設定" name="B2"></span></font></p>
      </form>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 </span></p>
      <hr>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的暱稱是 :
      </span></p>
      </td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十四)、</span><span style="letter-spacing: 1pt; vertical-align: baseline"><a href="http://dd.ysps.tp.edu.tw/ASP範例/範例8_表單傳值給自己.asp" target="_blank" style="text-decoration: none; font-weight: 700"><font color="#000000">表單傳值給自己</font></a></span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <font size="2" face="Arial">&lt;%
    <font color="#008000">'把表單傳來的值分別指定給三個變數<br>
    ' request(&quot;值&quot;)是較省略的寫法.也可以寫為 request.form (&quot;值&quot;)，但是這樣就一需要用表單來傳 </font>
    </font></span>
    <font size="2">
    </p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="vertical-align: baseline; letter-spacing: 1pt">
    my_answer=request(&quot;ans&quot;)</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="vertical-align: baseline; letter-spacing: 1pt">
    my_email=request(&quot;email&quot;)</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="vertical-align: baseline; letter-spacing: 1pt">
    my_option=request(&quot;option&quot;)</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">%&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    &lt;html&gt;&lt;body&gt;.....略...</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;form 
    method=&quot;POST&quot; name=&quot;ex7&quot; action=&quot;範例8_表單傳值給自己.asp&quot;&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;請輸入您的暱稱 : 
    &lt;input type=&quot;text&quot; name=&quot;ans&quot; size=&quot;20&quot;&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;您的電子郵件:&lt;input 
    type=&quot;text&quot; name=&quot;email&quot; size=&quot;20&quot;&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;您對本站的意見 : 
    &lt;textarea rows=&quot;2&quot; name=&quot;option&quot; cols=&quot;49&quot;&gt;&lt;/textarea&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;　&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p 
    align=&quot;center&quot;&gt;&amp;nbsp; &lt;input type=&quot;submit&quot; value=&quot;提交&quot; name=&quot;B1&quot;&gt;&lt;input 
    type=&quot;reset&quot; value=&quot;重新設定&quot; name=&quot;B2&quot;&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;/form&gt;&lt;hr&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%
    <font color="#008000">'判斷三個欄位都填寫了，而且也有傳來值</font></span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">if my_answer&lt;&gt;&quot;&quot; 
    and&nbsp; my_email&lt;&gt;&quot;&quot;&nbsp; and&nbsp; my_option&lt;&gt;&quot;&quot; then</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">%&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">謝謝您!!</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;hr&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的暱稱是 : &lt;font 
    color=&quot;red&quot; size=&quot;7&quot;&gt;&lt;% =my_answer %&gt; &lt;br&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的EMAIL是 : 
    &lt;font color=&quot;green&quot; size=&quot;7&quot;&gt;&lt;% =my_email %&gt; 
    &lt;br&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的意見是 : &lt;font 
    color=&quot;blue&quot; size=&quot;7&quot;&gt;&lt;% =my_option %&gt; </span>
    </font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%<font color="#008000">'別忘了判斷式結尾</font></span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">else</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="vertical-align: baseline; letter-spacing: 1pt">response.write 
    &quot;您有欄位沒填寫&quot;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">end if%&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    </font>
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <font size="2" face="Arial">&lt;/body&gt;&lt;/html&gt;</font></span></p>
    </div>
</blockquote>
<div align="center">
  <blockquote>
    <p align="left">執行結果：</p>
  </blockquote>
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="50%">　<form name="ex17" action="http://dd.ysps.tp.edu.tw/範例8_表單傳值給自己.asp" method="post">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">請輸入您的暱稱 :
        <font face="新細明體"><input name="ans" size="20"></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">您的電子郵件:<font face="新細明體"><input name="email" size="20"></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">您對本站的意見 :
        <font face="新細明體"><textarea name="option" cols="49" rows="3"></textarea></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
        <p align="center" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;
        <font face="新細明體"><input type="submit" value="提交" name="B1"><input type="reset" value="重新設定" name="B2"></font></span></p>
      </form>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 </span></p>
      <hr>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您有欄位沒填寫 </span>
      </td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十五)、<a href="http://dd.ysps.tp.edu.tw/ASP範例/範例9_把表單傳值給另一個asp程式處理.asp" target="_blank" style="text-decoration: none"><font color="#000000">表單傳值給另一支<span lang="en-us"> 
ASP </span>程式</font></a></span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <font size="2" face="Arial">&lt;table 
    border=&quot;1&quot; width=&quot;100%&quot;&gt; </font> </span>
    <font size="2"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;tr&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;td width=&quot;50%&quot;&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;form 
    method=&quot;POST&quot; name=&quot;ex7&quot; action=&quot;範例9_的結果.asp&quot;&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;h1 
    align=&quot;center&quot;&gt;&lt;font color=&quot;#FF0000&quot;&gt;訪客留言&lt;/h1&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;請輸入您的暱稱 : 
    &lt;input type=&quot;text&quot; name=&quot;ans&quot; size=&quot;20&quot;&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    &lt;p&gt;輸入您的電子郵件:&lt;input type=&quot;text&quot; name=&quot;email&quot; size=&quot;20&quot;&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;寫下您對本站的意見 : 
    &lt;textarea rows=&quot;4&quot; name=&quot;option&quot; cols=&quot;49&quot;&gt;&lt;/textarea&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;hr&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p 
    align=&quot;center&quot;&gt;&amp;nbsp; &lt;input type=&quot;submit&quot; value=&quot;送出我填寫的表單內容&quot; 
    name=&quot;B1&quot;&gt;&lt;input type=&quot;reset&quot; value=&quot;擦掉重寫&quot; name=&quot;B2&quot;&gt;&lt;/p&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;/form&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;&lt;/td&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;td 
    width=&quot;50%&quot;&gt;　&lt;/td&gt;&lt;/tr&gt;</span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    </font>
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <font size="2" face="Arial">&lt;/table&gt;</font></span></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">執行後看起來像這樣：</span></p>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="50%">
      <form name="ex27" action="http://dd.ysps.tp.edu.tw/範例9_的結果.asp" method="post">
        <p align="center" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">訪客留言</span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">請輸入您的暱稱 :
        <font face="新細明體"><input name="ans" size="20"></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">輸入您的電子郵件:<font face="新細明體"><input name="email" size="20"></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">寫下您對本站的意見 :
        <font face="新細明體"><textarea name="option" rows="4" cols="45"></textarea></font></span></p>
        <hr>
        <p align="center" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;
        <font face="新細明體"><input type="submit" value="送出我填寫的表單內容" name="B1"><input type="reset" value="擦掉重寫" name="B2"></font></span></p>
      </form>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十六)、接受傳值的<span lang="en-us"> ASP </span>程式<a href="http://dd.ysps.tp.edu.tw/ASP範例/範例9_的結果.asp" style="text-decoration: none"><font color="#000000">將</font></a>表單<a href="http://dd.ysps.tp.edu.tw/ASP範例/範例9_的結果.asp" style="text-decoration: none"><font color="#000000">資料印出</font></a></span></p>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="50%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;% 
      '把表單傳來的值分別指定給三個變數 </font> </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">my_answer=request(&quot;ans&quot;)</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">my_email=request(&quot;email&quot;)</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">my_option=request(&quot;option&quot;)</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">%&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;html&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;head&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;meta 
      http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=big5&quot;&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;title&gt;範例9的結果&lt;/title&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;/head&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;body&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;table 
      border=&quot;1&quot; width=&quot;100%&quot;&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;tr&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;td 
      width=&quot;50%&quot;&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;hr&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;% '判斷有沒有傳來值</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">if 
      my_answer&lt;&gt;&quot;&quot; and my_email&lt;&gt;&quot;&quot; and my_option&lt;&gt;&quot;&quot; then</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">%&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">謝謝您!!前面的表單已經把值傳來，列出如下</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;hr&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">您輸入的暱稱是 : 
      &lt;font color=&quot;red&quot; size=&quot;7&quot;&gt;&lt;% =my_answer %&gt; 
      &lt;br&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">您輸入的EMAIL是 : 
      &lt;font color=&quot;green&quot; size=&quot;7&quot;&gt;&lt;% =my_email %&gt; 
      &lt;br&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">您輸入的意見是 : 
      &lt;font color=&quot;blue&quot; size=&quot;7&quot;&gt;&lt;% =my_option %&gt;
      </font> </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;% else%&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;font size=&quot;7&quot; 
      color=&quot;red&quot;&gt;您尚未填寫完成留言版，</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;hr&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">請按&lt;a 
      href=&quot;範例9_把表單傳值給另一個asp程式處理.asp&quot;&gt;這裡回表單頁填寫&lt;/a&gt;喔</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;%</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">'別忘了判斷式結尾</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">end if</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">%&gt;</font></span></p>
      </td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十七)、<span lang="en-us">S</span><a href="http://dd.ysps.tp.edu.tw/ASP範例/範例10_session.asp" style="text-decoration: none"><font color="#000000">ession<span lang="en-us">
</span>物件的應用</font></a></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; Session 的功能其實相當於 
  Cookies ，是用來紀錄瀏覽器與 Server 端的連線資訊用的。當使用者把所有開啟的瀏覽器視窗關閉時，這個工作階段的 Session 就消失了。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 如果瀏覽器一直沒關，Session 
  也有預設存活期限２０分鐘的限制。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 雖說我們可以手動來調整 IIS 中 
  Session 的TimeOut 設定，但是 Session 的&nbsp; TimeOut 
  預設值算是合理，除非您清楚的知道你在幹什麼，或有特殊應用的場合，這裡不建議自行手動修改。下表是我們學習ASP程式設計必須要知道的幾種TimeOut 
  的預設值。</span></p>
  <table cellSpacing="0" width="671" border="1" style="border-collapse: collapse" bordercolor="#111111" height="228">
    <tr>
      <th vAlign="middle" width="101" height="16" bgcolor="#ECECFF">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">ADSI</span></th>
      <th vAlign="middle" width="123" height="16" bgcolor="#ECECFF">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">預設值 (秒)</span></th>
      <th vAlign="middle" width="203" bgcolor="#ECECFF">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">可否在 IIS 嵌入式管理<br>
      單元中設定？</font></span></th>
    </tr>
    <tr>
      <td vAlign="top" width="101" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/asp/apro1cmt.htm">
      <span style="vertical-align: baseline">AspScriptTimeout</span></a></span></td>
      <td vAlign="top" width="123" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">90</span></td>
      <td vAlign="top" width="203">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/core/iitime2.htm#1">
      <span style="vertical-align: baseline">是</span></a></span></td>
    </tr>
    <tr>
      <td vAlign="top" width="101" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/asp/apro0rw4.htm">
      <span style="vertical-align: baseline">AspSessionTimeout</span></a></span></td>
      <td vAlign="top" width="123" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">1200 (20 分鐘)</span></td>
      <td vAlign="top" width="203">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/core/iitime2.htm#2">
      <span style="vertical-align: baseline">是</span></a></span></td>
    </tr>
    <tr>
      <td vAlign="top" width="101" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/asp/apro6khg.htm">
      <span style="vertical-align: baseline">ConnectionTimeout</span></a></span></td>
      <td vAlign="top" width="123" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">900 (15 分鐘)</span></td>
      <td vAlign="top" width="203">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/core/iitime2.htm#3">
      <span style="vertical-align: baseline">是</span></a></span></td>
    </tr>
    <tr>
      <td vAlign="top" width="101" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/asp/apro6e9g.htm">
      <span style="vertical-align: baseline">CGITimeout</span></a></span></td>
      <td vAlign="top" width="123" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">300 (5 分鐘)</span></td>
      <td vAlign="top" width="203">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/core/iitime2.htm#4">
      <span style="vertical-align: baseline">是</span></a></span></td>
    </tr>
    <tr>
      <td vAlign="top" width="101" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt">
      <a href="http://localhost/iishelp/iis/htm/asp/apro64vo.htm">
      <span style="vertical-align: baseline">AspQueueTimeout</span></a></span></td>
      <td vAlign="top" width="123" height="39">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">-1 (無逾時)</span></td>
      <td vAlign="top" width="203">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">否</span></td>
    </tr>
  </table>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
  <img border="0" src="images/ASP.as1.gif" width="406" height="416"></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 我們常會用 Session 的這種<b>短時間記憶</b>的特性，
  在網頁設計時，拿來做一些像是使用者帳號、職稱、權限等資訊，在不同網頁之間傳遞的媒介。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; 我們先用FrontPage 
  製作一個表單，再加入ASP程式碼：</span></p>
</blockquote>
<div align="center">
  <center>
  <table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="80%" id="AutoNumber6">
    <tr>
      <td width="100%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font color="#808080">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您還沒有填寫資料喔 
      </span></font></p>
      <form name="ex10" action="http://dd.ysps.tp.edu.tw/範例10_session.asp" method="post">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">請輸入您的暱稱 :
        <font face="新細明體"><input name="ans" size="20"></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">您的電子郵件:<font face="新細明體"><input name="email" size="20"></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">測試session計數器</span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">此頁被您看了 : 
        1次[關閉所有瀏覽器就會消失]</span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">您對本站的意見 :
        <font face="新細明體"><textarea name="option" rows="4" cols="49"></textarea></font></span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
        <p align="center" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;
        <font face="新細明體"><input type="submit" value="提交" name="B1"><input type="reset" value="重新設定" name="B2"></font></span></p>
      </form>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 程式碼如下</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 &lt;% 
      '把表單傳來的值分別指定給三個變數 </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 </span>
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      my_answer=request(&quot;ans&quot;)<br>
      </span><span style="letter-spacing: 1pt; vertical-align: baseline">　 
      </span><span style="vertical-align: baseline; letter-spacing: 1pt">
      my_email=request(&quot;email&quot;)<br>
      </span><span style="letter-spacing: 1pt; vertical-align: baseline">　 
      </span><span style="vertical-align: baseline; letter-spacing: 1pt">
      my_option=request(&quot;option&quot;)</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 if my_answer 
      = &quot;&quot; or my_email=&quot;&quot; or my_option= &quot;&quot; then</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 　 </span>
      <span style="vertical-align: baseline; letter-spacing: 1pt">response.write 
      &quot;&lt;font color=red size=5&gt;您還沒有填寫資料喔&quot;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 else</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 
      '如果有填寫，把值指定給三個session</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <b><span style="letter-spacing: 1pt; vertical-align: baseline">　 　<font color="#800080">
      </font></span><font color="#800080">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      session(&quot;ans&quot;)=my_answer<br>
      </span><span style="letter-spacing: 1pt; vertical-align: baseline">　 　 
      </span><span style="vertical-align: baseline; letter-spacing: 1pt">
      session(&quot;email&quot;)=my_email<br>
      </span><span style="letter-spacing: 1pt; vertical-align: baseline">　 　 
      </span><span style="vertical-align: baseline; letter-spacing: 1pt">
      session(&quot;option&quot;)=my_option</span></font></b></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">　 %&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的暱稱是 : 
      &lt;font color=&quot;red&quot;&gt;&lt;% =session(&quot;ans&quot;) %&gt; &lt;br&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的EMAIL是 : 
      &lt;font color=&quot;green&quot;&gt;&lt;% =session(&quot;email&quot;) %&gt; &lt;br&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;&lt;font 
      color=&quot;#FF0000&quot;&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">測試<span lang="en-us"> 
      S</span>ession<span lang="en-us"> </span>計數器 :此頁被您看了</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% 
      session(&quot;count&quot;)=session(&quot;count&quot;)+1<br>
      response.write session(&quot;count&quot;)%&gt;次[關閉所有瀏覽器就會消失]&lt;/p&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的意見是 : 
      &lt;font color=&quot;blue&quot;&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% 
      =session(&quot;option&quot;) %&gt; &lt;br&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font color="#008000">請您點一下重新整理按鈕，或者連到首頁再回來看看，以上資訊並不會清除，session 依然存在</font>&lt;/p&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;&lt;font 
      color=&quot;#0000FF&quot;&gt;<font color="#008000">session物件替每個上網的瀏覽器保留變數值，瀏覽器關閉就結束，不像Application，要等到IIS 
      [Web伺服器]關畢才會結束。</font>&lt;/p&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;p&gt;相關範例 :
      </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;a 
      href=&quot;範例5_application網頁計數器.asp&quot;&gt;範例5_application網頁計數器.asp&lt;/a&gt;&lt;/p&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;hr&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% end if %&gt;</span></p>
      </td>
    </tr>
  </table>
  </center>
</div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十八)、</span><span style="letter-spacing: 1pt; vertical-align: baseline"><b>怎樣<a href="http://dd.ysps.tp.edu.tw/ASP範例/abandon_session.asp">丟棄所有 
SESSION</a></b></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">在網頁上要求使用者做重新登入動作時，</span><span style="vertical-align: baseline">我們也同時想要清除這個使用者的連線資訊</span><span style="letter-spacing: 1pt; vertical-align: baseline">，</span><span style="vertical-align: baseline">可以用 
  Session.abandon 這樣的方法來清除。</span></p>
  <blockquote>
    <table id="AutoNumber1" style="border-collapse: collapse" borderColor="#111111" cellSpacing="0" cellPadding="0" width="80%" border="1">
      <tr>
        <td width="53%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% <br>
        session.abandon<br>
        %&gt;</span><p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的暱稱是 : 
      &lt;font color=&quot;red&quot;&gt;&lt;% =session(&quot;ans&quot;) %&gt; &lt;br&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的EMAIL是 : 
      &lt;font color=&quot;green&quot;&gt;&lt;% =session(&quot;email&quot;) %&gt; &lt;br&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的意見是 : 
      &lt;font color=&quot;blue&quot;&gt;&lt;% =session(&quot;option&quot;) %&gt; &lt;br&gt;</span></p>
        </td>
      </tr>
    </table>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">執行結果：</span></p>
  </blockquote>
</blockquote>
<div align="center">
  <center>
  <table id="AutoNumber1" style="border-collapse: collapse" borderColor="#111111" cellSpacing="0" cellPadding="0" width="80%" border="1">
    <tr>
      <td width="47%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">您輸入的暱稱是 :<br>
      您輸入的EMAIL是 : <br>
      您輸入的意見是 : </span></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(十九)、怎樣<a href="http://dd.ysps.tp.edu.tw/ASP範例/app.asp">查看現有 
<span lang="en-us">A</span>pplication<span lang="en-us"> </span>和  
<span lang="en-us">S</span>ession 的數值</a>?</span></p>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
為了能清楚了解，我們可以用For ... Next 迴圈印出這台 Server 目前存在的<span lang="en-us"> </span>Application 的值,和這台電腦和 Server 間的 
Session 的值。</span></p>
<blockquote>
  <blockquote>
    <table id="AutoNumber1" style="border-collapse: collapse" borderColor="#111111" cellSpacing="0" cellPadding="0" width="80%" border="1">
      <tr>
        <td vAlign="top" width="50%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;%</span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">on error 
        resume next</span></p>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp; for 
        each item in Application.contents<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write item &amp; &quot;=&quot; &amp; 
        application(item) &amp; &quot;&lt;br&gt;&quot;<br>
&nbsp; next<br>
        <br>
&nbsp; for each session_item in session.contents<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write session_item &amp; &quot;=&quot; &amp; 
        session(session_item) &amp; &quot;&lt;br&gt;&quot;<br>
&nbsp; next<br>
        <br>
        %&gt;</span></td>
      </tr>
    </table>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline">輸出結果是：</span></p>
  </blockquote>
</blockquote>
<div align="center">
  <center>
  <table id="AutoNumber1" style="border-collapse: collapse" borderColor="#111111" cellSpacing="0" cellPadding="0" width="80%" border="1">
    <tr>
      <td vAlign="top" width="50%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      小小留言版_ConnectionString=DRIVER={Microsoft Access Driver 
      (*.mdb)};DBQ=c:\inetpub\wwwroot\fpdb\gbook.mdb<br>
      小小留言版_ConnectionTimeout=15<br>
      小小留言版_CommandTimeout=30<br>
      小小留言版_CursorLocation=3<br>
      小小留言版_RuntimeUserName=<br>
      小小留言版_RuntimePassword=<br>
      spps=DRIVER={Microsoft Access Driver 
      (*.mdb)};DBQ=c:\inetpub\wwwroot\fpdb\training.mdb<br>
      ysps_ConnectionTimeout=15<br>
      ysps_CommandTimeout=30<br>
      TotalUsers=2<br>
      210.85.156.6LastAccess=<br>
      61.59.71.81LastAccess=<br>
      61_59_71_81show=<br>
      ...............略........</span></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline">
<font color="#808080">作業：</font><a href="http://dd.ysps.tp.edu.tw/ASP範例/留言版/access_gbook.htm" style="text-decoration: none"><font color="#808080">以 
access 建立 mdb 格式資料庫，製作含分頁功能的留言版</font></a><font color="#808080">&nbsp;</font></span></p>
</blockquote>
<div align="center">
  <center>
  <table style="font-size: 11pt; border-collapse: collapse" borderColor="#111111" cellSpacing="0" borderColorDark="#C0C0C0" cellPadding="0" width="80%" borderColorLight="#808080" border="1">
    <tr>
      <td align="middle">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">下面這個範例可以不用撰寫asp程式碼，而直接以 access 建立 mdb 
      格式留言版資料庫。範例:</font><a href="http://dd.ysps.tp.edu.tw/我要留言.asp" target="_blank"><font size="2">我的小小留言版</font></a></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">以 Access 
      開一個新的資料庫，並替檔案命名，如gbook.mdb ，並暫時先存在桌面上</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">使用資料庫設計精靈建立一個簡單的資料庫，您熟的話可直接用設計檢視一步步完成以下各欄位的設計 </font>
      </span><font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">資料庫中包含</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">姓名→文字，長度20</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">電子郵件→文字，長度50</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">留言內容→文字，長度255</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">留言時間→日期，</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">等 四個欄位</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">下面幾個步驟是利用〝精靈〞來建立資料庫，若您直接使用設計檢視，則可以跳過以下三個步驟： </font></span>
      <font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">1.選個人→再把需要的欄位放入最右欄，不滿意精靈取的欄位名稱，自己改</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      2.替這個資料表取個名字，例如:留言版 。精靈也會問你要不要作索引?</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      3.按完成按鈕，完成資料庫的設計</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      完成設計資料表後，隨便輸入一筆資料，您可看見id值自動產生</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">以FrontPage →檔案→開啟web→&nbsp;輸入 http://你的網頁/網址/&nbsp;</font></span><font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">紅燈熄滅表示你的web網站已載入完成。</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">把FrontPage切換到 檢視→資料夾 模式 。</font></span><font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">用滑鼠拖曳桌面上的 gbook.mdb 資料庫，到您開啟的 web 中</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      FrontPage會詢問要用什麼名稱來取名:例如小小留言版</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">這時候系統自動問要不要把這mdb檔放到網頁根目錄的 /fpdb 中，點確定 </font></span>
      <font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">這時你網頁的 /global.asa 檔會自動更新資料庫的連結字串</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">匯入後的mdb檔，內定放在 
      網頁根目錄的 ftdb 資料夾中，桌面上的那份就可以刪除了</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">以FrontPage 切換到網頁模式，開一個空白網頁，並點 插入→表單 </font></span>
      <font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">設計一個表單，包含 姓名[單行文字方塊]、電子郵件[單行文字方塊]、留言內容[多行文字方塊] </font>
      </span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">依以上範例打造，完成表單。</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">在表單上按右鍵，選表單內容 </font></span><font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">指定→傳送到資料庫→按左下角的選項</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">設定資料庫</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">按下確定→找不到指定欄位→逐一手動指定 </font></span><font size="2">
      </p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">T1→姓名</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">T2→電子郵件</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">S1→留言內容</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      設定完畢後，Frontpage會提醒您 副檔名要改為&nbsp; .ASP</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">在網址列輸入
      <a href="http://你的網址/帳號/留言版路徑/我要留言.asp">http://你的網址/帳號/留言版路徑/我要留言.asp</a> </font></span><font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">填寫一份留言內容，按 提交 [送出表單內容]</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">出現表單收到內容的確認畫面</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">資料雖已入庫，但是在網頁上還要新增一頁，用來秀出現在已經留下留言的內容 </font></span>
      <font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      不想新增一頁，也可以放在留言表單的下面</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      在留言表單網頁的最下面點一下，選</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">插入→資料庫→結果</font></span></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      系統自動找到您曾經匯入的資料庫，選小小留言版</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      網頁下方自動加上讀取資料庫的表格</span></font></td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">在切換到瀏覽器看網頁有什麼不一樣?? </font></span><font size="2"></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      我的小小ASP留言版做好了!! </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      </font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">一行asp程式都不用寫喔! </font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</td>
    </tr>
    <tr>
      <td vAlign="top">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2">範例 : </font>
      <a href="http://dd.ysps.tp.edu.tw/我要留言.asp">
      <font size="2">我的小小留言版</font></a></span></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  (二十)、</span><span style="vertical-align: baseline; letter-spacing:1pt; font-weight:700">回家習題</span></p>
</blockquote>
  <blockquote>
<div align="left">
  <table id="AutoNumber24" style="border-collapse: collapse" borderColor="#111111" cellSpacing="0" cellPadding="0" width="80%" border="1">
    <tr>
      <td width="100%" bgColor="#e2f7db">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
      請以記事本或FrontPage設計一個表單會自動印出以下最多到９Ｘ９乘法表的ASP程式。程式必須判斷使用者輸入的數字必需在1~9的範圍中，並且只能輸入整數</span></p>
      <form onsubmit method="post" action="http://dd.ysps.tp.edu.tw/html/--WEBBOT-SELF--">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        <font face="新細明體"><input type="hidden" value="0" name="VTI-GROUP">
        </font></span>
        <p align="center" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">我要印出<b><font color="#3776bb" face="新細明體"><input size="4" name="T1"></font></b> 
        Ｘ<b><font color="#3776bb" face="新細明體"><input size="4" name="T2"></font>的乘法表格</b></span></p>
        <p align="center" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        <font color="#3776bb" face="新細明體">
        <input type="submit" value="幫我印出" name="B1"></font>　<font color="#3776bb" face="新細明體"><input type="reset" value="擦掉" name="B2"></font></span></p>
      </form>
      <center>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">這是9Ｘ9範圍的乘法表</span></p>
      </center>
      <div align="left">
        <table style="border-collapse: collapse" borderColor="#111111" cellSpacing="0" borderColorDark="#C0C0C0" cellPadding="3" width="100%" borderColorLight="#808080" border="1">
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 1 = 1</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 2 = 2</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 3 = 3</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 4 = 4</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 5 = 5</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 6 = 6</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 7 = 7</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 8 = 8</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">1 x 9 = 9</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 1 = 2</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 2 = 4</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 3 = 6</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 4 = 8</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 5 = 10</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 6 = 12</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 7 = 14</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 8 = 16</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">2 x 9 = 18</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 1 = 3</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 2 = 6</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 3 = 9</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 4 = 12</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 5 = 15</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 6 = 18</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 7 = 21</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 8 = 24</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">3 x 9 = 27</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 1 = 4</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 2 = 8</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 3 = 12</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 4 = 16</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 5 = 20</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 6 = 24</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 7 = 28</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 8 = 32</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">4 x 9 = 36</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 1 = 5</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 2 = 10</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 3 = 15</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 4 = 20</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 5 = 25</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 6 = 30</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 7 = 35</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 8 = 40</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">5 x 9 = 45</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 1 = 6</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 2 = 12</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 3 = 18</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 4 = 24</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 5 = 30</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 6 = 36</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 7 = 42</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 8 = 48</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">6 x 9 = 54</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 1 = 7</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 2 = 14</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 3 = 21</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 4 = 28</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 5 = 35</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 6 = 42</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 7 = 49</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 8 = 56</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">7 x 9 = 63</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 1 = 8</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 2 = 16</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 3 = 24</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 4 = 32</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 5 = 40</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 6 = 48</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 7 = 56</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 8 = 64</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">8 x 9 = 72</font></span></td>
          </tr>
          <tr>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 1 = 9</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 2 = 18</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 3 = 27</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 4 = 36</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 5 = 45</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 6 = 54</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 7 = 63</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 8 = 72</font></span></td>
            <td noWrap align="middle">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">9 x 9 = 81</font></span></td>
          </tr>
        </table>
      </div>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</td>
    </tr>
  </table>
</div>
  </blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
<span style="letter-spacing: 1pt; vertical-align: baseline; background-color: #e2f7db">
　　<a href="http://dd.ysps.tp.edu.tw/ASP範例/99.asp" target="_blank">看結果</a>&nbsp;&nbsp;&nbsp;&nbsp;
<a href="http://dd.ysps.tp.edu.tw/html/99_answer.asp" target="_blank">看原始碼</a>　</span></p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
原始碼如下：</p>
  <blockquote>
      <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:655; height:1148">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font color="#808080">&lt;% <br>
      var_1=request(&quot;var_1&quot;)<br>
      var_2=request(&quot;var_2&quot;)<br>
      var_1=int(var_1)<br>
      var_2=int(var_2)<br>
      <br>
      if var_1 &gt;9 or var_2 &gt;9 then<br>
&nbsp;&nbsp;&nbsp; response.write &quot;&lt;h2&gt;您輸入的數字超過9了,請重新輸入介於 1 到 9 之間的整數&lt;/h2&gt;&quot;<br>
&nbsp;&nbsp;&nbsp; inputok=0<br>
      elseif var_1 &lt; 1 or var_2 &lt; 1 then<br>
&nbsp;&nbsp;&nbsp; response.write &quot;&lt;h2&gt;您輸入的數字小於1,請重新輸入介於 1 到 9 之間的整數&lt;/h2&gt;&quot;<br>
      inputok=0<br>
      else inputok=1<br>
      end if<br>
      %&gt;</font></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font color="#808080">&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; 
      content=&quot;text/html; charset=big5&quot;&gt;<br>
      &lt;title&gt;印出乘法表格&lt;/title&gt;&lt;/head&gt;<br>
      &lt;body&gt;<br>
      &lt;form method=&quot;POST&quot; action=&quot;9x9.asp&quot;&gt;<br>
      &lt;p align=&quot;center&quot;&gt;&lt;b&gt;&lt;font color=&quot;#FF0000&quot;&gt;我要印出 <br>
      &lt;input type=&quot;text&quot; name=&quot;var_1&quot; size=&quot;4&quot; value=&quot;&lt;% =var_1%&gt;&quot;&gt; Ｘ <br>
      &lt;input type=&quot;text&quot; name=&quot;var_2&quot; size=&quot;4&quot; value=&quot;&lt;% =var_2%&gt;&quot;&gt; 
      的乘法表格&lt;/b&gt;&lt;/p&gt;<br>
      &lt;p align=&quot;center&quot;&gt;&lt;font size=&quot;3&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;幫我印出&quot; 
      name=&quot;B1&quot;&gt;<br>
      &lt;font size=&quot;3&quot;&gt;&lt;input type=&quot;reset&quot; value=&quot;擦掉&quot; 
      name=&quot;B2&quot;&gt;&lt;/p&gt;<br>
      &lt;/form&gt;<br>
      &lt;center&gt;<br>
      &lt;hr&gt;<br>
      </font><font color="#800000">&lt;% if inputok=1 then %&gt;<br>
      </font><font color="#808080">&lt;h2&gt;這是 &lt;font color=&quot;#FF0000&quot;&gt;&lt;b&gt;&lt;% =var_1%&gt; 
      &lt;/b&gt;Ｘ &lt;font color=&quot;#FF0000&quot;&gt;<br>
      &lt;b&gt;&lt;% =var_2%&gt; &lt;/b&gt;範圍的乘法表&lt;/h2&gt;<br>
      &lt;/center&gt;<br>
      &lt;div align=&quot;center&quot;&gt;<br>
      &lt;center&gt;<br>
      &lt;table width=&quot;90%&quot; border=&quot;1&quot; style=&quot;border-collapse: collapse&quot; 
      bordercolor=&quot;#111111&quot; cellpadding=&quot;3&quot; cellspacing=&quot;0&quot; 
      bordercolorlight=&quot;#808080&quot; bordercolordark=&quot;#C0C0C0&quot;&gt;<br>
      </font><font color="#000080">&lt;% for i =1 to var_1 %&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;tr&gt;</font><font color="#808080"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>&nbsp;<font color="#008000">&lt;% for j=1 to 
      var_2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; answer=i*j&nbsp;&nbsp;&nbsp; %&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td nowrap width=&quot;71&quot; 
      align=&quot;center&quot;&gt;&lt;font color=&quot;#000080&quot; size=&quot;3&quot;&gt;&lt;% =i%&gt; <br>
      x &lt;% =j%&gt; = &lt;% =answer %&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;% next %&gt;</font><font color="#808080"><br>
&nbsp;&nbsp;&nbsp; &lt;/tr&gt;<br>
      </font><font color="#000080">&lt;% next%&gt;</font><font color="#808080"><br>
      &lt;/table&gt;<br>
      &lt;/center&gt;<br>
      &lt;/div&gt;<br>
      </font><font color="#800000">&lt;% else %&gt;</font><font color="#808080"><br>
&nbsp;&nbsp;&nbsp; &lt;h1&gt;輸入錯誤&lt;/h1&gt;<br>
      </font><font color="#800000">&lt;% end if%&gt;</font><font color="#808080"><br>
      &lt;/body&gt;&lt;/html&gt;</font>  </blockquote></div>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
　</p>
  <blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(二十一)、</span><span style="vertical-align: baseline; letter-spacing: 1pt"><b>使用<span lang="en-us">
</span>CDONTS<span lang="en-us"> </span>元件:</b></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  越來越多的<span lang="en-us"> </span>WEB<span lang="en-us"> </span>應用程式要利用到電子郵件寄發，例如：電子賀卡、電子報、申請會員、網頁郵寄...等。這時候就需要使用CDO<span lang="en-us">NTS
  </span>元件。在<span lang="en-us"> </span>Server 上是由<span lang="en-us"> </span>CDONTS.dll 這個函式庫來負責處理。</span></p>
  </blockquote>
  <blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="vertical-align: baseline">我們如果想在網站上使用寄發電子郵件服務的功能，必須先把<span lang="en-us"> 
IIS </span>中的 SMTP 
伺服器給設定好：</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">步驟一、設定IIS中的SMTP</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht88.gif" width="581" height="250"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center"><span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht89.gif" width="404" height="416"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  (二十二)、</span><span style="vertical-align: baseline; letter-spacing: 1pt; font-weight: 700">用 CDONTS 元件試做<span lang="en-us"> 
W</span>eb<span lang="en-us"> </span>網頁寄信程式</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    步驟二、用<span lang="en-us"> </span>frontpage<span lang="en-us"> </span>等網頁製作軟體，設計一個郵寄程式用的表單：</span></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
      <span style="vertical-align: baseline">請點選　檔案→開啟ＷＥＢ→C:\inetpub\wwwroot<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      （也許您將網頁資料夾裝在其他地方，請自行變更）</span></div>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">　</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">步驟三、建立訪客填寫的介面：</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    請新增一個表單，並替這個表單命名，名稱取為〝 sendmail〞 好了， 然後指定表單上每個方塊的名稱（<font color="#0000FF">name</font>），習慣上我們會用
    無框線的<b>表格</b>來對齊這些網頁上的項目，如下圖：</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht3.jpg" width="604" height="476"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <img border="0" src="images/ASP.as2.gif" width="263" height="118"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht12.jpg" width="422" height="331"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht8.jpg" width="357" height="222"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht9.jpg" width="357" height="222"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht10.jpg" width="357" height="222"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht11.jpg" width="369" height="252"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht4.jpg" width="604" height="476"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    步驟四、設定表單資料要送到哪支<span lang="en-us"> ASP </span>程式處理？</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
    我們也要指定這個表單送交給另外一支ASP程式的處理動作，在表單範圍內按滑鼠右鍵，選〝表單內容〞：</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht12.jpg" width="422" height="331"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">點一下：〝選項〞，輸入動作傳給 
    sendmail.asp ，方法是POST。</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht13.jpg" width="371" height="165"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">　</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">&nbsp;設定完畢請</span><span style="letter-spacing: 1pt; vertical-align: baseline">〝存檔〞到C:\Inetpub\wwwroot\mailto.asp。</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht14.jpg" width="626" height="359"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    步驟五、製作送出郵件的ASP程式。</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">&nbsp;&nbsp;&nbsp; </span>
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    開另一個新檔案，切換到html檢視，撰寫ASP程式碼如下：並存檔為 <font color="#0000FF">sendmail.asp</font></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht5.jpg" width="672" height="526"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">步驟六、開啟瀏覽器測試功能：</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht6.jpg" width="681" height="550"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">步驟七、開啟ＯＥ看看收到了沒有？</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht7.jpg" width="684" height="494"></span></p>
  </blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(二十三)、如何<a href="http://dd.ysps.tp.edu.tw/ASP範例/server_variable.asp">印出<span lang="en-us"> 
S</span>erver<span lang="en-us"> </span>的環境變數</a></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  我們想要對 IIS Server 所提供的環境變數更了解的話，最簡單的方法就是把他全部印出來。我們可以寫幾行小程式並使用 
  Request.ServerVariables 的方法取出 Server 的環境變數。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  但因為內容有敏感性資料，通常這類程式沒事不會故意放在網路上給參觀者看。程式碼如下:</span></p>
</blockquote>
<div align="center">
  <center>
  <table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="80%" id="AutoNumber7">
    <tr>
      <td width="100%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;html&gt;<br>
      &lt;%
      <font color="#008000">' 下面的程式碼是用 <b>for each <span lang="en-us">xxx </span>&nbsp;in ...</b>迴圈讀出環境變數，並放在 vars 
      變數中，再分別印在兩欄的表格中。</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font color="#0000FF">For&nbsp; Each&nbsp; </font>
      vars<font color="#0000FF">&nbsp; In </font>
      &nbsp;Request.ServerVariables %&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;table&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;tr&gt;&lt;td &gt; &lt;%= 
      vars %&gt; &lt;/td&gt; &lt;td &gt; &lt;%= Request.ServerVariables(vars) %&gt; &lt;/td&gt;&lt;/tr&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font color="#0000FF">
      <span style="letter-spacing: 1pt; vertical-align: baseline">&lt;% Next %&gt;</span></font></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      &lt;/table&gt;&lt;/html&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline">程式很簡單，印出來的資料卻很多，</span><span style="letter-spacing: 1pt; vertical-align: baseline">執行後的結果如下：</span></p>
      <div align="center">
        <center>
        <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0" height="10">
          <tr>
            <td align="middle" width="118" height="26" bgcolor="#ECECFF">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">Server 環境變數</font></span></td>
            <td align="middle" width="537" height="26" bgcolor="#ECECFF">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">值</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="94">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">ALL_HTTP 　</font></span></td>
            <td align="left" width="537" height="94">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_ACCEPT:*/* HTTP_ACCEPT_LANGUAGE:zh-tw 
            HTTP_CONNECTION:Keep-Alive HTTP_HOST:dd.ysps.tp.edu.tw 
            HTTP_REFERER:http://dd.ysps.tp.edu.tw/html/2.asp 
            HTTP_USER_AGENT:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; 
            Q312461) HTTP_COOKIE:iscookies=0; ip=140%2E131%2E204%2E4; 
            ASPSESSIONIDASTRDSCC=PCFDHPGBPDGCAEDPEILNPNKM 
            HTTP_ACCEPT_ENCODING:gzip， deflate 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="81">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">ALL_RAW 　</font></span></td>
            <td align="left" width="537" height="81">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">Accept: */* Accept-Language: zh-tw Connection: 
            Keep-Alive Host: dd.ysps.tp.edu.tw Referer: 
            http://dd.ysps.tp.edu.tw/html//6.asp User-Agent: Mozilla/4.0 
            (compatible; MSIE 6.0; Windows NT 5.0; Q312461) Cookie: iscookies=0; 
            ip=140%2E131%2E204%2E4; 
            ASPSESSIONIDASTRDSCC=PCFDHPGBPDGCAEDPEILNPNKM Accept-Encoding: gzip， 
            deflate 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">APPL_MD_PATH 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">/LM/W3SVC/1/ROOT 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">APPL_PHYSICAL_PATH 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline"><font size="2">d</font></span><span style="letter-spacing: 1pt; vertical-align: baseline"><font size="2">:\inetpub\wwwroot\ 
            　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="655" height="16" colspan="2">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
            <span style="vertical-align: baseline"><font size="2">。。。。。中略。。。。。</font></span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            </td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">GATEWAY_INTERFACE 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">CGI/1.1 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">INSTANCE_META_PATH 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">/LM/W3SVC/1 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">LOCAL_ADDR 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">140.131.204.4 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">LOGON_USER 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            </td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">PATH_INFO 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">/ASP範例/server_variable.asp 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">PATH_TRANSLATED 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">d:\inetpub\wwwroot\ASP範例\server_variable.asp 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">QUERY_STRING 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            </td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">REMOTE_ADDR 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">140.131.204.4 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">REMOTE_HOST 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">140.131.204.4 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">REMOTE_USER 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            </td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">REQUEST_METHOD 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">GET 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">SCRIPT_NAME 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">/ASP範例/server_variable.asp 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">SERVER_NAME 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">dd.ysps.tp.edu.tw 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">SERVER_PORT 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">80 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">SERVER_PORT_SECURE 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">0 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">SERVER_PROTOCOL 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">HTTP/1.1 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">SERVER_SOFTWARE 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">Microsoft-IIS/5.0 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">URL 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">/ASP範例/server_variable.asp 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_ACCEPT 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">*/* 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_ACCEPT_LANGUAGE 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">zh-tw 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_CONNECTION 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">Keep-Alive 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_HOST 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">dd.ysps.tp.edu.tw 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_REFERER 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            <font size="2">http://dd.ysps.tp.edu.tw/html/2.asp 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_USER_AGENT 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; 
            Q312461) 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="29">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_COOKIE 　</font></span></td>
            <td align="left" width="537" height="29">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">iscookies=0; ip=140%2E131%2E204%2E4; 
            ASPSESSIONIDASTRDSCC=PCFDHPGBPDGCAEDPEILNPNKM 　</font></span></td>
          </tr>
          <tr>
            <td align="left" width="118" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">HTTP_ACCEPT_ENCODING 　</font></span></td>
            <td align="left" width="537" height="16">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            <font size="2">gzip， deflate 　</font></span></td>
          </tr>
        </table>
        </center>
      </div>
      <hr></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(二十四)、<a href="http://dd.ysps.tp.edu.tw/ASP範例/ip.asp">如何判斷訪客是來自校內還是校外</a></span></p>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="font-weight: 700; vertical-align: baseline">
  &nbsp;</span><span style="vertical-align: baseline">從上面的範例我們可以看到有一項環境變數叫做</span><span style="letter-spacing: 1pt; vertical-align: baseline"> 
  Remote_Addr ，我們可以在程式中取出，然後放入陣列中來做判斷，這樣一來就可以知道是校內的訪客或是校外。當然不放入陣列直接用 
  left（Request.Servervariables(&quot;Remote_Addr&quot;) ,12）做字串比對來判斷也是可以的：</span></p>
</blockquote>
</blockquote>
<div align="center">
  <center>
  <table width="80%" border="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
    <tr>
      <td vAlign="top" width="56%">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;%<br>
      user_ip=Request.Servervariables(&quot;Remote_Addr&quot;) </font> </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">' 
      把從http檔頭取來的環境變數ip值以點分隔，放入Theip陣列，這樣一來theip這個陣列變數就會放入多筆資料。</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">Theip = 
      Split(Request.Servervariables(&quot;Remote_Addr&quot;)， &quot;.&quot;)</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">' 
      先用Split（）函數，來把取回的 ip用 . 分隔，分別放入陣列中，如果是C級網域的話，我們可以取Theip 陣列的前三個元素來判斷訪客來自某處。</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline"><font size="2" face="Arial">' 放入 Session的好處是可以在其他網頁中沿用這個 
      session 值做一些判斷上的變化</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">If Theip(0) = 
      &quot;163&quot; and Theip(1) = &quot;21&quot; and Theip(2) = &quot;166&quot; Then '石牌國小ip</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp; 
      session(&quot;spps&quot;)=1</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">elseIf 
      Theip(0) = &quot;163&quot; and Theip(1) = &quot;21&quot; and Theip(2) = &quot;224&quot; Then '逸仙國小ip</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp; 
      session(&quot;ysps&quot;)=1</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">elseIf 
      Theip(0) = &quot;163&quot; and Theip(1) = &quot;28&quot; and Theip(2) = &quot;4&quot; Then '教育部proxy</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp; 
      session(&quot;edu&quot;)=1</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">else</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp; 
      session(&quot;others&quot;)=0</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">end if</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">%&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;html&gt;&lt;body&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;% if 
      session(&quot;spps&quot;)=1 then</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">response.write 
      &quot;&lt;h1&gt;歡迎來自石牌國小的訪客&lt;/h1&gt;您的ip是:&quot; &amp; user_ip</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">elseif 
      session(&quot;ysps&quot;)=1 then</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">response.write 
      &quot;&lt;h1&gt;歡迎來自逸仙國小的訪客&lt;/h1&gt;您的ip是:&quot; &amp; user_ip</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">elseif 
      session(&quot;edu&quot;)=1 then</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">response.write 
      &quot;&lt;h1&gt;歡迎來自教育部PROXY&lt;/h1&gt;您的ip是:&quot; &amp; user_ip</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">else</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      <font size="2" face="Arial">response.write 
      &quot;&lt;h1&gt;歡迎來自&quot; &amp; user_ip &amp; &quot;的朋友蒞臨&lt;/h1&gt;&quot;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">end if</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">%&gt;</font></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font size="2" face="Arial">&lt;/body&gt;&lt;/html&gt;</font></span></p>
      </td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
  有的時候校內網頁可以用一些 <a href="file://web/share">\\web\share</a> 
  等網址來連結校內主機，我們就可以利用這種判斷校內外ｉｐ連線的功能，來設計一些只有校內上網看得到的網頁。或是在主選單上判斷校內的 Session 
  是否存在，如果是校內電腦則顯示出來，校外就不顯示。</p>
  </blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(二十五)、</span><b>使用<span lang="en-us"> </span>FSO<span lang="en-us"> </span>元件</b></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    　IIS上使用 [檔案系統物件] ( FSO, File System Object )可以取得Server 
    上的磁碟，資料夾和檔案內容資訊，也就是說我們在網頁程式設計應用上，可以利用它的特性來做取得WEB Server 上的檔案名稱、大小、建檔日期等等屬性，當然也可以對檔案做讀寫動作，在 
    Server 端專門用來解析這個物件的動態函式庫是：scrrun.dll。</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    在ASP程式中啟用這個物件的語法是：</p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      Set my_FSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)</div>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    FSO物件在IIS4.0以上有超過20幾種方法，以下是FSO物件常用的幾種常見方法:</p>
    <table border="1" cellpadding="3" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="85%" id="AutoNumber28">
      <tr>
        <td width="42%" align="center"><b>屬性/方法</b></td>
        <td width="58%" align="center"><b>說明</b></td>
      </tr>
      <tr>
        <td width="42%">Drives屬性</td>
        <td width="58%">傳回磁碟代號、磁碟類型、共享名稱、磁碟標籤等</td>
      </tr>
      <tr>
        <td width="42%">CopyFile方法</td>
        <td width="58%">複製檔案</td>
      </tr>
      <tr>
        <td width="42%">CopyFolder方法</td>
        <td width="58%">複製資料夾</td>
      </tr>
      <tr>
        <td width="42%">CreatFolder方法</td>
        <td width="58%">建立新資料夾</td>
      </tr>
      <tr>
        <td width="42%">Deletefile 、DeleteFolder方法</td>
        <td width="58%">刪除檔案或資料夾</td>
      </tr>
      <tr>
        <td width="42%">DriveExists方法</td>
        <td width="58%">判斷磁碟機是否存在</td>
      </tr>
      <tr>
        <td width="42%">FileExists 、FolderExists方法</td>
        <td width="58%">判斷檔案或資料夾是否存在</td>
      </tr>
      <tr>
        <td width="42%">GetDriveName方法</td>
        <td width="58%">取得磁碟機名稱</td>
      </tr>
      <tr>
        <td width="42%">GetExtensionName方法</td>
        <td width="58%">取得檔案的副檔名</td>
      </tr>
      <tr>
        <td width="42%">GetParentFolderName方法</td>
        <td width="58%">取得上層資料夾名稱</td>
      </tr>
      <tr>
        <td width="42%">MoveFile方法</td>
        <td width="58%">搬移檔案</td>
      </tr>
      <tr>
        <td width="42%">MoveFolder方法</td>
        <td width="58%">搬移資料夾</td>
      </tr>
    </table>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    對於文字檔的讀寫，我們可以使用 FSO 物件的子物件： TextStream  ，下面是這個物件的屬性和方法</p>
    <table border="1" cellpadding="3" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="85%" id="AutoNumber28">
      <tr>
        <td width="42%">AtEndOfLine屬性</td>
        <td width="58%">判斷是否是文字行的最後一個字元</td>
      </tr>
      <tr>
        <td width="42%">AtEndOfStream屬性</td>
        <td width="58%">判斷是否是文字檔內容的最後（結尾）</td>
      </tr>
      <tr>
        <td width="42%">OpenTextFile 方法． Close 方法</td>
        <td width="58%">開啟／關閉文字檔</td>
      </tr>
      <tr>
        <td width="42%">Read方法</td>
        <td width="58%">讀取文字內容</td>
      </tr>
      <tr>
        <td width="42%">ReadAll方法</td>
        <td width="58%">讀取文字檔案內全部文字內容</td>
      </tr>
      <tr>
        <td width="42%">ReadLine方法</td>
        <td width="58%">逐行讀取</td>
      </tr>
      <tr>
        <td width="42%">Write方法</td>
        <td width="58%">寫入字串</td>
      </tr>
      <tr>
        <td width="42%">Writeline方法</td>
        <td width="58%">寫入一行字串</td>
      </tr>
      <tr>
        <td width="42%">WriteBlankLines方法</td>
        <td width="58%">寫入一行空字串</td>
      </tr>
    </table>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    我們來做個FSO的語法的練習：</p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      &lt;% <br>
      &nbsp;&nbsp;&nbsp; mydir = request(&quot;dir&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      '取得路徑字串放入變數<br>
      &nbsp;&nbsp;&nbsp;
      realpath = server.mappath(mydir)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      '取得絕對路徑 <br>
&nbsp;&nbsp;&nbsp; set my_FSO=CreateObject(&quot;Scripting.FileSystemObject&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      '使用FSO物件</p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
      set my_folder=my_FSO.getfolder(realpath)&nbsp;&nbsp;&nbsp; '取得資料夾路徑<br>
&nbsp;&nbsp;&nbsp; set folder_content=my_folder.subfolders&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      '取得這個資料夾內的所有子資料夾 <br>
&nbsp;&nbsp;&nbsp; set file_list=my_folder.files&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      '取得這個資料夾的檔案清單 <br>
      <br>
&nbsp;&nbsp;&nbsp;&nbsp; if my_FSO.FileExists(realpath &amp; &quot;/index.htm&quot;) then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      '如果這個檔案存在<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.redirect &quot;index.htm&quot;<br>
&nbsp;&nbsp;&nbsp; else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write &quot;資料夾中沒有首頁 index.htm 檔&quot;</p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      response.write file_list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write folder_content<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write my_folder<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if<br>
      end if<br>
      %&gt;</p>
      </div>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    上面這個程式片段是檔案管理員的前面部分程式碼，搭配此程式需要有一個指定為message.htm 
    的純文字設定檔，內容指定網頁標題，圖片的長寬，說明訊息等資訊。</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    概括的流程大概是：先利用FSO物件讀取用 Request 
    物件讀入的路徑，並判斷此路徑是檔案或是資料夾，同時取得了資料夾中的子資料夾名稱和檔案名稱．它也判斷資料夾下面有沒有 message.htm 
    這個檔案，如果有的話逐行讀取檔案內容，沒有的話，就用把TITLE設為預設值。</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
    下面這個範例程式稍微複雜一些，它是利用 FSO 物件取得 
    /top/midi/下面的特定類型檔案(背景音樂檔)，並用亂數隨機選取一首音樂在網頁上撥放，但是也尊重使用者，所以也把音樂關閉的功能考慮進去了。以下是逸仙國小上面那個網頁（top.asp）的部分內容：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    &lt;% <br>
    '  讀取<span lang="en-us"> R</span>equest<span lang="en-us"> </span>物件中的<span lang="en-us"> 
    play </span>變數，以便判斷要不要放音樂<br>
    play = request(&quot;play&quot;)<br>
    '<span lang="en-us"> </span>讀取環境變數，並檢查是否為校內<span lang="en-us"> IP</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font color="#808080">' my_Ip = Left(Request.Servervariables(&quot;Remote_Addr&quot;),9)
    </font> </p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font color="#808080">' if my_IP=&quot;192.56.1.&quot;&nbsp; then ...... 判斷前9個字串也可以</font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    TheIp = Split(Request.Servervariables(&quot;Remote_Addr&quot;), &quot;.&quot;) </p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    If Theip(0) = &quot;140&quot; and Theip(1) = &quot;131&quot; and Theip(2) = &quot;204&quot; Then <br>
&nbsp;&nbsp;&nbsp; session(&quot;inside&quot;)=1<br>
    else<br>
&nbsp;&nbsp;&nbsp; session(&quot;inside&quot;)=0<br>
    end if<br>
    %&gt;<br>
    &lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; 
    charset=big5&quot;&gt;<br>
    &lt;base target=&quot;right&quot;&gt;<br>
    &lt;/head&gt;<br>
    &lt;body bgcolor=&quot;#cceeff&quot; leftmargin=&quot;0&quot; topmargin=&quot;2&quot; marginwidth=&quot;0&quot; 
    marginheight=&quot;0&quot;&gt;<br>
    &lt;% <br>
    if play=&quot;yes&quot; then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Randomize　&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '使用亂數<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; realpath=server.mappath(&quot;/top/midi&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '取得實體路徑<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newpath=realpath<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set 
    f=CreateObject(&quot;scripting.filesystemobject&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '使用FSO物件<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set fo=f.getfolder(newpath)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '把路徑指定給 fo 變數<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set fl=fo.files&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '將此路徑下的檔案放入fl 陣列變數中<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; redim music(500)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '開一個可以放入500個元素大小的陣列<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '歸零&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for each f1 
    in fl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '用迴圈取出檔按陣列裡的元素<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&nbsp;&nbsp;&nbsp; 
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>if session(&quot;inside&quot;)=1 then 
    　<span lang="en-us">'</span>檢查是來自校內或校外<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    if Ucase(f1.GetExtensionName(newpath &amp; f1.name))=&quot;MP3&quot; then&nbsp;music(i) 
    = f1.name<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>'校內：判斷副檔名是不是<span lang="en-us"> MP3</span>，若是則放入music陣列中<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    <span lang="en-us">else</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>if Ucase(f1.GetExtensionName(newpath &amp; f1.name))&quot;MID&quot; then<span lang="en-us">
    </span>music(i) = f1.name</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>'校外：判斷副檔名是不是<span lang="en-us"> MID</span>，若是則放入music陣列中<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    end if</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = i + 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '計算總共有多少個符合的檔案<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; next<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no = Fix(Rnd * i)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    '歌曲的總數乘上亂數後的值Fix()處理後,指定給no變數<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.write &quot;&lt;bgsound 
    src='/top/midi/&quot; &amp; music(no) &amp; &quot;' loop=-1&gt;&quot; <br>
    end if<br>
    %&gt;<br>
    <br>
    &lt;table border=&quot;0&quot; width=&quot;100%&quot; cellspacing=&quot;0&quot; cellspadding=&quot;0&quot;&gt;<br>
    &lt;tr width=&quot;80%&quot;&gt;<br>
    &lt;td width=&quot;641&quot; valign=&quot;top&quot; align=&quot;left&quot;&gt;<br>
    &lt;p align=&quot;left&quot;&gt;&lt;font color=&quot;#88aaF2&quot;&gt;■&lt;font color=&quot;#0080ff&quot;&gt;&lt;a href=&quot;http://www.ysps.tp.edu.tw/board/index.asp&quot; target=&quot;right&quot;&gt;最新消息&lt;/a&gt;　 
    <br>
    &lt;font color=&quot;#88aaF2&quot;&gt;■&lt;a href=&quot;http://webmail.ysps.tp.edu.tw/email/neomail.htm&quot; 
    target=&quot;right&quot;&gt;網路郵局&lt;/a&gt;　 <br>
    &lt;font color=&quot;#66aaf2&quot;&gt;■&lt;a href=&quot;http://webmail.ysps.tp.edu.tw:12000/&quot; 
    target=&quot;teacher&quot;&gt;教職員主機&lt;/a&gt;　 <br>
    &lt;font color=&quot;#aa4444&quot;&gt;■&lt;a href=&quot;http://stu.ysps.tp.edu.tw:12000/&quot; 
    target=&quot;student&quot;&gt;學生主機&lt;/a&gt;　 <br>
    &lt;% if session(&quot;inside&quot;)=1 then %&gt;&lt;font color=&quot;#88aaF2&quot;&gt;■&lt;a 
    target=&quot;right&quot; href=&quot;/vod/&quot;&gt;隨選視訊&lt;/a&gt;　 &lt;% end if%&gt; <br>
    &lt;font color=&quot;#88aaF2&quot;&gt;■&lt;a target=&quot;right&quot; href=&quot;http://webmail.ysps.tp.edu.tw/email/email1.htm&quot;&gt;班級網頁&lt;/a&gt;　 <br>
    &lt;font color=&quot;#88aaF2&quot;&gt;■&lt;a target=&quot;right&quot; href=&quot;ccfaq.htm&quot; 
    target=right&gt;FAQ[常見問題]&lt;/a&gt;<br>
    &lt;!-- td align=&quot;right&quot; width=&quot;1&quot;&gt;&lt;a 
    href=&quot;http://www.ysps.tp.edu.tw/index1.htm&quot; border=&quot;0&quot; target=&quot;restore&quot;&gt;&lt;img 
    src=&quot;restore.gif&quot; border=&quot;0&quot; align=&quot;right&quot; alt=&quot;按這裡開啟一般視窗&quot;&gt;&lt;/a&gt;&lt;/td --&gt; <br>
    &lt;table border=0 width=100%&gt;<br>
    &lt;/table&gt;<br>
    <br>
    &lt;td align=&quot;left&quot; width=&quot;1&quot;&gt;<br>
    <br>
    &lt;% if request(&quot;play&quot;)=&quot;no&quot; then %&gt;<br>
    &lt;a href=&quot;top.asp?play=yes&quot; target=&quot;_self&quot; border=&quot;0&quot;&gt;&lt;img src=&quot;no_speak.gif&quot; 
    border=&quot;0&quot; align=&quot;left&quot; alt=&quot;點這裡可以自動點播音樂&quot;&gt;&lt;/a&gt; <br>
    &lt;% end if %&gt;<br>
    <br>
    &lt;% if request(&quot;play&quot;)=&quot;yes&quot; then %&gt; <br>
    &lt;a href=&quot;top.asp?play=no&quot; target=&quot;_self&quot; border=&quot;0&quot;&gt;&lt;img src=&quot;speak.gif&quot; 
    border=&quot;0&quot; align=&quot;left&quot; alt=&quot;現在撥放的音樂曲名是:&lt;% = music(no) %&gt;，按這裡可以關閉音樂!&quot;&gt;&lt;/a&gt;
    <br>
    &lt;% end if %&gt; <br>
    &lt;/td&gt;<br>
    &lt;td align=&quot;left&quot; width=&quot;1&quot;&gt;&lt;a 
    href=&quot;javascript:onclick=window.parent.close()&quot; border=&quot;0&quot;&gt;&lt;img src=&quot;x.gif&quot; 
    border=&quot;0&quot; align=&quot;left&quot; alt=&quot;按這裡可以關閉視窗&quot;&gt;&lt;/a&gt;&lt;/td&gt;<br>
    &lt;/table&gt;<br>
    <br>
    &lt;!-- =============校內ip上網計數,寫入資料庫============= --&gt;<br>
    &lt;!-- #include virtual=&quot;/use/link.asp&quot; --&gt; <br>
    &lt;/body&gt;<br>
　</p>
    </div>
  </blockquote>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</p>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<b>圖庫管理員</b></p>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  FSO 
  這個檔案系統物件在ASP程式的另一種應用，就是膾炙人口的檔案管理員。這個檔案管理員ASP程式請到石牌國小網站→資訊中心→網頁資源庫中下載，本程式由李忠憲老師設計撰寫陸續推出了好幾個版本。應用上非常
	廣泛，詳細使用方法請參閱說明檔。我們來看看程式碼：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    &lt;% <br>
    mydir = request(&quot;dir&quot;)<span lang="en-us"> ' </span>
    讀取要瀏覽的目錄，放入字串變數中<br>
    mydir = replace(mydir,&quot;.&quot;,&quot;&quot;) <span lang="en-us">'
    </span>將<span lang="en-us"> . </span>移除，以避免用相對路徑（<span lang="en-us">../../winnt/system32</span>）連到未開放存取的上層目錄<br>
    if mydir = &quot;&quot; then mydir = &quot;.&quot;<span lang="en-us"> '
    </span>經過以上處理，如果路徑變成空的，就設為程式所在的資料夾<br>
    if left(mydir,1)=&quot;/&quot; or left(mydir,1)=&quot;\&quot; then mydir = &quot;.&quot; &amp; mydir<span lang="en-us"> 
    ' </span>移除<span lang="en-us"> / </span>與<span lang="en-us"> \ </span>
    以防止使用絕對路徑連到不相干的目錄<br>
    i = InStrRev(mydir,&quot;/&quot;) - 1<span lang="en-us"> ' </span>
    搜尋路徑字串中最右邊的<span lang="en-us"> /</span> <br>
    if i &lt;= 0 then <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>uplevel = &quot;.&quot;
    <span lang="en-us">' </span>找不到<span lang="en-us"> /</span>，表示此路徑沒有上層目錄，因此將上層目錄設為程式所在的資料夾<br>
    else <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>uplevel = left(mydir,i)<span lang="en-us"> 
    ' </span>找到<span lang="en-us"> /</span>，取得<span lang="en-us"> / </span>
    左邊的字串，設定為上層目錄<br>
    end if <br>
    　</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    realpath = server.mappath(mydir) <span lang="en-us">' </span>對應<span lang="en-us"> 
    web </span>路徑為真實的磁碟路徑<br>
    set f=CreateObject(&quot;scripting.filesystemobject&quot;)
    <span lang="en-us">' </span>建立一個<span lang="en-us"> FSO </span>物件<br>
    set fo=f.getfolder(realpath)<span lang="en-us"> ' </span>將目錄資訊讀取到<span lang="en-us"> 
    fo </span>變數中 <br>
    set fc=fo.subfolders<span lang="en-us"> ' </span>將該目錄的子資料夾資訊讀取到<span lang="en-us"> 
    fc </span>變數中 <br>
    set fl=fo.files<span lang="en-us"> ' </span>將該目錄的檔案資訊讀取到<span lang="en-us"> 
    fl </span>變數中 <br>
    <br>
    flag=0<span lang="en-us"> ' </span>設定<span lang="en-us"> message.htm </span>
    訊息檔旗號，<span lang="en-us">0 </span>表示沒找到訊息檔<br>
    if f.FileExists(realpath &amp; &quot;/message.htm&quot;) then<span lang="en-us"> 
    ' </span>在目前的目錄中尋找<span lang="en-us"> message.htm</span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>set mf = f.OpenTextFile(realpath &amp; &quot;/message.htm&quot;)<span lang="en-us"> 
    ' </span>找到的話，將該檔案打開<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>flag=1　<span lang="en-us">'
    </span>重設旗號為<span lang="en-us"> 1 </span>，表示已找到<br>
    else<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>tempdir=mydir<span lang="en-us"> 
    ' </span>為了搜尋上層目錄方便，先將路徑字串放到另一個變數裡，以避免改到原來的路徑<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>x=len(tempdir)<span lang="en-us"> 
    ' </span>計算路徑的長度<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>do until x&lt;=0<span lang="en-us">&nbsp;&nbsp; 
    ' </span>以迴圈來搜尋，當路徑長度逐漸縮短到變成<span lang="en-us"> 0</span>，就表示搜尋已到終點，跳出迴圈<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>x = InStrRev(tempdir,&quot;/&quot;) - 1<span lang="en-us"> 
    ' </span>找出最右邊的<span lang="en-us"> /</span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if x&gt;0 then<span lang="en-us"> 
    ' </span>如果有找到，表示路徑字串中還有上層目錄<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>tempdir = left(tempdir,x) <span lang="en-us">&nbsp;' </span>
    將目前的路徑改到上層目錄<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>realdir = server.mappath(tempdir)<span lang="en-us"> ' </span>對應<span lang="en-us"> 
    web </span>路徑為真實的磁碟路徑<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>if f.FileExists(realdir &amp; &quot;/message.htm&quot;) then<span lang="en-us"> 
    ' </span>檢查是否有<span lang="en-us"> message.htm</span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>set mf = f.OpenTextFile(realdir &amp; &quot;/message.htm&quot;)<span lang="en-us"> 
    ' </span>找到的話，將該檔案打開<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>flag=1<span lang="en-us"> ' </span>重設旗號為<span lang="en-us"> 1 </span>
    ，表示已找到<span lang="en-us"> </span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>x=0<span lang="en-us"> ' </span>故意將路徑長度設為<span lang="en-us"> 0</span>，以便提早結束迴圈<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>end if <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>end if<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>loop<span lang="en-us"> '
    </span>透過迴圈逐一搜尋上層目錄是否含有<span lang="en-us"> message.htm</span>，直到找到或搜尋完畢為止<br>
    end if<br>
    if flag=1 then<span lang="en-us"> ' </span>找到<span lang="en-us"> message.htm
    </span>的後續處理<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>do until mf.AtEndOfStream<span lang="en-us"> 
    ' </span>檢查是否已經到達<span lang="en-us"> message.htm </span>的檔案結尾，若是則跳出迴圈<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>oneline = mf.ReadLine<span lang="en-us">&nbsp;&nbsp;&nbsp; 
    ' </span>每次讀取一行<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>myvar=split(oneline,&quot;=&quot;)<span lang="en-us"> 
    ' </span>將該行從<span lang="en-us"> = </span>號的地方切成兩半<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if myvar(0)=&quot;title&quot; then<span lang="en-us">&nbsp; 
    ' </span>檢查左半字串是否為<span lang="en-us"> title</span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>mytitle = myvar(1)<span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp; '
    </span>若是，則將右半字串指定給<span lang="en-us"> mytitle </span>變數，作為變數值<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>elseif myvar(0)=&quot;width&quot; then<span lang="en-us"> 
    ' </span>檢查左半字串是否為<span lang="en-us"> width</span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>mywidth = myvar(1)<span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    ' </span>若是，則將右半字串指定給<span lang="en-us"> mywidth </span>變數，作為變數值<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>elseif myvar(0)=&quot;height&quot; then<span lang="en-us"> 
    ' </span>檢查左半字串是否為<span lang="en-us"> height</span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>myheight = myvar(1)<span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    ' </span>若是，則將右半字串指定給<span lang="en-us"> myheight </span>變數，作為變數值<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>elseif myvar(0)=&quot;number&quot; then<span lang="en-us"> 
    ' </span>檢查左半字串是否為<span lang="en-us"> number</span><br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>mynumber = myvar(1)<span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    ' </span>若是，則將右半字串指定給<span lang="en-us"> mynumber </span>變數，作為變數值<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>messages = messages &amp; oneline<span lang="en-us"> ' </span>
    如果不符合所有條件，表示該行是要顯示在網頁的訊息，就加到<span lang="en-us"> messages </span>變數<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>end if<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>loop<span lang="en-us"> '
    </span>透過這個迴圈將會對<span lang="en-us"> message.htm </span>作逐行剖析，找到相關的組態設定<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>mf.Close<span lang="en-us"> '
    </span>關閉被開啟的<span lang="en-us"> message.htm </span>檔案<br>
    end if<br>
    　</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    if len(mytitle)=0 then mytitle=&quot;【我的檔案】&quot;<span lang="en-us"> '
    </span>如果站長沒有指定標題，那就用這個代替<br>
    %&gt;<br>
    &lt;html&gt;<br>
    &lt;head&gt;<br>
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=big5&quot;&gt;<br>
    &lt;title&gt;&lt;% =mytitle %&gt;&lt;/title&gt;<span lang="en-us"> &lt;!--
    </span>設定網頁標題<span lang="en-us"> --&gt;</span><br>
    &lt;style fprolloverstyle&gt;A:hover {color: 
    #FF0000}&lt;/style&gt;<br>
    &lt;script&gt;<br>
    function bgcolor(mycolor)<span lang="en-us"> &lt;!-- </span>
    這支程式用來動態改變顏色，必須代入變數，告訴程式要改成哪個顏色<span lang="en-us"> --&gt;</span><br>
    {<br>
    if (mycolor==&quot;&quot;) mycolor = &quot;#&quot; + document.all[&quot;Red&quot;].value + 
    document.all[&quot;Green&quot;].value + 
    document.all[&quot;Blue&quot;].value;document.bgColor=mycolor;document.body.background='manager/none.gif';<br>
    }<br>
    　</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    function bgpic(picname) <span lang="en-us">&lt;!-- </span>
    這支程式用來動態改變背景圖，必須代入變數，告訴程式要改成哪個圖檔<span lang="en-us"> --&gt;</span><br>
    {<br>
    document.body.background=picname;<br>
    }<br>
    &lt;/script&gt;<br>
    <font color="#808080">&lt;Script Language=&quot;VBScript&quot;&gt;<br>
    &lt;!--　</font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font color="#808080">/* 因為程式並沒有真正製作縮圖,網路擁塞時會不知道是否傳完,下面這段 Scriopt 僅供參考用,可以略過 
    */<br>
    Dim Bar, Line, SP<br>
    Bar = 0 <br>
    Line = &quot;■&quot;<br>
    SP = 100<br>
    Function Window_onLoad()<br>
    Bar = 95<br>
    SP = 10<br>
    End Function<br>
    Function Count()<br>
    If Bar &lt; 100 Then<br>
    Bar = Bar + 1<br>
    Window.Status = &quot;載入狀態：&quot; &amp; Bar &amp; &quot;%&quot; &amp; &quot; &quot; &amp; String(Bar, Line)<br>
    setTimeout &quot;Count()&quot;, SP<br>
    Else<br>
    Window.Status = &quot;載入狀態：完成&quot;<br>
    Document.Body.Style.Display = &quot;&quot; <br>
    End If <br>
    End Function<br>
    Call Count()<br>
    --&gt;<br>
    &lt;/Script&gt;</font><br>
    &lt;/head&gt;<br>
    &lt;body bgcolor=#ddeeff style=&quot;font-size: 9pt&quot;&gt;<br>
    &lt;h1 align=&quot;center&quot;&gt;&lt;font 
    color=&quot;#008000&quot;&gt;&lt;% =mytitle %&gt;&lt;/h1&gt;<span lang="en-us"> 
    &lt;!-- </span>顯示標題<span lang="en-us"> --&gt;</span><br>
    &lt;% = messages %&gt;<span lang="en-us"> &lt;!-- </span>顯示<span lang="en-us"> 
    message.htm </span>中的附加訊息<span lang="en-us"> --&gt;</span><br>
    &lt;p align=&quot;center&quot; style=&quot;margin-top: 10; margin-bottom: 0&quot;&gt;目前所在位置：&lt;%=mydir%&gt;
    <br>
    &lt;div align=&quot;center&quot;&gt;<br>
    &lt;hr width=90% color=#FF0000&gt;&lt;table border=0&gt;&lt;tr&gt;<br>
    &lt;% <br>
    i=0 <span lang="en-us">' </span>將檔案計數器歸零<br>
    for each f1 in fc <span lang="en-us">' </span>逐一取出子資料夾物件放到<span lang="en-us"> 
    f1 </span>變數中<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>mydate=year(f1.DateLastModified) &amp; &quot;/&quot; &amp; month(f1.DateLastModified) &amp; &quot;/&quot; &amp; 
    day(f1.DateLastModified)<span lang="en-us"> ' </span>重組日期字串的格式，以方便顯示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>if date()-f1.DateLastModified &lt;= 6 then<span lang="en-us"> 
    ' </span>檢查是否為一週內的檔案<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mynew=mydate &amp; &quot;&lt;font color=red size=1&gt;new&lt;br&gt;&quot;<span lang="en-us"> 
    ' </span>若是，則在檔名後方寫一個<span lang="en-us"> new </span>來加強標示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>else<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mynew=mydate &amp; &quot;&lt;br&gt;&quot;<span lang="en-us"> 
    ' </span>若否，僅顯示檔名<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>end if<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>if left(f1.name,1) &lt;&gt; &quot;_&quot; and f1.name&lt;&gt;&quot;manager&quot; then
    <span lang="en-us">' </span>避開<span lang="en-us"> frontpage </span>自動產生的<span lang="en-us"> 
    _ </span>開頭的目錄及本程式使用的<span lang="en-us"> manager </span>
    目錄，這些目錄將被隱藏不顯示，其餘符合條件的目錄則繼續進行後續處理<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>i=i+1<span lang="en-us"> 
    ' </span>首先將計數器加一<span lang="en-us"> </span>&nbsp;<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a 
    href='index.asp?dir=&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp;<span lang="en-us">
    </span>&quot;' 
    onmouseover=document.all['&quot; &amp; f1.name &amp; &quot;'].src='manager/folder2.gif'; 
    onmouseout=document.all['&quot; &amp; f1.name &amp; &quot;'].src='manager/folder1.gif';&gt;&lt;img 
    id='&quot; &amp; f1.name &amp; &quot;' src=manager/folder1.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name &amp; 
    &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; mynew &amp; chr(13))<span lang="en-us"> 
    ' </span>顯示目錄小圖示、超連結和目錄名稱<span lang="en-us">...</span>等相關訊息<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if i mod 6 = 0 then<span lang="en-us"> 
    ' </span>已經顯示的子資料夾數量是否為<span lang="en-us"> 6 </span>的倍數 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;/tr&gt;&lt;tr&gt;&quot;)<span lang="en-us"> 
    ' </span>若是，則換行 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>end if <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>end if <br>
    next <br>
    %&gt;<br>
    &lt;/tr&gt;&lt;/table&gt;&lt;table border=0&gt;&lt;tr&gt;<br>
    &lt;%<br>
    i=0<span lang="en-us"> ' </span>將檔案計數器再度歸零<br>
    if mynumber&lt;=0 then mynumber=6<span lang="en-us"> ' </span>檢查每行要顯示的圖檔數是否為<span lang="en-us"> 
    0 </span>或小於<span lang="en-us"> 0</span>，若是，則預設顯示六張圖<br>
    for each f1 in fl<span lang="en-us"> ' </span>逐一取出檔案物件放到<span lang="en-us"> 
    f1 </span>變數中<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>extname = f.GetExtensionName(realpath &amp; &quot;/&quot; &amp; f1.Name)<span lang="en-us"> 
    ' </span>讀取附加檔名<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>mydate=year(f1.DateLastModified) &amp; &quot;/&quot; &amp; month(f1.DateLastModified) &amp; &quot;/&quot; &amp; 
    day(f1.DateLastModified)<span lang="en-us"> ' </span>重組日期字串的格式，以方便顯示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>if date()-f1.DateLastModified &lt;= 6 then<span lang="en-us"> 
    ' </span>檢查是否為一週內的檔案<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mynew=&quot;K&lt;img src=manager/new.gif&gt;&lt;br&gt;&quot;<span lang="en-us"> 
    ' </span>若是，則以動態圖檔來加強標示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>else<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mynew=&quot;K&lt;br&gt;&quot;<span lang="en-us"> 
    ' </span>若否，不用加強標示，直接換行<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>end if<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>i=i+1 <span lang="en-us">'
    </span>將檔案計數器加一<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>if f1.Name=&quot;message.htm&quot; then<span lang="en-us"> 
    ' </span>避開<span lang="en-us"> message.htm </span>不顯示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>i=i-1
    <span lang="en-us">' </span>此檔案不算數，因此將計數器減一<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;MID&quot; or Ucase(extname)=&quot;RMI&quot; or Ucase(extname)=&quot;AU&quot; 
    or Ucase(extname)=&quot;WAV&quot; then <span lang="en-us">' </span>
    檢查附加檔名是否為音樂類型的檔案<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style=font-size:9pt align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; 
    &quot;K&lt;br&gt;&lt;embed src=&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot; autostart=false loop=false 
    width=75 height=20&gt;&quot; &amp; mynew &amp; chr(13))<span lang="en-us"> '
    </span>此類檔案顯示小圖示而非縮圖<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;GIF&quot; or Ucase(extname)=&quot;JPG&quot; or Ucase(extname)=&quot;JPEG&quot; 
    or Ucase(extname)=&quot;PNG&quot; then <span lang="en-us">' </span>
    檢查附加檔名是否為圖形檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>z = InStr(mydir,&quot;背景&quot;)<span lang="en-us"> 
    ' </span>在路徑字串中搜尋<span lang="en-us"> </span>背景<span lang="en-us"> </span>關鍵字<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if z&gt;0 then<span lang="en-us"> 
    ' </span>如果有找到，則允許動態切換背景，進行底下後續處理<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>if mywidth=0 and myheight=0 then<span lang="en-us"> ' </span>
    檢查是否未指定縮圖大小 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a 
    href=javascript:bgpic('&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;')&gt;&lt;img src=&quot; &amp; mydir &amp; 
    &quot;/&quot; &amp; f1.name &amp; &quot; border=0 onmouseclick=bgpic('&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; 
    &quot;')&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size*100/1024)/100 &amp; mynew &amp; 
    chr(13)) <span lang="en-us">' </span>以原圖大小顯示圖檔，並設定<span lang="en-us"> 
    onmouseclick </span>事件，以便進行背景圖切換<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>elseif mywidth&gt;0 and myheight=0 then<span lang="en-us"> ' </span>
    是否僅指定縮圖寬度<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a 
    href=javascript:bgpic('&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;')&gt;&lt;img src=&quot; &amp; mydir &amp; 
    &quot;/&quot; &amp; f1.name &amp; &quot; border=0 width=&quot; &amp; mywidth &amp; &quot; onmouseclick=bgpic('&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;')&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) 
    &amp; mynew &amp; chr(13)) <span lang="en-us">' </span>以寬度為基準來縮放圖檔，並設定<span lang="en-us"> 
    onmouseclick </span>事件，以便進行背景圖切換<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>elseif myheight&gt;0 and mywidth=0 then<span lang="en-us"> ' </span>
    是否僅指定縮圖高度<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a 
    href=javascript:bgpic('&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;')&gt;&lt;img src=&quot; &amp; mydir &amp; 
    &quot;/&quot; &amp; f1.name &amp; &quot; border=0 height=&quot; &amp; myheight &amp; &quot; onmouseclick=bgpic('&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;')&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) 
    &amp; mynew &amp; chr(13))　<span lang="en-us">' </span>以高度為基準來縮放圖檔，並設定<span lang="en-us"> 
    onmouseclick </span>事件，以便進行背景圖切換<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>else<span lang="en-us"> ' </span>其餘情形，也就是縮圖的寬度和高度都有指定時<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a 
    href=javascript:bgpic('&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;')&gt;&lt;img src=&quot; &amp; mydir &amp; 
    &quot;/&quot; &amp; f1.name &amp; &quot; border=0 width=&quot; &amp; mywidth &amp; &quot; height=&quot; &amp; myheight &amp; 
    &quot;&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>以指定方式縮放，有時候會造成圖檔變形，設定<span lang="en-us"> 
    onmouseclick </span>事件，以便進行背景圖切換<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>end if<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else<span lang="en-us"> 
    ' </span>找不到<span lang="en-us"> </span>背景<span lang="en-us"> </span>
    關鍵字時，不作背景圖切換，改為顯示原圖，處理方式如下<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>if mywidth=0 and myheight=0 then <span lang="en-us">' </span>
    檢查是否未指定縮圖大小<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot; 
    border=0&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size*100/1024)/100 &amp; mynew &amp; 
    chr(13))<span lang="en-us"> ' </span>以原圖大小顯示圖檔 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>elseif mywidth&gt;0 and myheight=0 then<span lang="en-us"> ' </span>
    是否僅指定縮圖寬度<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot; target=&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=&quot; &amp; mydir &amp; &quot;/&quot; &amp; 
    f1.name &amp; &quot; border=0 width=&quot; &amp; mywidth &amp; &quot;&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; 
    int(f1.size/1024) &amp; mynew &amp; chr(13)) <span lang="en-us">' </span>
    以寬度為基準來縮放圖檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>elseif myheight&gt;0 and mywidth=0 then<span lang="en-us"> ' </span>
    是否僅指定縮圖寬度<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot; border=0 
    height=&quot; &amp; myheight &amp; &quot;&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; 
    mynew &amp; chr(13)) <span lang="en-us">' </span>以高度為基準來縮放圖檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>else<span lang="en-us"> ' </span>其餘情形，也就是縮圖的寬度和高度都有指定時<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=&quot; &amp; mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot; border=0 
    width=&quot; &amp; mywidth &amp; &quot; height=&quot; &amp; myheight &amp; &quot;&gt;&lt;br&gt;&quot; &amp; f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; 
    int(f1.size/1024) &amp; mynew &amp; chr(13)) <span lang="en-us">' </span>
    以指定方式縮放圖檔，有時候會造成圖檔變形<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>end if<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>end if<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;HTML&quot; or Ucase(extname)=&quot;HTM&quot; then
    <span lang="en-us">' </span>檢查附加檔名是否為網頁檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/ie.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name &amp; 
    &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;DOC&quot; then<span lang="en-us"> 
    ' </span>檢查附加檔名是否為<span lang="en-us"> Word </span>文字檔 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/doc.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;PPT&quot; then
    <span lang="en-us">' </span>檢查附加檔名是否為簡報檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/ppt.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;EXE&quot; or Ucase(extname)=&quot;BAT&quot; or Ucase(extname)=&quot;COM&quot; 
    then <span lang="en-us">' </span>檢查附加檔名是否為執行檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/exe.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))<span lang="en-us"> 
    ' </span>顯示小圖示 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;MDB&quot; then
    <span lang="en-us">' </span>檢查附加檔名是否為資料庫檔案<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/mdb.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))<span lang="en-us"> 
    ' </span>顯示小圖示 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;XLS&quot; or Ucase(extname)=&quot;CSV&quot; then
    <span lang="en-us">' </span>檢查附加檔名是否為<span lang="en-us"> Excel </span>檔案<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/xls.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;BMP&quot; or Ucase(extname)=&quot;UFO&quot; then<span lang="en-us"> 
    ' </span>檢查附加檔名是否為<span lang="en-us"> BMP </span>或<span lang="en-us"> UFO
    </span>圖檔 <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/gif.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;TXT&quot; or Ucase(extname)=&quot;&quot; or Ucase(extname)=&quot;&quot; then
    <span lang="en-us">' </span>檢查附加檔名是否為純文字檔案<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/text.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;MPG&quot; or Ucase(extname)=&quot;MPE&quot; or 
    Ucase(extname)=&quot;AVI&quot;then <span lang="en-us">' </span>檢查附加檔名是否為影音檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/mpg.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;ZIP&quot; then
    <span lang="en-us">' </span>檢查附加檔名是否為壓縮類型的檔案<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style='font-size:9pt' align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/zip.gif border=0&gt;&lt;br&gt;&quot; &amp; f1.name 
    &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>顯示小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>elseif Ucase(extname)=&quot;ASP&quot; or Ucase(extname)=&quot;BAK&quot; then<span lang="en-us"> 
    ' </span>檢查附加檔名是否為<span lang="en-us"> ASP </span>程式或其備份檔<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>i=i-1<span lang="en-us"> 
    ' </span>此檔案不顯示，因此將計數器減一<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>else<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>response.write(&quot;&lt;td style=font-size:9pt align=center width=75&gt;&lt;a href=&quot; &amp; 
    mydir &amp; &quot;/&quot; &amp; f1.name &amp; &quot;&gt;&lt;img src=manager/other.gif border=0&gt;&lt;br&gt;&quot; &amp; 
    f1.name &amp; &quot;&lt;/a&gt;&lt;br&gt;&quot; &amp; int(f1.size/1024) &amp; mynew &amp; chr(13))
    <span lang="en-us">' </span>不認識的檔案類型顯示系統預設小圖示<br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>end if <br>
    <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>if i mod mynumber = 0 then
    response.write(&quot;&lt;/tr&gt;&lt;tr&gt;&quot;) <span lang="en-us">'
    </span>檢查是否已到達該換行的數量，若是，則換行<br>
    next <br>
    %&gt; <br>
    &lt;/tr&gt;&lt;/table&gt;<br>
    &lt;hr width=&quot;90%&quot; color=&quot;#FF0000&quot;&gt; <br>
    &lt;p align=&quot;center&quot; style=&quot;margin-top: 0; margin-bottom: 0&quot;&gt; <br>
    &lt;% if mydir = &quot;.&quot; then %&gt; <br>
    &lt;a href=&quot;./&quot;&gt;&lt;img src=manager/uplevel.gif border=0&gt;回首頁&lt;/a&gt; <br>
    &lt;% else %&gt; <br>
    &lt;a href=&quot;index.asp?dir=.&quot;&gt;&lt;img src=manager/menu.gif border=0&gt;回目錄&lt;/a&gt; &lt;a 
    href=&quot;index.asp?dir=&lt;% =uplevel %&gt;&quot;&gt;&lt;img src=manager/uplevel.gif 
    border=0&gt;回上一頁&lt;/a&gt;&amp;nbsp; <br>
    &lt;% end if %&gt;<br>
    &lt;/BODY&gt;<br>
　</div>
  </blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(二十六)、<span lang="EN-US" style="line-height: 300%">#INCLUDE</span><span style="line-height: 300%">&nbsp;
</span><span lang="EN-US" style="line-height: 300%">包</span><span style="line-height: 300%">含</span><span lang="EN-US" style="line-height: 300%">檔</span><span style="line-height: 300%">的用法</span></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">　　您可在現有的<span lang="EN-US">ASP程式</span>中，<span lang="EN-US">插入另外一個「被包括」的檔案，執行到此處時</span>會<span lang="EN-US">先執行此「被包括」的檔案後，再繼續執行下一行的程式碼。使用的是「#INCLUDE」的語法，語法如下：</span></span></p>
  <ul>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
    &lt;!--#INCLUDE VIRTUAL|FILE=&quot;filename&quot;--&gt;</span></li>
  </ul>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">　<span lang="EN-US">其中VIRTUAL代表虛擬的檔案位址，FILE代表絕對的檔案位址，如下：</span></span></p>
  <ul>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
    &lt;!--#INCLUDE VIRTUAL=&quot;/booksamp/test.inc&quot;--&gt;<br>
　</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
    &lt;!--#INCLUDE FILE=&quot;test/test.inc&quot;--&gt;</span></li>
  </ul>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">　附加檔案名稱建議使用<span lang="EN-US">.inc，但是也可以使用任何附加檔案名稱。您可使用FILE和「../ 
  」代表上一層的檔案目錄。「#INCLUDE」的語法，適用於多個網頁共同使用的部份，有點像副程式，供多個ASP程式碼呼叫使用。</span></span></p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(二十七</span></font></font></span><span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">)、<span style="line-height: 300%">用</span><span lang="EN-US" style="line-height: 300%">Cookies存取</span><span style="line-height: 300%">寫在</span><span lang="EN-US" style="line-height: 300%">用戶端</span><span style="line-height: 300%">瀏覽器的方法</span></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">　　<span lang="EN-US">使用 Cookies，可讓您於用戶端的硬碟上儲存一些資訊，譬如當來訪者輸入其姓名</span>、EMAIL、密碼<span lang="EN-US">等資料時，使用Cookies將之儲存於來訪者用戶端的</span>瀏覽器(<span lang="EN-US">硬碟</span>)<span lang="EN-US">上，下次這位來訪者再度瀏覽此網站時，即可讀取此Cookies直接得知來訪者的身份。</span></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
  ASP 存取讀寫 Cookies 的方式，係使用ASP 兩個內建的「物件」</span><span style="vertical-align: baseline; letter-spacing: 1pt">：</span><span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">Response 和 Request，十分簡單，如下：</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">寫入<span lang="EN-US">Cookies：</span></span></p>
  <blockquote>
    <ul>
      <li>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      Response.Cookies(&quot;待寫入的Cookies名稱&quot;) = &quot;待寫入資料&quot;</span></li>
    </ul>
  </blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">讀取<span lang="EN-US">Cookies：</span></span></p>
  <blockquote>
    <ul>
      <li>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      get_your_cookies<span lang="EN-US"> = Request.Cookies(&quot;待讀取的Cookies名稱&quot;)</span></span></li>
    </ul>
  </blockquote>
</blockquote>
<hr>
<h3>　</h3>
<h3>肆、ODBC 連結機制</h3>
<blockquote>
  <p style="line-height: 150%">　　當我們開始開發資料庫應用程式時，須先熟悉 ADO 物件中的子物件：Connection。</p>
  <p style="line-height: 150%">　　Connection 物件用來建立程式與資料庫之間的連結。這種連結方式是國際通用的標準，稱為 ODBC（Open DataBase Connection）。</p>
  <p style="line-height: 150%">　　Connection 物件最重要工作，是把 ASP 程式中的連結字串（Connect 
  String）傳送給 ODBC 處理，ODBC 收到後，剖析該字串，並且使用專有的 TCP / UDP 
  通訊協定來與資料庫溝通（MsSQL:1433Port／MySQL:3306Port ）。</p>
  <p style="line-height: 150%">　　這個資料庫連結的字串，必須包含建立連結時所需要的一切資訊，像是：資料庫種類、Server 
  名稱、資料庫名稱、登入的帳號密碼和認證方式、資料型態設定（語系、數字、貨幣設定...等等）。</p>
  <p style="line-height: 150%">　　當連結建立成功之後，Connecting 
  物件就會把這些資訊保留在記憶體內，以便隨時維護連線不使它中斷。</p>
  <p style="line-height: 150%">　　ODBC 是國際標準，所有的資料庫都有支援。透過 ODBC 
  這個服務，您可以跨平台連結任何不同品牌、類別的後端資料庫。例如：我們想連結 mySQL，那麼只要安裝 myODBC 的函式庫到我們的電腦上面，就可以在 
  ASP 裡面以 Connection 物件來存取 mySQL 資料庫。</p>
  <p style="line-height: 150%">　　早期ASP程式設計師使用 DSN （Data Source Name）來連結資料庫，DSN 
  檔案的內容是純文字，內含資料庫類型、路徑甚至開啟資料庫的帳號、密碼，因為太容易被使用者猜出、下載，對系統安全影響甚鉅，所以不再被程式設計師愛用。</p>
  <p style="line-height: 150%">　　大部分的做法是把 DSN 的檔案內的〝連結字串〞，直接寫在 ASP 
  程式碼中。這樣做的好處是，當程式移植到另一台主機時，只要對連接字串進行小修改甚至是不需修改，就可以直接執行，遷移性非常強。</p>
  <p style="line-height: 150%">　　由於一個完整的資料庫應用程式，由多個 ASP 程式組成，每段程式進行資料庫存取時，都需透過 
  ODBC 建立資料庫連結，這會造成資料庫開開關關，同一程序反覆執行的後果，而使得資料庫存取的效能變差。因此比較好的做法是在資料庫連結建立後，將 
  Connection 物件保存在 Application 物件內，如此一來，資料庫連結將與站台永遠同在，執行效能當然也會變好。</p>
  <p style="line-height: 150%">　　但是，如果把少用而多量的資料庫連結存放在 Application 
  物件內，也會導致伺服器效能急速下降，必須重開機才能釋放資源，反而得不償失。</p>
  <p style="line-height: 150%">　　在新版的 IIS 伺服器上，支援 Connection pool 功能，也就是說即使 ASP 
  程式將 Connection 物件關閉了，但是它並不會真正消失，而會保留在記憶體區塊（pool）裡面（並非<span lang="en-us"> 
  Application </span>物件），等下次再開啟資料庫時，直接回存連結物件而不是重新建立連結，這樣就會讓初學者的 ASP 程式的表現比較專業！</p>
</blockquote>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(一)、使用資料庫--</span>ADO物件</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　　當我們開始撰寫需要存取到資料庫的ASP程式時，就需要學會怎樣使用<span lang="en-us"> </span>ADO(ActiveX Data 
  Ojects)<span lang="en-us"> </span>物件了。它是WEB程式存取資料庫的介面。ADO物件的簡易模型如下:</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  </p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
  <img border="0" src="images/ASP.as3.gif" width="435" height="394"></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  (二)、</span><b>ADO物件的相關物件和屬性</b></p>
</blockquote>
  <table border="1" cellpadding="3" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="90%" id="AutoNumber29" height="383">
    <tr>
      <td width="36%" align="center" height="28" bgcolor="#ECECFF"><b>物件</b></td>
      <td width="70%" align="center" height="28" bgcolor="#ECECFF"><b>屬性/方法</b></td>
    </tr>
    <tr>
      <td width="36%" height="67">Connection 物件<p>準備執行SQL指令前要先開啟資料連結做準備</td>
      <td width="70%" height="67">ConnectionString,CommandTimeout , Mode<p>Open, 
      Close, Execute</td>
    </tr>
    <tr>
      <td width="36%" height="51">Command 物件<p>定義想要執行的SQL指令</td>
      <td width="70%" height="51">CommandText , CommandType , CommandTimeout<p>
      Execute</td>
    </tr>
    <tr>
      <td width="36%" height="16">Paramter物件</td>
      <td width="70%" height="16">伴隨SQL指令的參數</td>
    </tr>
    <tr>
      <td width="36%" height="118">RecordSet 物件<p>使用Connection開啟的資料錄</td>
      <td width="70%" height="118">
      AbsolutePage,AbsolutePosition,ActiveConnection,Bookmark,CacheSize, 
      EditMode, EOF, BOF, MaxRecords, PageCount, PageSize,RecordCount,<p>
      RecordSet 中的 CursorType:Dynamic/keyset/static/Forward-only</p>
      <p>AddNew ,Close , Delete , GetRows , Move , MoveFirst , MoveLast , 
      MoveNext , MovePrevious , Open ,Update</td>
    </tr>
    <tr>
      <td width="36%" height="16">Fields 物件</td>
      <td width="70%" height="16">RecordSet 物件中的欄位</td>
    </tr>
    <tr>
      <td width="36%" height="16">Errors 物件</td>
      <td width="70%" height="16">ADO連結有錯誤時儲存錯誤訊息用的物件</td>
    </tr>
    <tr>
      <td width="36%" height="16">Property 物件</td>
      <td width="70%" height="16">內含ADO的特性，有內建與動態兩種類型</td>
    </tr>
  </table>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  (三)、存取資料庫步驟</span></p>
</blockquote>
<div align="center">
  <center>
  <table id="AutoNumber27" style="border-collapse: collapse; font-size:11 pt" borderColor="#111111" cellPadding="2" width="81%" border="1">
    <tr>
      <td align="middle" width="34%" height="32">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">動　　作</span></td>
      <td align="middle" width="135%" colSpan="2" height="32">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">範　　　　例</span></td>
    </tr>
    <tr>
      <td width="34%" height="16" align="center">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">建立ADO物件的連結</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">Set conn = 
      Server.CreateObject(&quot;ADODB.Connection&quot;)</span></td>
      <td width="71%" height="64" rowSpan="4">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">第一步</span></td>
    </tr>
    <tr>
      <td width="34%" height="16" align="center">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">取得資料庫路徑</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">DBPath = 
      Server.MapPath(&quot;ysps.mdb&quot;)</span></td>
    </tr>
    <tr>
      <td width="34%" height="16" align="center">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">指定資料庫驅動程式類型</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      driver={Microsoft Access Driver (*.mdb)};</span></td>
    </tr>
    <tr>
      <td width="34%" height="16" align="center">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">開啟資料連結</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">conn.Open 
      &quot;driver={Microsoft Access Driver (*.mdb)};dbq=&quot; &amp; DBPath</span></td>
    </tr>
    <tr>
      <td width="34%" height="16" align="center">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">產生資料錄</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">Set rs = 
      Server.CreateObject(&quot;ADODB.Recordset&quot;)</span></td>
      <td width="71%" height="80" rowSpan="4">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">第二步</span></td>
    </tr>
    <tr>
      <td width="34%" height="16" align="center">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">以SQL語法選取資料內容</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">查詢語法 </span>
      </p>
      <blockquote>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="vertical-align: baseline; letter-spacing: 1pt">
        SQLString=&quot;SELECT * FROM my_table Where <span lang="en-us">my_</span>no&gt;2&quot; </span></p>
      </blockquote>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">新增資料 </span>
      </p>
      <blockquote>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="vertical-align: baseline; letter-spacing: 1pt">
        SQLString=&quot;Insert into my_table(<span lang="en-us">my_no,</span>my_name) 
        values(<span lang="en-us">20,</span>'<span lang="en-us">dd</span>')&quot;</span></p>
      </blockquote>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">刪除資料 </span>
      </p>
      <blockquote>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        SQLString=&quot;delete * from my_table where <span lang="en-us">my_</span>no=10<span lang="en-us">&quot;</span></span></p>
      </blockquote>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">修改</span></p>
      <blockquote>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="vertical-align: baseline; letter-spacing: 1pt">SQLString = 
        &quot;Update my_table set <span lang="en-us">my_</span>tel = '28975966' where 
        <span lang="en-us">my_</span>name='dd'<span lang="en-us"> </span>&quot;</span></p>
      </blockquote>
      </td>
    </tr>
    <tr>
      <td width="34%" height="16">
      <p align="center" style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">執行SQL字串</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">
      conn.excute(&quot;SQLString&quot;)</span></td>
    </tr>
    <tr>
      <td width="34%" height="32">
      <blockquote>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        讀寫資料錄[RecordSet物件]各種屬性操作，也許利用到各類迴圈和判斷式</span></p>
      </blockquote>
      </td>
      <td width="64%" height="32">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">RecordSet<span lang="en-us">
      </span>的各種屬性 
      </span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.Fields.Count：RecordSets 的欄位數。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS(i).Name：第 i 個欄位名稱，i 由 0 算起到 RS.Fields.Count-1。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS(i)：讀取第 i 個欄位的資料，i 由 0 算起到 RS.Fields.Count-1。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <span lang="EN-US">RS(“</span>欄位名稱”<span lang="EN-US">)：讀取指定欄位的資料。</span></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.EOF：是（True）否（False）已指到最末筆。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.MoveNext：將指標移到下一筆。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.MovePrev：將指標移到上一筆。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.MoveFirst：將指標移到第一筆。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.MoveLast：將指標移到最末筆。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.GetRows：將查詢結果存於陣列當中，如 v=RS.GetRows(100)，再讀取陣列 v(col，row) 的值即為查詢的資料。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.Properties.Count：得知 ADO 的 Connection 或 Resultset 之屬性總數。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.Properties(Item).Name：得知 ADO 的 Connection 或 Resultset 之屬性名稱。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.Properties(Item)：得知 ADO 的 Connection 或 Resultset 之屬性值。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      最後，顯示後使用如下的指令，關閉資料庫：</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      RS.Close</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt" lang="EN-US">
      Conn.Close</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</td>
    </tr>
    <tr>
      <td width="34%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">關閉資料錄</span></td>
      <td width="64%" height="16">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">rs.close</span></td>
      <td width="71%" height="48" rowSpan="2">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">第三步</span></td>
    </tr>
    <tr>
      <td width="34%" height="32">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">關閉ADO連結</span></td>
      <td width="64%" height="32">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline; letter-spacing: 1pt">conn.close<br>
　</span></td>
    </tr>
  </table>
  </center>
</div>
<blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
　</p>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
(四)、
把連結字串放入global.asa中的 Application變數,便於日後取用</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    　　<span style="letter-spacing: 1pt; vertical-align: baseline">前四項開啟資料庫連結的處理上，比較好的解決辦法是把資料庫的連結字串&#65339;Connection String&#65341;，放入你的根目錄&#65339;或虛擬目錄&#65341;下的 
    global.asa 中，讓它變成 application 在記憶體中常駐，看起來像這樣：</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    　</p>
    <div style="width: 663; height: 224; border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline">&lt;SCRIPT LANGUAGE=VBScript 
      RUNAT=Server&gt;</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline">Sub Application_OnStart<br>
      <font color="#3776BB">'以下此行設定資料庫來源 請改為正確路徑</font><br>
      <font size="2">Application(&quot;ysps1&quot;) = &quot;Driver={SQL 
      Server};Server=ysps1;database=JSDB;uid=SYSUSER;pwd=SYSUSER&quot;<br>
      Application(&quot;spps&quot;) = &quot;Driver={SQL 
      Server};Server=ysps1;database=spps;uid=SYSUSER;pwd=SYSUSER&quot;<br>
      Application(&quot;board&quot;) = &quot;Driver=driver={Microsoft Access Driver 
      (*.mdb)};dbq=d:\inetpub\wwwroot\board\board.mdb;PWD=123456&quot;<br>
      </font>END SUB<br>
      &lt;/SCRIPT&gt;</span></div>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    　</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    然後修改所有的asp程式碼，讓資料庫使用這個application。程式中開啟資料庫連結的寫法精簡一些，但效能卻好多了：</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">一般的寫法：<br>
    Set conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
    DBPath = Server.MapPath(&quot;/database/ysps.mdb&quot;)<br>
    conn.Open &quot;driver={Microsoft Access Driver (*.mdb)};dbq=&quot; &amp; DBPath</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    使用Application的寫法：<br>
    <font color="#FF0000">Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
    conn.open Application(&quot;ysps1&quot;)</font></span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  (五)、</span><span style="vertical-align: baseline; letter-spacing: 1pt; font-weight: 700">global.asa裡面放開啟資料庫的密碼安全嗎?</span></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">點這裡試試看你抓得到<font color="#4a76c6"><a href="http://dd.ysps.tp.edu.tw/global.asa">我的</a></font><font color="#3776bb"><a href="http://dd.ysps.tp.edu.tw/global.asa">global.asa</a></font>嗎?</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" dir="ltr">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    其實是抓不下來的，您會看到以下的畫面:(http 錯誤 500-15 )</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    <img border="0" src="images/ASP.ht15.jpg" width="549" height="445"></span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="vertical-align: baseline; letter-spacing: 1pt">IIS server 
    是不允許您存取該檔案的，所以在安全上並沒有問題。</span></p>
  </blockquote>
</blockquote>
<hr>
<blockquote>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
  </blockquote>
</blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="vertical-align: baseline"><font size="4">
<span style="font-weight: 700">伍</span></font></span><span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700"><font size="4">、<span lang="en-us">SQL </span>語法概說</font></span></p>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　　<span style="letter-spacing: 1pt; vertical-align: baseline">SQL 
  是「結構化查詢語言」（Structured Query Language）的簡稱，是由 IBM 公司於 1970 年代所發展出來，用於關連式資料庫 
  (Relational Databases) 當中的一種資料庫查詢語言，利用 SQL 
  可以用來定義資料庫結構、指定資料庫表格與欄位型態與長度、新增資料、修改資料、刪除資料、查詢資料，以及建立各重複雜的表格關連，成為一個查詢資料庫的標準語言。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  雖然各家資料庫所提供的 SQL 語法在功能上會略有差異，但基本的功能都是符合于ANSI SQL的。SQL 
  的設計基本上是模仿英文的自然語法，因此在入門上較為容易。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;&nbsp;&nbsp; 
  SQL指令最常用的四個基本查詢動作，即：瀏覽（查詢）、新增、修改、刪除，因此將來所設計的 Web asp程式，也通常會包含這四種功能。 </span>
  </p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
    (一)、</span><span style="letter-spacing: 1pt; vertical-align: baseline"><b>查詢資料</b>： 
    若要查詢資料庫的資料，使用的 SQL 指令是「SELECT」，基本語法如下： </span></p>
      <table border="1" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#111111" width="85%" id="AutoNumber1">
        <tr>
          <td width="100%" style="border-left-style: none; border-left-width: medium; border-right-style: none; border-right-width: medium; border-top-style: none; border-top-width: medium">
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="letter-spacing: 1pt; vertical-align: baseline">SELECT 
          欄位名稱1，欄位名稱2... FROM 資料表名稱1，資料表名稱2... WHERE 條件式 ORDER BY 
          欄位名稱1<span lang="en-us">&nbsp; </span>DESC(降冪排序)，欄位名稱2... </span></p>
          <ul>
            <li>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            SELECT：所接的欄位名稱為待查資料庫的欄位名稱，各欄位名稱之間以逗號隔開。 <br>
            FROM：所接的資料表名稱為待查資料庫的資料表名稱，各資料表名稱之間以逗號隔開。 <br>
            WHERE：設定查詢的條件式。 <br>
            ORDER BY： 
            設定要排序的欄位名稱，可將查詢的資料依照想要排序的資料表欄位加予排序，指定多個欄位時，就要以欄位名稱1排序，若其資料相同則再依欄位名稱2排序，依此類推，各欄位名稱之間以逗號隔開。 
            </span></li>
            <li>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">範例如下:</span></li>
          </ul>
          <blockquote>
            <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
              <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
              <span style="vertical-align: baseline; letter-spacing: 1pt; font-weight: 700">
              SQLString = &quot;select * from DEMP <font color="#800000">order by</font>
              <span lang="en-us">SEX</span> <font color="#800000">desc<span lang="en-us">,</span></font><span lang="en-us">NAME</span>&quot;&nbsp; </span></p>
              </div>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            →選取DEMP這個資料表的所有內容,並先照性別<b>降冪</b>排序（男生排前面），再依照姓名筆劃排序</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; ">
            在進行條件比對時，如果比對的欄位是數字欄位，則不加識別符號，例如：<span lang="en-us">where money &gt;= 
            3000</span>，如果該欄位為文字欄位，必須使用<span lang="en-us"> ' </span>來標示，例如：<span lang="en-us">where 
            NAME = </span><font color="#800000">
            <span style="letter-spacing: 1pt; font-weight: 700">'</span></font>張三</span><span style="vertical-align: baseline; letter-spacing: 1pt; font-weight: 700"><font color="#800000">'</font></span><span style="vertical-align: baseline">，如果是比對日期欄位，則用<span lang="en-us"> 
            # </span>來標示，例如：<span lang="en-us">where post_date &gt;= </span>
            <font color="#800000">
            <span style="letter-spacing: 1pt; font-weight: 700">#</span></font><span lang="en-us">2003/04/15</span><font color="#800000"><span style="letter-spacing: 1pt; font-weight: 700">#</span></font></span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline">常用的條件判斷還有：</span></p>
            <ol>
              <li>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline">文字欄位模糊比對：使用<span lang="en-us"> 
            Like </span>敘述配合<span lang="en-us"> % </span>符號來比對，例如：比對第一個是否為<span lang="en-us"> 
            &quot;</span>李<span lang="en-us">&quot;</span>，<span lang="en-us">where NAME
            </span><font color="#800000">
            <span style="letter-spacing: 1pt; font-weight: 700">Like</span></font><span lang="en-us"> 
            '</span>李<font color="#800000"><span style="letter-spacing: 1pt; font-weight: 700">%</span></font><span lang="en-us">'</span>，比對結尾是否為<span lang="en-us"> 
            &quot;</span>憲<span lang="en-us">&quot;</span>，<span lang="en-us">where NAME
            </span><font color="#800000">
            <span style="letter-spacing: 1pt; font-weight: 700">Like</span></font><span lang="en-us"> 
            '</span><font color="#800000"><span style="letter-spacing: 1pt; font-weight: 700">%</span></font>憲<span lang="en-us">'</span>，比對是否含有<span lang="en-us"> 
            &quot;</span>忠<span lang="en-us">&quot;</span>，<span lang="en-us">where NAME
            </span><font color="#800000">
            <span style="letter-spacing: 1pt; font-weight: 700">Like </span>
            </font><span lang="en-us">'</span><font color="#800000"><span style="letter-spacing: 1pt; font-weight: 700">%</span></font>忠<font color="#800000"><span style="letter-spacing: 1pt; font-weight: 700">%</span></font><span lang="en-us">'</span></span></p>
              </li>
              <li>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline">
            集合比對：比對欄位的值是否為集合中所列舉的其中一個，這可以運用在任何資料類型的欄位上，範例如下：</span></p>
              </li>
            </ol>
            <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
              <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
              <span style="vertical-align: baseline; letter-spacing: 1pt; font-weight: 700">
              SQLString = &quot;select * from BCLASS <font color="#800000">where
              </font>SYEAR=<font color="#FF0000">'</font><font color="#008000">&quot; 
              &amp; stryear &amp; &quot;</font><font color="#FF0000">'</font>
              <font color="#800000">and</font> SEME=<font color="#FF0000">'</font><font color="#008000">&quot; 
              &amp; strseme &amp; &quot;</font><font color="#FF0000">'</font> <font color="#800000">and</font>
              <span lang="en-us">left(</span>CLASSNO<span lang="en-us">,1) in 
              ('3','4','5','6')</span> <font color="#008000">&quot;</font></span></div>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            →選取BCLASS資料表內的所有資料但是SYEAR必須 = stryear變數的值(學年),且SEME必須 = 
            strseme變數的值(學期),且CLASSNO(班級代號)為<span lang="en-us"> 3,4,5,6 </span>
            其中任一個字元</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            　</p>
          </blockquote>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; font-weight: 700">合併查詢</span><span style="vertical-align: baseline">：當資料分布在多個資料表中，就必須使用合併查詢，合併查詢意思是將兩個資料表先合併成一個，然後再進行條件過濾，篩選出想找的資料記錄，依照合併方式的不同，又分為外部合併（<span lang="en-us">outter 
            join</span>）和內部合併（<span lang="en-us">inner join</span>），假設有兩個資料表，前者有十筆紀錄，後者也有十筆紀錄，兩者以學號來互相關聯，進行外部合併時，會將兩個資料表相乘，得到一個<span lang="en-us"> 
            100 </span>
            筆紀錄的新資料表，接著再逐筆過濾學號是否一樣；如果進行內部合併，則先以學號作為索引，將兩資料表中相同索引的紀錄合併為一筆，最後得到一個十筆紀錄的資料表。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline">
            　　由於內部合併比較省記憶體，而且如果欄位索引事先已經做好，其合併效能遠高於外部合併，因此底下僅介紹內部合併的方法：</span></p>
          <blockquote>
            <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
              <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
              <span style="vertical-align: baseline; letter-spacing: 1pt; font-weight: 700">
              SQLString = &quot;select <font color="#0000FF">A</font>.CLASSNO,<font color="#0000FF">A</font>.SEAT,<font color="#0000FF">B</font>.NAME,<font color="#0000FF">B</font>.SEX 
              from <font color="#0000FF">BSTD_SEME </font><font color="#008000">
              A</font> <font color="#800000">join</font> <font color="#0000FF">
              BSTD </font><font color="#008000">B</font> <font color="#800000">
              on</font> <font color="#008000">A.</font>STDNO=<font color="#008000">B.</font>STDNO 
              where <font color="#008000">A.</font>SYEAR=<font color="#FF0000">'</font><font color="#008000">&quot; 
              &amp; stryear &amp; &quot;</font><font color="#FF0000">'</font> and <font color="#008000">A.</font>SEME=<font color="#FF0000">'</font><font color="#008000">&quot; 
              &amp; strseme &amp; &quot;</font><font color="#FF0000">'</font> and A.STD_STATUS='1' and right(<font color="#008000">B.</font>BIRTHDAY,4) 
              = <font color="#008000">'&quot; &amp; my_today &amp; &quot;'</font> order by
              <font color="#008000">A.</font>CLASSNO&quot;</span></div>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            →把BSTD_SEME 這個資料表命名為<span lang="en-us"> </span>A，把BSTD 這個資料表命名做<span lang="en-us">
            </span>B，我要以<span lang="en-us"> </span>A、B<span lang="en-us"> </span>資料表裡面都有的<b><span lang="en-us">
            </span>STDNO<span lang="en-us"> </span></b>欄位(學號)當作索引來合併資料表。並篩選出<span lang="en-us">
            </span>A<span lang="en-us"> </span>的學年期和現在的學年期相等，而且學生的狀況為在學<span lang="en-us">
            </span>(</span><span style="vertical-align: baseline; letter-spacing: 1pt; font-weight: 700">A.STD_STATUS='1'</span><span style="letter-spacing: 1pt; vertical-align: baseline">)<span lang="en-us">
            </span>的學生，而且<span lang="en-us"> </span>B<span lang="en-us"> </span>資料表上的<span lang="en-us">
            </span>BIRTHDAY<span lang="en-us"> </span>欄位的後四碼是今天，找出來以後照年級來排序。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
          </blockquote>
          </td>
        </tr>
        <tr>
          <td width="100%" style="border-left-color: #111111; border-right-color: #111111; border-top-style: solid; border-top-width: 1; border-bottom-style: solid; border-bottom-width: 1">
          <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; font-weight: 700">
            　注意：當在<span lang="en-us"> ASP </span>程式中組合<span lang="en-us"> </span>
            SQL<span lang="en-us"> </span>敘述時，通常會使用變數來代入比對條件，這時候必須將<span lang="en-us">
            </span>SQL<span lang="en-us"> </span>
            字串與變數連接起來，方法是先用雙引號來標示兩段字串的範圍，然後用〝&amp;〞符號來連接字串，特別是在SQL<span lang="en-us">
            </span>敘述中進行文字欄位的比對時，不要忘記在變數值的前後，額外多用單引號來標示，此單引號為<span lang="en-us"> 
            SQL </span>語法的一部分，因此必須放在雙引號之內。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="font-weight: 700; vertical-align: baseline">&nbsp;&nbsp;
            </span><span style="vertical-align: baseline">
            通常我們會先把整句SQL語法寫完整後，然後再將變數逐個放入整個SQL字串內，這樣一來就不容易出錯。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline"><b>偵錯：當我們執行SQL語句發生錯誤時，會先把程式中的SQL字串印在網頁上，然後中止程式。例如：</b></span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            SQLString = &quot;select * from BCLASS where SYEAR='&quot; &amp; stryear &amp; &quot;' and 
            <span lang="en-us">SEME</span>=<span lang="en-us">'</span>&quot;<span lang="en-us"> 
            &amp; strseme &amp; &quot;'&quot;</span></span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="font-weight: 700; vertical-align: baseline">
            response.write SQLString </span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="font-weight: 700; vertical-align: baseline">
            response.end</span></p>
            </div>
          </td>
        </tr>
      </table>
    </blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font color="#808080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    作業：請找出底下的語法哪裡錯誤：</font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font color="#808080"><span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </span>
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            SQLString = &quot;select * from <span lang="en-us">SEMP</span> where 
    <span lang="en-us">NAME </span>=<span lang="en-us"> </span>'&quot; &amp; 
    <span lang="en-us">firstname</span> &amp; &quot;<span lang="en-us">%</span>' and
    <span lang="en-us">EMPID</span>=&quot;<span lang="en-us"> &amp; strid</span></span></font></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
    <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
    (二)、</span><span style="letter-spacing: 1pt; vertical-align: baseline"><b>新增資料</b>： 
    若要新增資料庫的資料，使用的 SQL 指令是「INSERT」，基本語法如下： </span></p>
      <table border="1" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#111111" width="85%" id="AutoNumber3">
        <tr>
          <td width="100%" style="border-style: none; border-width: medium">
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="letter-spacing: 1pt; vertical-align: baseline">INSERT 
          INTO 資料表名稱(欄位名稱1，欄位名稱2，...) VALUES ('欄位1的資料'，'欄位2的資料'，...) </span></p>
          <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
            <span style="letter-spacing: 1pt; vertical-align: baseline">SQL= &quot; 
            INSERT INTO <b>MY_TABLE</b>(NAME,PHONE,ADDRESS,BIRTH) VALUES 
            ('黃自強','28975966','新民路2號','19940101')&quot;</span></div>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
          有變數的話:</p>
          <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
            <span style="vertical-align: baseline; letter-spacing: 1pt">
            SQLString = &quot;INSERT INTO BITEM_SCORE&nbsp; 
            (SYEAR,SEME,EMPNO,ITEM,SUBJNO,STDNO,SCORE)<br>
            Values('&quot; &amp; stryear &amp; &quot;','&quot; &amp; strseme &amp; &quot;','&quot; &amp; strempno &amp; &quot;','&quot; &amp; 
            stritem &amp; &quot;','&quot; &amp; strcur &amp; &quot;','&quot; &amp; X &amp; &quot;',&quot; &amp; Request(X) &amp; &quot;)&quot;</span></div>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
          <span style="vertical-align: baseline">SQL字串太長可以分成兩段來連接:</span></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
          <span style="vertical-align: baseline"><font color="#0000FF"><b>
          SQLString </b></font>= &quot;Insert into award_question 
          (id,grade,question,correct,start_date,end_date,post_date) values (&quot;</span></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
          <span style="vertical-align: baseline"><b><font color="#0000FF">
          SQLString = SQLString &amp;</font></b> id &amp; &quot;,&quot; &amp; grade &amp; &quot;,'&quot; &amp; quiz &amp; 
          &quot;','&quot; &amp; correct &amp; &quot;','&quot; &amp; sdate &amp; &quot;','&quot; &amp; edate &amp; &quot;','&quot; &amp; pdate &amp; &quot;')&quot;<br>
　</span></td>
        </tr>
      </table>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline"><br>
    </span>
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
    (三)、</span><span style="letter-spacing: 1pt; vertical-align: baseline"><b>修改資料</b>： 若要修改資料庫的資料，使用的 SQL 指令是「UPDATE」，基本語法如下： </span></p>
      <table border="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="85%" id="AutoNumber4">
        <tr>
          <td width="100%">
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="letter-spacing: 1pt; vertical-align: baseline">UPDATE 
          資料表名稱 <br>
          SET 欄位名稱1=欄位1的資料，欄位名稱2=欄位2的資料，... WHERE 條件式 </span></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="letter-spacing: 1pt; vertical-align: baseline">SQL= 
          &quot;UPDATE&nbsp; MY_TABLE SET NAME='黃自強' WHERE PHONE='28975966' AND 
          BIRTH='640101' &quot;</span></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="vertical-align: baseline">sql = &quot;Update award_question 
          set grade=&quot; &amp; grade &amp; &quot;,question='&quot; &amp; quiz &amp; &quot;',correct='&quot; &amp; correct &amp; 
          &quot;',start_date='&quot;<br>
          sql = sql &amp; sdate &amp; &quot;',end_date='&quot; &amp; edate &amp; &quot;',post_date='&quot; &amp; pdate &amp; 
          &quot;' where id=&quot; &amp; id<br>
　</span></td>
        </tr>
      </table>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
　</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
    (四)、</span><span style="letter-spacing: 1pt; vertical-align: baseline"><b>刪除資料</b>： 
    若要刪除資料庫的資料，使用的 SQL 指令是「DELETE」，基本語法如下： </span></p>
      <table border="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="85%" id="AutoNumber5">
        <tr>
          <td width="100%">
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="letter-spacing: 1pt; vertical-align: baseline">DELETE 
          FROM 資料表名稱 WHERE 條件式 </span></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="vertical-align: baseline">sql = &quot;Delete from 
          award_question where id=&quot; &amp; id<br>
　</span></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <span style="vertical-align: baseline; letter-spacing: 1pt">sql = 
          &quot;Delete BITEM_SCORE Where SYEAR='&quot; &amp; stryear &amp; &quot;' and SEME='&quot; &amp; 
          strseme &amp; &quot;' and STDNO='&quot; &amp; X &amp; &quot;' and SUBJNO='&quot; &amp; strcur &amp; &quot;' and 
          EMPNO='&quot; &amp; strempno &amp; &quot;' and ITEM='&quot; &amp; stritem &amp; &quot;'&quot;<br>
　</span></td>
        </tr>
      </table>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline"><br>
    </span>
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
    (五)、注意事項：</span><span style="letter-spacing: 1pt; vertical-align: baseline">ASP使用SQL語法存取資料庫時，請參考下列注意事項：</span></p>
    </blockquote>
<blockquote>
      <ul>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        資料庫內的資料表名稱最好要使用英文命名，且中間不可有空白字元。 </span></li>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        資料庫的欄位名稱要用英文命名，且中間不可留白。 </span></li>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">
        欄位名稱最好使用意義完整的名稱，且避免和資料庫的<b>內建關鍵字</b>相衝。（例如 index 
        就不是一個適合的欄位名稱，因為是資料庫的內建關鍵字，在執行 SQL 指令會有錯誤產生。） </span></li>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">&nbsp;在 SQL 
        Server 內執行 SQL 指令時，萬用字元定義如下： 「_」：代表一個任意字元 「%」：代表任意多個任意個字元</span></li>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">在 Access 內執行 
        SQL 指令時，有兩個最重要的萬用字元： 「?」：比對一個字元 「*」：比對多個字元，但若要在 ASP 的程式碼內使用 SQL 
        的萬用字元，必須將「?」改為「_」，「*」改為「%」。</span></li>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt; vertical-align: baseline">MS Access 
        並不是大型企業用的後端資料庫，因為效率並不是很好，但是對於小型的網路應用而言，Access 已經夠用了。MS SQL2000 Server 
        是微軟推出的資料庫引擎，專門對付大型的網路應用，台北市每所國中小在校務行政標案中都有購買。</span><font color="#808080"><span style="letter-spacing: 1pt; vertical-align: baseline"><br>
　</span></font></li>
      </ul>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  (六)、</span><b>關於SQL隱碼攻擊</b></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline">
      　　前一陣子很紅的SQL隱碼攻擊事件，曾經讓無數的程式設計師和網管人員晚上睡不著覺，徹夜修改程式碼。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline">　　這個讓全世界緊張的事件，其實不能算是ASP程式的 
      bug，而應該說是〝刻意辜負人家的善意〞。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline">
      　　程式設計師撰寫網頁應用程式時，假定所有的使用者，都是善意的，正常人在表單填入的文字，並不會用<span lang="en-us"> </span>SQL<span lang="en-us">
      </span>語法或控制字元，於是並不會多做檢查。駭客就利用
      這個善念漏出來的漏洞入侵。入侵者利用這個漏洞，可以很容易的透過網頁，取得資料庫中的信用卡號等敏感資料，也能取得資料庫管理權限，甚至下載資料後，刪除、破壞資料庫，再對受害者加以勒索。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">詳細資料請參考：<a href="http://www.spps.tp.edu.tw/documents/memo/SQL_EP_attack.htm">SQL資料隱碼攻擊與防堵方法</a></span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="vertical-align: baseline">　　更慘的是如果系統管理員一直沒有把 IIS 
      的漏洞修補、更新好，留下一堆漏洞，駭客就還可以再遠端上傳木馬程式，並且透過網址列執行木馬程式，或是在您的主機上建管理員帳號、改權限，更狠的會刪除整個硬碟....等。而在自由、民主、開放的國家，這些簡易入侵的方法，何ｘ仁書店就買的到。</span></p>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      　　我們要避免這類型的駭客手法，可以從幾方面著手：</p>
      <ul>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        經常修補 IIS 和 Windows Server、SQL Server。</li>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        使用Windows Update 的半自動更新(全自動更新有風險)。</li>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        撰寫ASP程式時要在取得 Form 表單傳的值後，馬上做過濾的動作。例如：</p>
        <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:653; height:364">
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          '表單傳來的使用者名稱過濾和輸入長度限制</p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          usrid=replace(usrid,&quot;'&quot;,&quot;‘&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <br>
          usrid=replace(usrid,&quot;*&quot;,&quot;＊&quot;)<br>
          usrid=replace(usrid,&quot;%&quot;,&quot;％&quot;)<br>
          usrid=replace(usrid,&quot;/&quot;,&quot;／&quot;)<br>
          usrid=replace(usrid,&quot;=&quot;,&quot;＝&quot;)<br>
          usrid=left(usrid,8)</p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <br>
          '表單傳來的密碼過濾和輸入長度限制<br>
          inputpass=replace(inputpass,&quot;'&quot;,&quot;‘&quot;)<br>
          inputpass=replace(inputpass,&quot;*&quot;,&quot;＊&quot;)<br>
          inputpass=replace(inputpass,&quot;%&quot;,&quot;％&quot;)<br>
          inputpass=replace(inputpass,&quot;/&quot;,&quot;／&quot;)<br>
          inputpass=replace(inputpass,&quot;=&quot;,&quot;＝&quot;)<br>
          inputpass=left(inputpass,12)</div>
        </li>
      </ul>
      <ul>
        <li>
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        我們也可以寫一行程式碼來取出使用者輸入的字串中是否有敏感字元，藉以判斷使用者是否有入侵意圖，同時將有入侵動作的使用者IP取回，加上時間，寫入資料庫或郵寄給系統管理員。更安全的話可以統計入侵企圖的次數，當同一個 
        ip 入侵事件累積到5次以上時，就不算是使用者誤打，我們可以將入侵資訊傳值給送到網路１１０警察局該站台<a href="http://www.net110.gov.tw/">刑事局線上檢舉信箱</a>的檢舉專用程式來報案。如：</li>
      </ul>
        <blockquote>
      <div style="width: 656; height: 515; border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <font color="#008000">' ------自動寄發email-----<br>
          if hackip_count&gt;5 and instr(id,&quot;'&quot;)&nbsp; then <br>
&nbsp;&nbsp;&nbsp; hackip = </font>Request.Servervariables(&quot;Remote_Addr&quot;)<font color="#008000"><br>
&nbsp;&nbsp;&nbsp; Set Mail=Server.CreateObject(&quot;CDONTS.NewMail&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail.MailFormat=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail.BodyFormat=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.From = &quot;xxps@xxps.tp.edu.tw&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.to = 
          &quot;net110@net110.gov.tw;admin@mail.xxps.tp.edu.tw&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.Subject = &quot;檢舉駭客入侵&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.Body = &quot;入侵時間&quot; &amp; now() &amp; &quot;入侵者ip:&quot; 
          &amp; hackip &amp; &quot;事項:...檢舉人:....XX國小網路中&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.Send<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set Mail=Nothing</font></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <font color="#008000">&nbsp;&nbsp;&nbsp; ' ------自動寄發email結束-----</font></p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <font color="#008000">response.write &quot;您的入侵行為和紀錄，依法已經送交網路警察局處理，請好自為之。&quot;<br>
          end if<br>
          </font>或是直接傳值給台北市警察局網站<a href="http://safety.taipei-elife.net/postcase.asp">網路報案</a>用的表單：</p>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          <font color="#3776BB">response.redirect &quot; 
          http://safety.taipei-elife.net/postcase.asp?title=檢舉入侵&amp;body=......略.....&quot;<br>
          </font>(以上的舉例欄位，都不是真的，請勿套用)</p>
      </div>
        </blockquote>
    </blockquote>
  <blockquote>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  (七)、</span><b>以MS-SQL Server 作為後端資料庫實做</b></p>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  　　在熟練使用<span lang="en-us"> ACCESS </span>資料庫後，進階的練習就是以 MS-SQL 
  2000 Server 作為後端資料庫。網路抓來的ASP程式，多半是使用Access 97~2000的 
  MDB檔案作為後端資料庫，好處是遷移性強，檔案下載回去，換個主機拷貝進去，如果資料夾名稱沒便，只要把檔案權限設定一下，馬上就可以上線工作。但是相對也有缺點。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  　　缺點是同時上線存取資料庫的連線數量不能太多，否則會發生資料庫開啟失敗的情況，也就是說以MDB作為資料庫適合一般流量不大的網站，像班級網站。需應付大量（約１００人）使用者同時瞬間上線，像是每天有數千人參觀的熱門網站，就比較不適合。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  　　依經驗推估每天網站訪客人數超過1000人的網站，或是網頁設計上有應用程式的功能是經常要更新(網頁經常需要自動 Reload的網頁)，就建議您使用MS-SQL 
  Server。或者安裝免費的 Apache For Win32 + 
  MySQL + PHP 等軟體來開發互動網頁，也是不錯的選擇。新版的BigApache套件也同時支援ASP。</span></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font color="#808080">BigApache (for Win32)提供包括 Html / PHP / Pearl / ASP / 
    JSP / Java / MySQL 的Web 伺服站所有相關程式及設定。</font></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">　　透過網路上任意一台WEB 
  SERVER 存取 SQL Server上的資料庫的反應的速度和效能，都比存取MDB資料庫高太多了。尤其在複雜的多資料表結合查詢，更顯出SQL的威力。使用MS-SQL 2000 
  Server還有一個好處，就是不必擔心資料庫會被使用者刻意下載回去，造成網站安全漏洞。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  　　使用缺點就是MS-SQL Server 2000 實在是太貴了，網路使用還要購買足夠的網路使用者使用權才行
  ，還好台北市各校在校務行政的標案中，有MS-SQL 6/7/2000 Server的授權，不必再多花錢另外購買，而且只Web Server 
  上的程式存取，只算一人份的使用者授權。</span></p>
</blockquote>
</blockquote>
  </blockquote>
<hr>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　　下面的內容以實做方式介紹怎樣使用SQL Server來建立和使用資料庫。</p>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#808080">作業：寫一套〔網站有獎徵答〕的程式，提供校內老師都可以出題，所有學生可挑選適合的問題來回答。</font></p>
  </blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　　題目是以學校推動的宣導事項、圖書館利用教學、網路查資料等主題為主。以這個有獎徵答的程式寫作計劃來看，我們開發這一套程式的〝手順〞可以安排成：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <font color="#3776BB"><b>繪出程式運作流程 → 設計資料庫 → 設計網頁介面 → 填入ASP 程式碼 → 實際測試程式</b></font></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
  <span style="vertical-align: baseline">寫作ASP程式的步驟建議如下：</span></p>
  <ol>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">繪製程式運作流程圖，即使隨手只能取到餐巾紙。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">根據程式需求，設計資料庫的table 
    名稱、欄位名稱、各欄位的資料型態、索引鍵值...等相關設定。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">先用FrontPage等WYSWYG網頁編輯軟體把會用到的網頁純 html 
    使用者介面線設計好，例如：清單、新增、刪除、修改等網頁。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">開始撰寫（填入）ASP程式碼。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">測試程式。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">美工配色等美化工程(通常交給美工管理人員)。</span></li>
  </ol>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>&nbsp;&nbsp;1.繪製流程圖:</b></p>
</blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <img border="0" src="images/chart.gif" width="761" height="547"></p>
  <blockquote>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
</blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>2.設計有獎徵答的資料庫</b></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    程式架構好了以後要做的就是把需要用的資料表設計完成。要直接用SQL Server 開發資料庫程式的話，我們需要到 SQL Server 
    主機上開資料庫和設計資料表，或使用遠端遙控軟體來開設資料庫。</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    請到有安裝 SQL Server 的機器上，從開始功能表開啟 SQL Enterprise Manager 
    (企業管理員)，並按滑鼠右鍵，新增一個資料庫，例如：spps(spps是石牌國小的縮寫，資料庫名稱設為石牌國小的好處是：以後去石牌國小抓回來的ASP套件，不用改什麼程式碼，就可以直接套用，當然您想改換名稱也是可以的)。</p>
  </blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as1.jpg" width="286" height="338"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as4.gif" width="501" height="466"></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    我們可以看到資料庫產生完成的畫面：</p>
  </blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as5.gif" width="669" height="435"></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    接下來手動建立程式需要的兩個新資料表：</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as11.jpg" width="318" height="430"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    根據程式提供的功能所需，設計各個資料的欄位屬性.例如：</p>
    <blockquote>
      <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
        <ul>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          ID－每個題目有一個ID，它也同時是鍵值。而且是唯一的、不能修改的。資料型別為整數(int)，長度為4，不允許空值(null)。這裡的ID代表學生選答的題目編號。</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          stuno－nvarcher /12 / not null /學生學號</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          classno－char / 5 / not null / 學生班級</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          student－nvarchar / 12 / not null /學生姓名</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          answer－nvarchar / 100 /學生填的答案</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          correct－bit / 1 / not null /是否正確</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          ans_date－datetime / 8 / not null /學生填答的日期</li>
        </ul>
      </div>
    </blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as6.gif" width="610" height="366"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    關閉時會問：</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as7.gif" width="283" height="113"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    請將這個資料表命名為award_answer</p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as8.gif" width="335" height="116"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    另外再依照以下範例，設計另一個老師出題用的資料表：</p>
    <blockquote>
      <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
        <ul>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          id / 題號</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          grade / 題目給低中高年級哪個年級答? 全校：0、 低年級：1、中年級：2、高年級：3</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          question / 老師出的題目內容</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          correct / 正確答案</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          start_date / 開始日期</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          end_date / 結束日期</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          post_date / 張貼日期</li>
          <li>
          <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
          mum / 本題填答的學生數量</li>
        </ul>
      </div>
    </blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="center">
    <img border="0" src="images/ASP.as9.gif" width="610" height="366"></p>
  </blockquote>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>3.有獎徵答網頁介面設計</b></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
  我們需根據程式運作流程圖，來設計製作各個頁面：</p>
  <table border="1" cellpadding="3" style="border-collapse: collapse" bordercolor="#111111" width="85%" id="AutoNumber30" height="282">
    <tr>
      <td width="22%" align="left" height="27" bgcolor="#ECECFF"><b>ASP檔名</b></td>
      <td width="78%" align="center" height="27" bgcolor="#ECECFF"><b>功能</b></td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/default.asp</b></td>
      <td width="78%" height="16">主網頁：秀出目前的題目／登入按鈕／管理員可新增題目。學生可登入／選答／看排行榜連結</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/sort.asp</b></td>
      <td width="78%" height="16">目前已經結束徵答的答對的學生他們的答對次數排行榜</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/list.asp</b></td>
      <td width="78%" height="16">列出某一題目答對的學生他們的答對次數排行榜</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/manager.asp</b></td>
      <td width="78%" height="16">列出老師能新增、刪除、和修改問題的表單，點題目的話可以審核學生的答案是否正確</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/addnew.asp</b></td>
      <td width="78%" height="16">新增有獎徵答的問題用的表單，需有題目、答案、張貼日、開始日期、結束日期等資訊</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/delete.asp</b></td>
      <td width="78%" height="16">刪除一題</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/edit.asp</b></td>
      <td width="78%" height="16">編輯已經出過的題目、答案和日期</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/check.asp</b></td>
      <td width="78%" height="16">列出學生回答的答案，來讓老師查核學生答案的程式</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/answer.asp</b></td>
      <td width="78%" height="16">學生填寫答案的表單頁面</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/thankx.asp</b></td>
      <td width="78%" height="16">感謝語，寫入學生回答的答案、自動寄發電子郵件給管理老師的程式</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/award/save.asp</b></td>
      <td width="78%" height="16">新增和修改資料後存入資料庫的程式</td>
    </tr>
    <tr>
      <td width="22%" height="15" align="left"><b>/check.asp</b></td>
      <td width="78%" height="15">檢查使用者id和password的表單</td>
    </tr>
    <tr>
      <td width="22%" height="16" align="left"><b>/check2.asp</b></td>
      <td width="78%" height="16">利用校務行政資料庫來比對老師、學生的帳號密碼，和認證的Session處理</td>
    </tr>
  </table>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>請先把下面幾個ASP網頁介面製作完成:</b></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial"><b><font size="5">default.asp&nbsp; 有獎徵答首頁<br>
  </font></b></font><font size="2"><br>
  <img border="0" src="images/ASP.41.gif" width="453" height="375"><br>
&nbsp;(介面的html檔)</p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;html&gt;&lt;head&gt;&lt;title&gt;有獎徵答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;table id=&quot;AutoNumber1&quot;&gt;<br>
  &lt;tr&gt;<br>
  &lt;td&gt;&lt;h1&gt;《網路有獎徵答》&lt;/h1&gt;&lt;/td&gt;<br>
  &lt;a href=&quot;manager.asp&quot;&gt;&lt;/a&gt;&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
  &lt;td&gt;&lt;font size=&quot;3&quot; color=&quot;#385B96&quot;&gt;§ &lt;a href=&quot;sort.asp&quot;&gt;得獎排行榜&lt;/a&gt;&lt;/td&gt;<br>
  &lt;td&gt;&lt;a href=&quot;manager.asp&quot;&gt;管理&lt;/a&gt;<br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;&lt;center&gt;<br>
  &lt;table border=&quot;1&quot;&gt;<br>
  &lt;tr&gt;&lt;td&gt;期別&lt;/td&gt;&lt;td&gt;對象&lt;/td&gt;&lt;td&gt;題目&lt;/td&gt;&lt;td&gt;活動期限&lt;/td&gt;&lt;td&gt;活動&lt;/td&gt;&lt;/tr&gt;<br>
  &lt;tr&gt;<br>
  &lt;td&gt;　&lt;/td&gt;<br>
  &lt;td&gt;　&lt;/td&gt;<br>
  &lt;td&gt;　&lt;/td&gt;<br>
  &lt;td&gt;　&lt;/td&gt;<br>
  &lt;td&gt;<br>
  &lt;a href=&quot;answer.asp?id=1&quot;&gt;我要答&lt;/a&gt;&lt;br&gt;<br>
  &lt;a href=&quot;list.asp?id=1&quot;&gt;得獎名單&lt;/a&gt;<br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;&lt;/center&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  </font><font size="5">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  </font>
  <font color="#0000FF" face="Arial"><b><font size="5">manager.asp：老師的管理頁面<br>
  </font><font size="2"><img border="0" src="images/ASP.42.gif" width="480" height="417"><br>
  </font></b></font><font size="2">(html檔)</p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;html&gt;&lt;head&gt;&lt;title&gt;有獎徵答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;管理選項&lt;/h1&gt;<br>
  &lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;table border=&quot;1&quot;&gt;<br>
  &lt;tr&gt;&lt;td&gt;期別&lt;/td&gt;&lt;td&gt;對象&lt;/td&gt;&lt;td&gt;題目（點題目審閱）&lt;/td&gt;&lt;td&gt;作答人數&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;addnew.asp&quot;&gt;新增題目&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;td&gt;　&lt;/td&gt;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;a href=checkit.asp?id=1&gt;<font color="#800000">這裡是題目</font>&lt;/a&gt;　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;td&gt;　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;<br>
  &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href=edit.asp?id=<font color="#800000">1</font>&gt;修改&lt;/a&gt;　<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;a href=delete.asp?id=<font color="#800000">1</font>&gt;刪除&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href=list.asp?id=<font color="#800000">1</font>&gt;得獎名單&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/tr&gt;<br>
  &lt;/table&gt;<br>
  &lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;<br>
  &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
</table>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  </font><font size="5">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  </font>
  <font color="#0000FF" face="Arial"><b><font size="5">addnew.asp ：新增題目<br>
  </font><font size="2"><img border="0" src="images/ASP.43.gif" width="596" height="596"></font></b></font><font size="2"></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;html&gt;&lt;head&gt;&lt;title&gt;新增題目&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;&lt;h1 align=&quot;center&quot;&gt;&lt;font face=&quot;標楷體&quot;&gt;新增題目&lt;/h1&gt;<br>
  &lt;hr&gt;<br>
  第<font color="#FF0000">一</font>期有獎徵答<br>
  &lt;form method=&quot;POST&quot; <font color="#800000">action=&quot;save.asp&quot;</font>&gt;<br>
  &lt;input type=<font color="#800000">hidden</font> <font color="#800000">name=id</font> 
  value=&quot;&lt;% =id %&gt;&quot;&gt;<br>
  &lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;&lt;td &gt;適用階段&lt;/td&gt;<br>
  &lt;td &gt;<br>
&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;grade&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;0&quot;&gt;低年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;1&quot;&gt;中年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;2&quot;&gt;高年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;3&quot;&gt;全校&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/select&gt; <br>
  &lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt;<br>
  &lt;td &gt;題目是&lt;/td&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;textarea rows=&quot;5&quot; name=&quot;quiz&quot; 
  cols=&quot;33&quot;&gt;&lt;/textarea&gt; &lt;/td&gt; <br>
  &lt;/tr&gt; <br>
  &lt;tr&gt;&lt;td&gt;正確答案&lt;/td&gt;&lt;td &gt;&lt;input type=&quot;text&quot; name=&quot;correct&quot; size=&quot;35&quot;&gt;&lt;/td&gt;&lt;/tr&gt;
  <br>
  &lt;tr&gt;&lt;td &gt;開始日期&lt;/td&gt;&lt;td &gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;smonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option selected&nbsp; value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;sday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option selected value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 <br>
  &lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt;&lt;td &gt;結束日期&lt;/td&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;td &gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;smonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option selected&nbsp; value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;sday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option selected value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 </font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt; <br>
  &lt;td &gt;公告日期&lt;/td&gt; <br>
  &lt;td &gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;smonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option selected&nbsp; value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;sday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option selected value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 </font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/center&gt; </font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;p align=&quot;center&quot;&gt; <br>
  &lt;input type=&quot;submit&quot; value=&quot;存檔&quot; name=&quot;B1&quot;&gt;　&lt;input type=&quot;reset&quot; value=&quot;重寫&quot; 
  name=&quot;B2&quot;&gt;&lt;/p&gt; <br>
  &lt;/form&gt; <br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;&lt;/body&gt; &lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="5"><b>save.asp ： 各種動作的存檔程式</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#800000" face="Arial">&lt;%　</font><font face="Arial"><font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 權限判斷</font></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 去除使用者輸入的表單傳來的資料中，潛藏有<span lang="en-us"> </span>SQL<span lang="en-us">
  </span>隱碼攻擊可能的單引號字串</font></font><font color="#800000" face="Arial"><br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 因為表單上使用國曆年給管理人員點選，寫入資料庫時，必須改為西元，因此要經過轉換、再把年月日連接起來，交給變數</font></font><font color="#800000" face="Arial"><br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 根據表單傳來的資料，組合<span lang="en-us"> </span>SQL<span lang="en-us">
  </span>語法</font></font><font color="#800000" face="Arial"><br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 如果資料記錄是空的(沒有這個id,表示資料庫中沒有這個題目,動作一定是新增)</font></font><font color="#800000" face="Arial"><br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 
  就把後面要執行的sql字串變數,寫成插入新的id、年級、題目、答案、日期等資料到資料表award_question中</font></font><font color="#800000" face="Arial"><br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 否則就寫成更新資料到資料表award_question中</font></font><font color="#800000" face="Arial"><br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' </font></font><font face="Arial" color="#FF0000">
  執行sql命令</font><font color="#800000" face="Arial"><br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' </font></font><font face="Arial" color="#FF0000">
  把網頁轉到〝管理頁面〞</font><font color="#800000" face="Arial"><br>
  %&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  </font>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial"><b><font size="5">answer.asp 學生填答的表單</font></b></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <img border="0" src="images/ASP.44.gif" width="633" height="611"></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;html&gt;&lt;head&gt;&lt;title&gt;我要回答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1&gt;我會回答問題&lt;/h1&gt;<br>
  &lt;hr&gt;<br>
  &lt;p&gt;&lt;font color=&quot;blue&quot;&gt;xx小朋友請注意以下規則：&lt;/p&gt;<font color="#FF0000">
  <br>
  </font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.每人只能回答一次，無法反悔改答案&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.請多利用圖書館或網路尋找答案&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.請不要替他人作答或洩漏答案，影響比賽的公平性&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4.所有的成績會在期末統計,並頒發獎品給答對最多題目的同學&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5.現有獎品:李忠憲老師提供 PS2 五台 , XBOX 三台 &lt;br&gt;<br>
  如果已經回答<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;marquee 
  behavior=&quot;alternate&quot;&gt;你已經答過這題了，不可以修改或再次作答！&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/marquee&gt;&lt;a 
  href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 本期題目：&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 我的答案是：<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;form 
  method=&quot;POST&quot; action=&quot;thanx.asp&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input 
  type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;&lt;% =id %&gt;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;textarea 
  rows=&quot;5&quot; name=&quot;answer&quot; cols=&quot;45&quot; &gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  我是<font color="#800000">xxxx</font>,我的答案是:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/textarea&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;input type=&quot;submit&quot; value=&quot;寫好了，幫我儲存&quot; name=&quot;B1&quot;&gt;　&lt;input 
  type=&quot;reset&quot; value=&quot;重寫&quot; name=&quot;B2&quot;&gt;&lt;/form&gt;<br>
  <br>
  &lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="5"><b>thankx.asp：寫入資料庫並寄發eamil 通知管理老師</b></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <img border="0" src="images/ASP.45.gif" width="653" height="563"></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  ---------寄發email部分</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;html&gt;&lt;head&gt;&lt;meta http-equiv='Content-Type' 
  content='text/html; charset=big5'&gt;&lt;/head&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;body&gt;&lt;table border=0&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;tr&gt;&lt;td&gt; ■答題學生姓名：&lt;/td&gt;&lt;/tr&gt;<br>
  &lt;tr&gt;&lt;td&gt;有獎徵答學生填答通知&lt;/td&gt;&lt;/tr&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;tr&gt;&lt;td&gt;■學生email：&lt;/td&gt;&lt;/tr&gt;<br>
  &lt;tr&gt;&lt;td&gt;【題目=xxxxx】學生的答案：&lt;/td&gt;&lt;/tr&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;tr&gt;&lt;td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;a href = 
  'http://www.xxps.tp.edu.tw/checkt.asp?topage=/award/manager.asp'&gt;○請出題老師在活動截止前點這裡前往審核○&lt;/a&gt;<br>
  &lt;/td&gt;&lt;/tr&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;tr&gt;&lt;td align=right&gt;&lt;font color= red &gt;寄發時間：&lt;/tr&gt;&lt;/table&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  ---------寄發email部分</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  ---------網頁部分<font size="2" face="Arial"><font color="#FF0000"><br>
  </font>&lt;html&gt;&lt;head&gt;&lt;title&gt;謝謝您的作答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;謝謝您參加xx國小有獎徵答作答&lt;/h1&gt;<br>
  &lt;hr&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;b&gt;&lt;font color=&quot;#385B96&quot;&gt;您的答案已經存入資料庫，請等待截止日期老師審查
  ，於<font color="#800000">[結束日期]</font>後才會公佈正確答案及得獎名單！並於期末頒獎&lt;/b&gt;&lt;/p&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/body&gt;&lt;/html&gt;<br>
  </font>---------網頁部分</p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>
  <font color="#0000FF" face="Arial" size="5">edit.asp : 出題老師編修題目用 </font></b>
  <font face="Arial" size="5">(</font><font face="Arial">和addnew.asp很像，可以複製addnew.asp來修改)</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <img border="0" src="images/ASP.46.gif" width="592" height="603"></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;html&gt;&lt;head&gt;&lt;title&gt;編修題目&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;&lt;font face=&quot;標楷體&quot;&gt;新增題目&lt;/font&gt;&lt;/h1&gt;&lt;hr&gt;<br>
  第<font color="#800000">一</font>期有獎徵答</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;form method=&quot;POST&quot; action=&quot;save.asp&quot;&gt;<br>
  &lt;input type=hidden name=id value=&quot;<font color="#800000">1</font>&quot;&gt;<br>
  &lt;div align=&quot;center&quot;&gt;&lt;center&gt;<br>
  &lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
  &lt;td&gt;適用年段&lt;/td&gt;<br>
  &lt;td&gt;<br>
  &lt;select size=&quot;1&quot; name=&quot;grade&quot;&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;0&quot; selected&gt;低年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;1&quot; &gt;中年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;2&quot; &gt;高年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;3&quot;<font color="#800000"> </font>&gt;全校&lt;/option&gt;<br>
  &lt;/select&gt; <br>
  &lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt;<br>
  &lt;td&gt;題目是&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;textarea rows=&quot;5&quot; name=&quot;quiz&quot; cols=&quot;33&quot;&gt;<font color="#990000">資料庫裡的題目</font>&lt;/textarea&gt;<br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;正確答案&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<br>
&nbsp;&nbsp;&nbsp; &lt;input type=&quot;text&quot; name=&quot;correct&quot; size=&quot;35&quot; value=&quot;<font color="#990000">正確的答案</font>&quot;&gt;<br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#33CCFF&quot;&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;開始日期&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#CCFFFF&quot;&gt;<br>
&nbsp;</font><font size="2"><font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;smonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option selected&nbsp; value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;sday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option selected value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 </font></p>
  </font>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;/td&gt;&lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#33CCFF&quot;&gt;&lt;font 
  color=&quot;#FFFFFF&quot;&gt;結束日期&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#CCFFFF&quot;&gt;<br>
  </font><font size="2">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;smonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option selected&nbsp; value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;sday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option selected value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 </font></p>
  </font>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;/td&gt;&lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#33CCFF&quot;&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;公告日期&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#CCFFFF&quot;&gt;<br>
  </font><font size="2">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;smonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option selected&nbsp; value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;sday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option selected value=&quot;<font color="#800000">1</font>&quot;&gt;<font color="#800000">1</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 </font></p>
  </font>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;/td&gt;&lt;/tr&gt;<br>
  &lt;/table&gt;&lt;/center&gt;&lt;/div&gt;<br>
  &lt;p align=&quot;center&quot;&gt;<br>
  &lt;input type=&quot;submit&quot; value=&quot;存檔&quot; name=&quot;B1&quot;&gt;　&lt;input type=&quot;reset&quot; value=&quot;重寫&quot; 
  name=&quot;B2&quot;&gt;&lt;/p&gt;<br>
  &lt;/p&gt;&lt;/form&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="5"><b>checkit.asp：老師審查答案用</b></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <img border="0" src="images/ASP.47.gif" width="605" height="442"></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;html&gt;&lt;head&gt;&lt;title&gt;審閱答案&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;&lt;font face=&quot;標楷體&quot;&gt;審閱答案&lt;/h1&gt;&lt;hr&gt;<br>
  <font color="#800000"><br>
  </font>&lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;對　　象：&lt;/td&gt;&lt;td&gt;<font color="#990000">資料庫裡的</font>哪個年級　&lt;/td&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;題　　目：&lt;/td&gt;&lt;td&gt;<font color="#990000">資料庫裡的題目</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;正確答案：&lt;/td&gt;&lt;td&gt;<font color="#990000">資料庫裡的</font><font color="#800000">正確的答案</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;<br>
  &lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;學號&lt;/td&gt;&lt;td &gt;班級&lt;/td&gt;&lt;td &gt;姓名&lt;/td&gt;&lt;td &gt;答案&lt;/td&gt;&lt;td &gt;答對&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;form method=&quot;POST&quot; action=&quot;update.asp&quot;&gt;<br>
  &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;<font color="#800000">1</font>&quot;&gt;<br>
  &lt;tr&gt;<br>
  &lt;td&gt;<font color="#800000">帶出資料庫裡的學號　</font>&lt;/td&gt;<br>
  &lt;td&gt;<font color="#800000">帶出資料庫裡的班級</font>　&lt;/td&gt;<br>
  &lt;td&gt;<font color="#800000">帶出資料庫裡的姓名</font>　&lt;/td&gt;<br>
  &lt;td&gt;<font color="#800000">帶出資料庫裡的</font>答案　&lt;/td&gt;<br>
  &lt;td&gt;是否答對&nbsp;&nbsp;&nbsp;
  &lt;input type=&quot;checkbox&quot; name=&quot;<font color="#800000">a</font>&quot; 
  value=&quot;ON&quot; checked&gt;<br>
  &lt;/td&gt;&lt;/tr&gt;<br>
  &lt;/table&gt;&lt;/center&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;審核完畢，請幫我儲存&quot; name=&quot;B1&quot;&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;input type=&quot;reset&quot; value=&quot;重新審核&quot; 
  name=&quot;B2&quot;&gt;&lt;/p&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="5"><b>update.asp : 更新出題老師審核表單傳來的資料</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#990000" size="2" face="Arial">&lt;% ' 權限認證<br>
  </font>
  <font color="#FF0000" size="2" face="Arial">' 先把答案都設為答錯</font><font color="#990000" size="2" face="Arial"><br>
  </font>
  <font color="#FF0000" size="2" face="Arial">' 再把表單傳來的資料筆數數量，作為迴圈的圈數，逐筆取出</font><font color="#990000" size="2" face="Arial"><br>
  ' 更新資料庫<br>
  ' 轉向網頁到主網頁<br>
  %&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>delete.assp : 刪除題目</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial" color="#990000">&lt;%'權限認證<br>
  ' 選出題號<br>
  ' 執行sql<br>
  ' 轉向網頁到主網頁<br>
  %&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="5"><b>list.ap : 列出某一題答對的學生清單</b></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <img border="0" src="images/ASP.48.gif" width="574" height="418"></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;html&gt;&lt;head&gt;&lt;title&gt;排行榜&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  第<font color="#990000">1</font>期&lt;/b&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;對　　象：&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">年級　</font>&lt;/td&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;題　　目：&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">老師出的題目</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;正確答案：&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">正確的答案　</font>&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;<br>
  &lt;table border=&quot;1&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;學號&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;班級&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;姓名&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;答案&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#990000">&lt;%<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">’ 選出題目資料表中，這題答對的同學，照年班級排序</font><font color="#990000"><br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">’ 如果資料錄不是空的,取出資料錄的資料</font><font color="#990000"><br>
  %&gt;</font><br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">印出學生學號</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">印出</font>班級　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">印出姓名</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">印出答案</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/center&gt;&lt;/div&gt;<br>
  &lt;center&gt;&lt;font size=&quot;5&quot; color=&quot;#FF0000&quot;&gt;得獎名單正在審核中，目前還無法公佈！&lt;/font&gt;&lt;/center&gt; <br>
  &lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="5"><b>sort.asp : 列出所有答對的學生的總排行榜</b></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <img border="0" src="images/ASP.49.gif" width="558" height="351"></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:619; height:444">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;html&gt;&lt;head&gt;&lt;title&gt;排行榜&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;table border=&quot;1&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;學號&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;班級&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;姓名&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;答對次數&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#990000"><br>
  </font>&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">資料庫裡的學號　</font>&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">資料庫裡的班級　</font>&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">資料庫裡的姓名</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">資料庫裡的答對次數</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/center&gt;&lt;/body&gt; &lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>4.所謂〝權限認證〞</b></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  除了主網頁和排行榜外，都要在程式中放入權限認證。以免玩家級的使用者在瀏覽器的網址列直接輸入值帶入程式。以下是需要設計權限認證的幾個動作：</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:671; height:128">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">&nbsp;&nbsp;&nbsp; 
  只有學生權限才能回答問題。<br>
&nbsp;&nbsp;&nbsp; 只有管理老師可以新增、編修和刪除題目。<br>
&nbsp;&nbsp;&nbsp; 只有管理老師能審核答案。<br>
&nbsp;&nbsp;&nbsp; 只有管理老師能執行存檔。<br>
&nbsp;&nbsp;&nbsp; 只有透過表單傳來的值才寫入資料庫&nbsp;&nbsp;&nbsp; </p>
  </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  我們可以在主程式建構完成後，再加入認證功能。</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  &nbsp;&nbsp;&nbsp; 另外還要再撰寫程式時注意，所有從表單傳來的值，程式收到後都要過濾傳入值，以避免有心人作ＳＱＬ資料隱碼攻擊。</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>5.權限認證部分</b></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  &nbsp;&nbsp;&nbsp;
  學生和老師登入的帳號密碼檢查表單，我們可以利用石牌國小李忠憲老師提供的程式，作為現成的校務行政帳號做認證機制。下載<a href="http://www.spps.tp.edu.tw/resource/asp/李忠憲老師私房程式/校務行政系統2.2jsmis.zip"><img src="images/zip.gif" border="0" width="40" height="40">校務行政系統2.2jsmis.zip</a>　725K[2003/4/11]下載完畢後解開，依照說明拷貝到 
  <a href="file:///x:/inetpub/wwwroot">x:\inetpub\wwwroot</a> 中。並依照以下步驟修改：</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  1.global.asa 內容請先修改好:</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:665; height:246">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <font face="Arial">
    <span style="vertical-align: baseline"><font size="2">&lt;SCRIPT LANGUAGE=VBScript 
    RUNAT=Server&gt;</font></span></font><font size="2"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    </font><font face="Arial">
    <span style="vertical-align: baseline"><font size="2">Sub Application_OnStart<br>
    </font><font size="2" color="#3776BB">&nbsp; </font>
    <font color="#FF0000" size="2">&nbsp; '以下此行設定資料庫來源 請改為正確路徑</font><font size="2"><br>
    Application(&quot;ysps1&quot;) = &quot;Driver={SQL 
    Server};Server=ysps1;database=JSDB;uid=xxxxx;pwd=xxxxxx&quot;<br>
    Application(&quot;spps&quot;) = &quot;Driver={SQL 
    Server};Server=ysps1;database=spps;uid=xxxxx;pwd=xxxxxx&quot;<br>
    Application(&quot;board&quot;) = &quot;Driver=driver={Microsoft Access Driver 
    (*.mdb)};dbq=d:\inetpub\wwwroot\board\board.mdb;PWD=xxxxxxxx&quot;&nbsp;<font color="#FF0000">&nbsp; 
    '站台上有mdb檔也可以放入Application 變數中</font><br>
    END SUB<br>
    &lt;/SCRIPT&gt;</font></span></font></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  2.不喜歡登入畫面的話也可以自己動手製作<span lang="en-us"> </span>check.asp 表單。</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:632; height:487">
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <img border="0" src="images/ASP.as10.gif" width="629" height="416"></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  check.asp程式碼說明</p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:651; height:557">
    <blockquote>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font face="Arial" size="2">
      <font color="#800000">&lt;%<br>
      if session(&quot;passed&quot;)=1 then<br>
&nbsp;&nbsp;&nbsp; session(&quot;topage&quot;)=request(&quot;topage&quot;)<br>
&nbsp;&nbsp;&nbsp; response.redirect session(&quot;topage&quot;)<br>
      else<br>
&nbsp;&nbsp;&nbsp; session(&quot;topage&quot;)=request(&quot;topage&quot;)<br>
      %&gt;<br>
      </font>&lt;html&gt;&lt;head&gt;&lt;title&gt;登入&lt;/title&gt;&lt;/head&gt;<br>
      &lt;body&gt;<br>
      &lt;form name=&quot;idpass&quot; method=&quot;POST&quot; action=&quot;/check2.asp&quot;&gt;<br>
      &lt;input type=&quot;hidden&quot; name=&quot;topage&quot; value=&quot;<b><font color="#008000">&lt;%=session(&quot;topage&quot;)%&gt;</font></b>&quot;&gt;<br>
      &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value&gt;<br>
      &lt;div align=&quot;center&quot;&gt;<br>
      &lt;center&gt;<br>
      &lt;table&gt;<br>
      &lt;tr&gt;&lt;td width=&quot;600&quot;&gt;<br>
      &lt;table cellspacing=&quot;0&quot; cellpadding=&quot;2&quot; width=&quot;423&quot; border=&quot;0&quot; 
      style=&quot;border-collapse: collapse&quot; bordercolor=&quot;#111111&quot;&gt;<br>
      &lt;tr&gt;&lt;th align=&quot;right&quot; width=&quot;256&quot;&gt;帳號（或學生名牌號碼） &lt;/th&gt;<br>
      &lt;td width=&quot;160&quot;&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;&lt;b&gt;<br>
      &lt;input type=&quot;text&quot; name=&quot;<b><font color="#800000">usrid</font></b>&quot; 
      size=&quot;13&quot;&gt;&lt;/b&gt;&lt;b&gt; &lt;/b&gt;<br>
      &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;<br>
      &lt;th align=&quot;right&quot; width=&quot;256&quot;&gt;密碼（或學生身分證號） &lt;/th&gt;<br>
      &lt;td width=&quot;160&quot;&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;&lt;b&gt;<br>
      &lt;input type=&quot;password&quot; name=&quot;<b><font color="#800000">pass</font></b>&quot; 
      size=&quot;13&quot;&gt;&lt;/b&gt;&lt;b&gt;<br>
      &lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;<br>
      &lt;/div&gt;<br>
      &lt;p align=&quot;center&quot;&gt;【&lt;a 
      href=&quot;Javascript:checkempty(document.idpass)&quot;&gt;&lt;b&gt;登入主機&lt;/b&gt;&lt;/a&gt;&lt;b&gt;】&lt;/b&gt;　&lt;b&gt;【&lt;/b&gt;&lt;a 
      href=&quot;Javascript:document.idpass.reset()&quot;&gt;&lt;b&gt;清除重填&lt;/b&gt;&lt;/a&gt;&lt;b&gt;】&lt;/b&gt;&lt;/p&gt;<br>
      &lt;/form&gt;<br>
      &lt;/body&gt;&lt;/html&gt;<br>
      <font color="#008000">&lt;% end if %&gt;</font></font></p>
    </blockquote>
  </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>check2.asp的程式碼說明</b></p>
  <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1; width:650; height:1677">
    <blockquote>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <font size="2" color="#800000" face="Arial">&lt;!--#include file=&quot;jsmis/public.asp&quot;--&gt;<br>
      &lt;%<br>
      m_year=request(&quot;year&quot;)<br>
      m_month=request(&quot;month&quot;)<br>
      m_day=request(&quot;day&quot;)<br>
      m_class=request(&quot;class&quot;)<br>
      syear = year(now())-1911<br>
      smonth = month(now())<br>
      if smonth&gt;8 then<br>
&nbsp;&nbsp;&nbsp; seme = 1<br>
      elseif smonth &lt;2 then<br>
&nbsp;&nbsp;&nbsp; seme = 1<br>
&nbsp;&nbsp;&nbsp; syear = syear-1<br>
      else<br>
&nbsp;&nbsp;&nbsp; seme = 2<br>
&nbsp;&nbsp;&nbsp; syear = syear-1 <br>
      end if<br>
      <br>
      Set Conn1 = 
      Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
      conn1.open Application(&quot;spps1&quot;)<br>
      usrid=Ucase(request.form(&quot;usrid&quot;))<br>
      usrid=replace(usrid,&quot;'&quot;,&quot;&quot;)<br>
      usrid=replace(usrid,&quot;*&quot;,&quot;&quot;)<br>
      usrid=replace(usrid,&quot;%&quot;,&quot;&quot;)<br>
      usrid=replace(usrid,&quot;/&quot;,&quot;&quot;)<br>
      usrid=replace(usrid,&quot;=&quot;,&quot;&quot;)<br>
      usrid=left(usrid,5)<br>
      <br>
      inputpass=Ucase(request.form(&quot;pass&quot;))<br>
      inputpass=replace(inputpass,&quot;'&quot;,&quot;&quot;)<br>
      inputpass=replace(inputpass,&quot;*&quot;,&quot;&quot;)<br>
      inputpass=replace(inputpass,&quot;%&quot;,&quot;&quot;)<br>
      inputpass=replace(inputpass,&quot;/&quot;,&quot;&quot;)<br>
      inputpass=replace(inputpass,&quot;=&quot;,&quot;&quot;)<br>
      inputpass=left(inputpass,12)<br>
      <br>
      found=0<br>
      if found=0 then&nbsp;&nbsp;&nbsp;&nbsp; </font><font size="2">
      <font face="Arial">
      <font color="#FF0000">' 比對帳號,一般老師用</font><font color="#800000"><br>
      tea_pass=inputpass<br>
      tea_id=usrid<br>
      sqlstring=&quot;select * from SEMP where EMPNO='&quot; &amp; tea_id &amp; &quot;' and PWD='&quot; &amp; 
      ucase(gTransPWD(tea_pass)) &amp; &quot;'&quot; <br>
&nbsp;&nbsp;&nbsp; Set RS = Conn1.Execute(sqlstring)<br>
&nbsp;&nbsp;&nbsp; if not RS.eof then found=2&nbsp;&nbsp;
      </font>
      <font color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '身分是老師,比對帳號成功<br>
      </font>
      <font color="#800000">&nbsp;&nbsp;&nbsp; end if<br>
      end if<br>
      </font>
      <font color="#FF0000">'---------比對身分是學生帳號開始---------<br>
      </font>
      <font color="#800000">if found=0 then<br>
      </font>
      <font color="#FF0000">'身分是學生家長或學生帳號<br>
      </font>
      <font color="#800000">sqlstring=&quot;select *,BSTD_SEME.CLASSNO,BSTD_SEME.SEAT from BSTD,BSTD_SEME 
      where BSTD.STDNO = BSTD_SEME.STDNO and BSTD.IDNO='&quot; &amp; inputpass &amp; &quot;' and 
      BSTD_SEME.CLASSNO='&quot; &amp; left(usrid,3) &amp; &quot;' and BSTD_SEME.SEAT='&quot; &amp; 
      right(usrid,2) &amp; &quot;' and BSTD_SEME.SYEAR=&quot; &amp; syear &amp; &quot; and BSTD_SEME.SEME=&quot; 
      &amp; seme<br>
      Set RS = Conn1.Execute(sqlstring)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if not RS.BOF then <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sid = 
      RS(&quot;CLASSNO&quot;) &amp; RS(&quot;SEAT&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; usrid = 
      right(usrid,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; found=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      </font>
      <font color="#FF0000">&nbsp;'身分是學生<br>
      </font>
      <font color="#800000">end if</font></font></p>
    </blockquote>
    <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
    </font><font size="2" color="#800000" face="Arial">end if<br>
&nbsp;&nbsp;&nbsp; session(&quot;topage&quot;) = 
    &quot;/msg.asp?msg=歡迎登入！&quot;<br>
&nbsp;&nbsp;&nbsp; if request(&quot;topage&quot;) &lt;&gt; &quot;&quot; then session(&quot;topage&quot;) = 
    Request(&quot;topage&quot;)<br>
    &nbsp;&nbsp;&nbsp; select case found<br>
    &nbsp;&nbsp;&nbsp; case 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.redirect 
    &quot;/msg.asp?msg=身份確認失敗!&lt;br&gt;無法進入&quot;<br>
&nbsp;&nbsp;&nbsp; case 1<br>
    </font><font size="2" face="Arial" color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '系統保留未來用途,不做事</font><font size="2" color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp; case 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glEmpname&quot;) &amp; &quot;'&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strseme &amp; &quot;' and TEA_NO ='&quot; &amp; 
    session(&quot;glEmpid&quot;) &amp; &quot;'&quot;<br>
    </font><font size="2" face="Arial" color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    ' ---老師認證通過後session處理</font><font size="2" color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    session(&quot;glPS&quot;)=inputpass<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    session(&quot;glEmpname&quot;)=trim(RS(&quot;NAME&quot;))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    sqlclass=&quot;select CLASSNO from BCLASS where SYEAR= '&quot; &amp; syear &amp; &quot;' and 
    SEME='&quot; &amp; seme &amp; &quot;' and TEA_NO = '&quot; &amp; Ucase(usrid) &amp; &quot;' &quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set 
    RS2=conn1.Execute(sqlclass)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if not 
    RS2.EOF then session(&quot;glClass&quot;)=RS2(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    session(&quot;glEmpid&quot;)=usrid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    session(&quot;glEmail&quot;)=Lcase(usrid) &amp; &quot;@webmail.ysps.tp.edu.tw&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    session(&quot;glPS&quot;)=RS(&quot;PWD&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    session(&quot;glEmpname&quot;)=trim(RS(&quot;NAME&quot;))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    session(&quot;passed&quot;)=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br>
    </font><font size="2" face="Arial" color="#FF0000">' ---學生認證通過後session處理<br>
    </font><font size="2" color="#800000" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp; case 3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;stuid&quot;)=usrid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glEmpid&quot;)=RS(&quot;STDNO&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glPS&quot;)=inputpass<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glEmpname&quot;)=trim(RS(&quot;NAME&quot;))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glDepid&quot;)=RS(&quot;CLASSNO&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glClass&quot;)=session(&quot;glDepid&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glSeat&quot;)=RS(&quot;SEAT&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;glEmail&quot;)=&quot;cc&quot; &amp; usrid &amp; 
    &quot;@stu.ysps.tp.edu.tw&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session(&quot;passed&quot;)=4<br>
    end select<br>
    RS.Close<br>
    Conn1.close<br>
    response.write &quot;&lt;script&gt;&quot;<br>
    response.write &quot;location='&quot; &amp; session(&quot;topage&quot;) &amp; &quot;';&quot;<br>
    response.write &quot;&lt;/script&gt;&quot;<br>
    %&gt;</font></div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <b>6.填入ASP程式碼　</b><font color="#0000FF" size="2">（範例：</font><a href="http://www.ysps.tp.edu.tw/award/default.asp" style="font-style: normal; font-variant: normal; font-family: 新細明"><font size="2">網路有獎徵答</font></a><font color="#0000FF" size="2">）</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial"><b><font size="2">default.asp</font></b></font><font size="2"> 
  (有獎徵答首頁)</p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial"><font color="#800000">&lt;%<br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  </font></font><font face="Arial" color="#FF0000">' 直接叫用寫在global.asa 裡的 
  Application變數</font><font face="Arial"><font color="#800000"><br>
  conn.open Application(&quot;spps&quot;)<br>
  </font></font><font face="Arial" color="#FF0000">' 
  把sql命令語法指定給sql變數：選擇award_question資料表,並按照結束日期欄位照降冪排序</font><font face="Arial"><font color="#800000"><br>
  sql = &quot;select * from award_question order by end_date desc&quot;&nbsp;&nbsp;&nbsp; <br>
  </font></font><font face="Arial" color="#FF0000">' 執行sql字串並將結果放入資料錄</font><font face="Arial"><font color="#800000"><br>
  set rs=conn.execute(sql)<br>
  %&gt;</font><br>
  &lt;html&gt;&lt;head&gt;&lt;title&gt;有獎徵答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;table id=&quot;AutoNumber1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;h1&gt;《網路有獎徵答》&lt;/h1&gt;&lt;/td&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;a href=&quot;manager.asp&quot;&gt;&lt;/a&gt;&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;td&gt;&lt;font size=&quot;3&quot; color=&quot;#385B96&quot;&gt;§ &lt;a href=&quot;sort.asp&quot;&gt;得獎排行榜&lt;/a&gt;&lt;/td&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;td&gt;&lt;a href=&quot;manager.asp&quot;&gt;管理&lt;/a&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;&lt;center&gt;<br>
  &lt;table border=&quot;1&quot;&gt;<br>
  &lt;tr&gt;&lt;td&gt;期別&lt;/td&gt;&lt;td&gt;對象&lt;/td&gt;&lt;td&gt;題目&lt;/td&gt;&lt;td&gt;活動期限&lt;/td&gt;&lt;/tr&gt;<br>
  <font color="#800000">&lt;%<br>
  </font></font><font face="Arial" color="#FF0000">' 如果資料錄是空的</font><font face="Arial"><font color="#800000"><br>
  if rs.eof then response.write &quot;&lt;tr&gt;&lt;td align=center&gt;目前沒有徵答活動&lt;/td&gt;&lt;/tr&gt;&quot;<br>
  </font></font><font face="Arial" color="#FF0000">' 如果資料錄不是空的[有出過題]</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp; while not rs.eof<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id = rs(&quot;id&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font>
  <font face="Arial" color="#FF0000">' 把資料錄中的id欄位的值指定給變數id</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grade = rs(&quot;grade&quot;)&nbsp; </font></font>
  <font face="Arial" color="#FF0000">' 把資料錄中的grade欄位的值指定給變數grade</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=0 then desc=&quot;低年級&quot;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 判斷grade變數的值如果=0,指定desc變數=低年級</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=1 then desc=&quot;中年級&quot;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 判斷grade變數的值如果=1,指定desc變數=中年級</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=2 then desc=&quot;高年級&quot;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 判斷grade變數的值如果=2,指定desc變數=高年級</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=3 then desc=&quot;全校&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 判斷grade變數的值如果=3,指定desc變數=全校</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz = rs(&quot;question&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font>
  <font face="Arial" color="#FF0000">' 把資料錄中的question欄位的值指定給變數quiz</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz = replace(quiz,chr(13),&quot;&lt;br&gt;&quot;) </font></font>
  <font face="Arial" color="#FF0000">' 用&lt;br&gt;字串替換掉換行字元</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sdate = 
  rs(&quot;start_date&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font>
  <font face="Arial" color="#FF0000">' 把資料錄中的start_date欄位的值指定給變數sdate</font><font color="#800000" face="Arial" "><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edate = 
  rs(&quot;end_date&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial" color="#FF0000">&nbsp;' 把資料錄中的edn_date欄位的值指定給變數edate</font><font color="#800000" face="Arial" "><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pdate = 
  rs(&quot;post_date&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial" color="#FF0000">' 把資料錄中的post_date欄位的值指定給變數pdate</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if sdate&lt;=date() 
  and edate&gt;=date() then </font></font><font face="Arial" color="#FF0000">' 
  如果今天還可以作答(介於開始日期和結束日期之間)</font><font color="#800000" face="Arial" "><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  bgc = &quot;#eeeeFF&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial" color="#FF0000">' 把這列的背景色變數指定為#eeeeff</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif edate&lt;=date()then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 如果超過了截止日期&nbsp; <br>
  </font>
  <font color="#800000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  bgc = &quot;#aaaacc&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font>
  <font face="Arial" color="#FF0000">' 把這列的背景色變數指定為#aaaacc</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  bgc = &quot;#cceecc&quot;</font></font><font face="Arial" color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  ' 剩下就是尚未到期的題目</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br>
  %&gt;</font><br>
  &lt;tr&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial" color="#FF0000">&lt;% ' 以下分別放入背景色、題號id、適用年級、題目、截止日期 %&gt;</font><font face="Arial"><br>
  &nbsp;&nbsp;&nbsp;
  &lt;td bgcolor=&quot;<font color="#800000">&lt;% =bgc %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  = id %&gt;</font>　&lt;/td&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;td bgcolor=&quot;<font color="#800000">&lt;% =bgc %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =desc %&gt;</font>　&lt;/td&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;td bgcolor=&quot;<font color="#800000">&lt;% =bgc %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =quiz %&gt;</font>　&lt;/td&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;td bgcolor=&quot;<font color="#800000">&lt;% =bgc %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  = year(edate)-1911 &amp; &quot;/&quot; &amp; month(edate) &amp; &quot;/&quot; &amp; day(edate) %&gt;</font>&lt;/td&gt;<br>
  &nbsp;&nbsp;&nbsp;
  &lt;td bgcolor=&quot;<font color="#800000">&lt;% =bgc %&gt;</font>&quot;&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial"><br>
  <font color="#800000">&nbsp;&nbsp;&nbsp; &lt;%  </font></font>
  <font face="Arial" color="#FF0000">' 判斷日期介於開始和結束之間，也就是還沒過期的話，放上〝我要答〞的超連結</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">
  <font color="#800000">&nbsp;&nbsp;&nbsp; if sdate&lt;=date() and edate&gt;=date() then %&gt;</font><br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;a href=&quot;answer.asp?id=<font color="#800000">&lt;%=id%&gt;</font>&quot;&gt;我要答&lt;/a&gt;<br>
  <font color="#800000">&nbsp;&nbsp;&nbsp; &lt;%</font></font><font face="Arial" color="#FF0000">' 
  判斷如果已經過期的話放上〝得獎名單〞的超連結</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp; elseif edate &lt; date() then %&gt; </font><br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;a href=&quot;list.asp?id=<font color="#800000">&lt;%=id%&gt;</font>&quot;&gt;得獎名單&lt;/a&gt;<br>
  <font color="#800000">&nbsp;&nbsp;&nbsp; &lt;%</font></font><font face="Arial" color="#FF0000">' 
  判斷日期尚未開始，就放上〝敬請期待〞的文字</font><font face="Arial"><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif sdate &gt; date() then%&gt; </font><br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  尚未開始&lt;br&gt;敬請期待<br>
  <font color="#800000">&nbsp;&nbsp;&nbsp; &lt;% end if %&gt;</font><br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#800000">&lt;%　</font></font><font face="Arial" color="#FF0000">' 
  移到下一筆資料錄的迴圈底部</font><font face="Arial"><font color="#800000"><br>
  &nbsp;&nbsp;&nbsp;
  rs.movenext<br>
  &nbsp;&nbsp;&nbsp;
  wend<br>
  %&gt;</font><br>
  &lt;/table&gt;&lt;/center&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial"><b>manager.asp：老師的管理頁面</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#FF0000">&lt;% ' 權限認證部分等完成後後再補 %&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;html&gt;&lt;head&gt;&lt;title&gt;有獎徵答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;管理選項&lt;/h1&gt;<br>
  &lt;div align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;table border=&quot;1&quot;&gt;<br>
  &lt;tr&gt;&lt;td&gt;期別&lt;/td&gt;&lt;td&gt;對象&lt;/td&gt;&lt;td&gt;題目（點題目審閱）&lt;/td&gt;&lt;td&gt;作答人數&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;addnew.asp&quot;&gt;新增題目&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;<br>
  <font color="#800000">&lt;%<br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  conn.open Application(&quot;spps&quot;)<br>
  sql = &quot;select * from award_question order by id desc&quot;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">’ 依照id來排序</font><font color="#800000"><br>
  set rs=conn.execute(sql)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">&nbsp;’ 執行sql指令放入資料錄rs</font><font color="#800000"><br>
  while not rs.EOF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">’ 如果資料錄不是空的</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp; id = rs(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp; grade = rs(&quot;grade&quot;)<br>
&nbsp;&nbsp;&nbsp; if grade=0 then desc=&quot;低年級&quot;<br>
&nbsp;&nbsp;&nbsp; if grade=1 then desc=&quot;中年級&quot;<br>
&nbsp;&nbsp;&nbsp; if grade=2 then desc=&quot;高年級&quot;<br>
&nbsp;&nbsp;&nbsp; quiz = rs(&quot;question&quot;)<br>
&nbsp;&nbsp;&nbsp; quiz = replace(quiz,chr(13),&quot;&lt;br&gt;&quot;)<br>
&nbsp;&nbsp;&nbsp; total = rs(&quot;num&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">’ 統計回答人數</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp; %&gt; </font><br>
&nbsp;&nbsp;&nbsp; &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#800000">&lt;% =id %&gt;</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#800000">&lt;% =desc %&gt;</font>　&lt;/td&gt;<br>
  <font color="#FF0000">&lt;% ' 點題目老師可以去審核答案的超連結 %&gt;<br>
  </font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;a href=checkit.asp?id=<font color="#800000">&lt;% =id %&gt;</font>&gt;<font color="#800000">&lt;% 
  =quiz %&gt;</font>&lt;/a&gt;　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#800000">&lt;% =total %&gt;</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;<br>
  <font color="#FF0000">&lt;% ' 老師的管理選項 %&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href=edit.asp?id=<font color="#800000">&lt;% 
  =id %&gt;</font>&gt;修改&lt;/a&gt;　<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href=delete.asp?id=<font color="#800000">&lt;% 
  =id %&gt;</font>&gt;刪除&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href=list.asp?id=<font color="#800000">&lt;% 
  =id %&gt;</font>&gt;得獎名單&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/tr&gt;<br>
  <font color="#800000">&lt;%<br>
&nbsp;&nbsp;&nbsp; rs.movenext<br>
&nbsp;&nbsp;&nbsp; wend<br>
  %&gt;</font><br>
  &lt;/table&gt;<br>
  &lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;<br>
  &lt;/center&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial"><b>addnew.asp ：新增題目</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#FF0000">&lt;% ' 權限認證部分後補 %&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial"><font color="#800000">&lt;% </font><font color="#FF0000">' 
  取現在的年、月、日指定給變數，以便後面的比對</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp; thisyear = year(now())-1911<br>
&nbsp;&nbsp;&nbsp; thismonth = month(now())<br>
&nbsp;&nbsp;&nbsp; thisday = day(now())</font></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" color="#800000">&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial"><font color="#800000">Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
&nbsp;&nbsp;&nbsp; conn.open Application(&quot;spps&quot;)<br>
&nbsp;&nbsp;&nbsp; sql = &quot;select max(id) from award_question&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 選出目前題號最大的值</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp; set rs=conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isnull(rs(0)) then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 如果資料錄裡是空的</font><font color="#800000">&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id=1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 已經有題號,就把題號加一</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id = rs(0) + 
  1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br>
  %&gt;</font><br>
  &lt;html&gt;&lt;head&gt;&lt;title&gt;新增題目&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;&lt;h1 align=&quot;center&quot;&gt;&lt;font face=&quot;標楷體&quot;&gt;新增題目&lt;/h1&gt;<br>
  &lt;hr&gt;<br>
  第<font color="#FF0000">&lt;% =id %&gt;</font>期有獎徵答&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <font color="#FF0000">'目前題號</font><br>
  &lt;form method=&quot;POST&quot; <font color="#800000">action=&quot;save.asp&quot;</font>&gt;<br>
  &lt;input type=<font color="#800000">hidden</font> <font color="#800000">name=id</font> 
  value=&quot;&lt;% =id %&gt;&quot;&gt;<br>
  &lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;&lt;td &gt;適用階段&lt;/td&gt;<br>
  &lt;td &gt;<br>
&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;grade&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;0&quot;&gt;低年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;1&quot;&gt;中年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;2&quot;&gt;高年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option value=&quot;3&quot;&gt;全校&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/select&gt; <br>
  &lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt;<br>
  &lt;td &gt;題目是&lt;/td&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td&gt;&lt;textarea rows=&quot;5&quot; name=&quot;quiz&quot; 
  cols=&quot;33&quot;&gt;&lt;/textarea&gt; &lt;/td&gt; <br>
  &lt;/tr&gt; <br>
  &lt;tr&gt;&lt;td&gt;正確答案&lt;/td&gt;&lt;td &gt;&lt;input type=&quot;text&quot; name=&quot;correct&quot; size=&quot;35&quot;&gt;&lt;/td&gt;&lt;/tr&gt;
  <br>
  &lt;tr&gt;&lt;td &gt;開始日期&lt;/td&gt;&lt;td &gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <font color="#800000">&lt;% for i=thisyear to thisyear+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 迴圈範圍只要今年和明年就可以了 </font>
  <font color="#800000">%&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =i %&gt;</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <font color="#800000">&lt;% next %&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;smonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <font color="#800000">&lt;% for i=1 to 12%&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  &lt;option <font color="#800000">&lt;% if i=thismonth then&nbsp; </font>
  <font color="#FF0000">' 如果剛好是這個月</font><font color="#800000"> %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =i %&gt;</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <font color="#800000">&lt;% next %&gt;</font></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;sday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <font color="#800000">&lt;% for i=1 to 31%&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option
  <font color="#800000">&lt;% if i=thisday then&nbsp;&nbsp; </font>
  <font color="#FF0000">' 如果剛好是今天 </font>
  <font color="#800000">%&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =i %&gt;</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <font color="#800000">&nbsp;&lt;% next %&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 <br>
  &lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt;&lt;td &gt;結束日期&lt;/td&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;td &gt;&lt;select size=&quot;1&quot; name=&quot;eyear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=thisyear 
  to thisyear+1%&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option 
  value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;
  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;</font>
  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;emonth&quot;&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;% for i=1 to 
  12%&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option
  <font color="#800000">&lt;% if i=thismonth then %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =i&nbsp;&nbsp;&nbsp;&nbsp; %&gt;</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;
  </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; 
  name=&quot;eday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=1 to 
  31%&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option
  <font color="#800000">&lt;% if i=thisday then %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =i %&gt;</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;
  </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日 <br>
  &lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt; <br>
  &lt;td &gt;公告日期&lt;/td&gt; <br>
  &lt;td &gt; <br>
&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;pyear&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=thisyear 
  to thisyear+1%&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option 
  value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;
  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;
  </font><br>
&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;pmonth&quot;&gt; <br>
&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=1 to 12%&gt;</font> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option <font color="#800000">&lt;% if i=thismonth 
  then %&gt;</font>selected<font color="#800000">&lt;% end if %&gt;</font> value=&quot;<font color="#800000">&lt;% 
  =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i&nbsp;&nbsp;&nbsp;&nbsp; %&gt;</font>&lt;/option&gt;
  <br>
&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt; </font><br>
&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;pday&quot;&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=1 to 
  31%&gt; </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option
  <font color="#800000">&lt;% if i=thisday then %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% 
  =i %&gt;</font>&lt;/option&gt; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;
  </font><br>
  &lt;/select&gt;日 <br>
  &lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/center&gt; </font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">&lt;p align=&quot;center&quot;&gt; <br>
  &lt;input type=&quot;submit&quot; value=&quot;存檔&quot; name=&quot;B1&quot;&gt;　&lt;input type=&quot;reset&quot; value=&quot;重寫&quot; 
  name=&quot;B2&quot;&gt;&lt;/p&gt; <br>
  &lt;/form&gt; <br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;&lt;/body&gt; &lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>save.asp ： 各種動作的存檔程式</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#800000" face="Arial">&lt;%　</font><font face="Arial"><font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 權限判斷不可忘記補上</font></font><font color="#800000" face="Arial"><br>
  if session(&quot;glempid&quot;)=&quot;WINER&quot; then permtype=&quot;A&quot;<br>
  if permtype&lt;&gt;&quot;A&quot; then response.redirect &quot;../msg.asp?msg=您無權使用此程式&quot;<br>
&nbsp;&nbsp;&nbsp; Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
&nbsp;&nbsp;&nbsp; conn.open Application(&quot;spps&quot;)<br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 去除使用者輸入的表單傳來的資料中，潛藏有SQL隱碼攻擊可能的單引號字串</font></font><font color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id=Request(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id=replace(id,&quot;'&quot;,&quot;&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grade=Request(&quot;grade&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz=Request(&quot;quiz&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz=replace(quiz,&quot;'&quot;,&quot;〝&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; correct=Request(&quot;correct&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; correct=replace(correct,&quot;'&quot;,&quot;〝&quot;)<br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 因為標單上選的是國曆年，寫入資料庫的是民國西元要經過轉換、再把年月日連接起來，定給給變數</font></font><font color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sdate = Request(&quot;syear&quot;)+1911 &amp; &quot;/&quot; &amp; 
  Request(&quot;smonth&quot;) &amp; &quot;/&quot; &amp; Request(&quot;sday&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sdate=replace(sdate,&quot;'&quot;,&quot;&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edate = Request(&quot;eyear&quot;)+1911 &amp; &quot;/&quot; &amp; 
  Request(&quot;emonth&quot;) &amp; &quot;/&quot; &amp; Request(&quot;eday&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edate=replace(edate,&quot;'&quot;,&quot;&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pdate = Request(&quot;pyear&quot;)+1911 &amp; &quot;/&quot; &amp; 
  Request(&quot;pmonth&quot;) &amp; &quot;/&quot; &amp; Request(&quot;pday&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pdate=replace(pdate,&quot;'&quot;,&quot;&quot;)<br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 選出標單傳來的題號的SQL語法</font></font><font color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_question where id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp; set rs=conn.execute(sql)<br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 如果資資料錄是空的(沒有這個id,表示資料庫中沒有這個題目,動作一定是新增)</font></font><font color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if rs.eof then </font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 
  就把後面要執行的sql字串變數,寫成插入新的id、年級、題目、答案、日期等資料到資料表award_question中</font></font><font color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;Insert 
  into award_question (id,grade,question,correct,start_date,end_date,post_date) 
  values (&quot;<br>
  sql = sql &amp; id &amp; &quot;,&quot; &amp; grade &amp; &quot;,'&quot; &amp; quiz &amp; &quot;','&quot; &amp; correct &amp; &quot;','&quot; &amp; sdate &amp; 
  &quot;','&quot; &amp; edate &amp; &quot;','&quot; &amp; pdate &amp; &quot;')&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 否則就寫成更新資料到資料表award_question中</font></font><font color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;Update 
  award_question set grade=&quot; &amp; grade &amp; &quot;,question='&quot; &amp; quiz &amp; &quot;',correct='&quot; &amp; 
  correct &amp; &quot;',start_date='&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = sql &amp; 
  sdate &amp; &quot;',end_date='&quot; &amp; edate &amp; &quot;',post_date='&quot; &amp; pdate &amp; &quot;' where id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if <br>
  </font>
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' </font></font><font face="Arial" color="#FF0000">
  執行sql命令</font><font color="#800000" face="Arial"><br>
&nbsp;&nbsp;&nbsp; conn.execute(sql)</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial"> <font color="#800000">&nbsp; </font>
  <font color="#FF0000">' </font></font><font face="Arial" color="#FF0000">
  把網頁轉到〝管理頁面〞</font><font color="#800000" face="Arial"><br>
  response.redirect &quot;manager.asp&quot;<br>
  %&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  </font><font color="#0000FF" face="Arial"><b><font size="2">answer.asp 學生填答的表單</font></b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2"><font color="#800000">&lt;%</font></font><font face="Arial" size="2"><font color="#800000">&nbsp; </font>
  <font color="#FF0000">' 權限判斷</font><font color="#800000"><br>
  if session(&quot;passed&quot;)=0 then response.redirect 
  &quot;/check.asp?pageto=/award/answer.asp&quot;<br>
  if session(&quot;passed&quot;)&lt;&gt;4 then response.redirect 
  &quot;/msg.asp?msg=很抱歉，只有學生可以參加有獎徵答活動！&quot;<br>
  <br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  conn.open Application(&quot;spps&quot;)<br>
&nbsp; </font><font color="#FF0000">' 取出表單傳來的id</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id = Request(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id = replace(id,&quot;'&quot;,&quot;&quot;)<br>
&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_question where id=&quot; &amp; id <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set rs=conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grade = rs(&quot;grade&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz = rs(&quot;question&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edate = rs(&quot;end_date&quot;)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; if grade &lt; 3 then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 判斷題目中限定不是全校年段的話<br>
  </font><font color="#800000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if 
  int((cint(left(session(&quot;glClass&quot;),1))-1)/2) &lt;&gt; grade then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 取回經過check2.asp檢查後，產生的 glClass 
  session變數。左邊算起取一位，減去1、取整數後，再除以２就可以判斷學生帳號中的年級是低、中、或是高年級</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  response.redirect &quot;/msg.asp?msg=很抱歉，您不能回答這個題目！&quot; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 年段不合的話</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; end if<br>
  sql = &quot;select * from award_answer where id=&quot; &amp; id &amp; &quot; and stdno='&quot; &amp; 
  session(&quot;glEmpid&quot;) &amp; &quot;'&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">'根據學生的學號 session，選出這個學生有回答過這題的紀錄</font><font color="#800000"><br>
  set rs1 = conn.execute(sql)<br>
  %&gt;</font><br>
  &lt;html&gt;&lt;head&gt;&lt;title&gt;我要回答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1&gt;我會回答問題&lt;/h1&gt;<br>
  &lt;hr&gt;<br>
  <font color="#800000">&lt;% my_name = session(&quot;stuid&quot;) &amp; session(&quot;glempname&quot;) %&gt;　&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 把名牌號碼和姓名接起來<br>
  </font>&lt;p&gt;&lt;font color=&quot;blue&quot;&gt;<font color="#800000">&lt;% =my_name %</font>&gt;小朋友請注意以下規則：&lt;/p&gt;<font color="#FF0000">
  <br>
  </font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.每人只能回答一次，無法反悔改答案&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.請多利用圖書館或網路尋找答案&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.請不要替他人作答或洩漏答案，影響比賽的公平性&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4.所有的成績會在期末統計,並頒發獎品給答對最多題目的同學&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5.現有獎品:李忠憲老師提供 PS2 五台 , XBOX 三台 &lt;br&gt;<br>
  <font color="#800000">&lt;% if not rs1.EOF then 　&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">' 資料錄裡已經有學生回答過的資料了&nbsp;&nbsp;&nbsp; </font>
  <font color="#800000">%&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;marquee 
  behavior=&quot;alternate&quot;&gt;你已經答過這題了，不可以修改或再次作答！&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/marquee&gt;&lt;a 
  href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  <font color="#800000">&lt;% else %&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 本期題目：<font color="#800000">&lt;% =quiz 
  %&gt;</font>&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 我的答案是：<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;form 
  method=&quot;POST&quot; action=&quot;thanx.asp&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input 
  type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;&lt;% =id %&gt;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;textarea 
  rows=&quot;5&quot; name=&quot;answer&quot; cols=&quot;45&quot; &gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  我是<font color="#800000">&lt;% =name %&gt;</font>,我的答案是:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/textarea&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;input type=&quot;submit&quot; value=&quot;寫好了，幫我儲存&quot; name=&quot;B1&quot;&gt;　&lt;input 
  type=&quot;reset&quot; value=&quot;重寫&quot; name=&quot;B2&quot;&gt;&lt;/form&gt;<br>
  <font color="#800000">&lt;% end if %&gt;</font><br>
  &lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>thankx.asp：寫入資料庫並寄發eamil 通知管理老師</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial" color="#FF0000">&lt;%'權限認證部分候補 %&gt;</font><font size="2" face="Arial" color="#800000"><br>
  &lt;%<br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  conn.open Application(&quot;spps&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id = request(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id = replace(id,&quot;'&quot;,&quot;&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_question 
  where id=&quot; &amp; id <br>
&nbsp;&nbsp;&nbsp; set rs=conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz = rs(&quot;question&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edate = rs(&quot;end_date&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pdate = rs(&quot;post_date&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count=rs(&quot;num&quot;)+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial" size="2">
  <font color="#800000">　&nbsp;&nbsp;&nbsp; </font><font color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  ' 回答過的計數器欄位+1 </font></font>
  <font size="2" face="Arial" color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; answer = Request(&quot;answer&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; answer = replace(answer,&quot;'&quot;,&quot;&quot;)<br>
  </font>
  <font face="Arial" size="2">
  <font color="#800000">　&nbsp;&nbsp;&nbsp; </font><font color="#FF0000">' 
  判斷資料表中有沒有題號和學生學號的sql</font></font><font size="2" face="Arial" color="#800000"><br>
&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_answer where stdno='&quot; &amp; 
  session(&quot;glEmpid&quot;) &amp; &quot;' and id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp; Set rs1=conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if rs1.EOF then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font size="2" face="Arial" color="#FF0000">' 如果資料標裡面沒有紀錄 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial" size="2">
  <font color="#800000">&nbsp;</font><font color="#FF0000">'sql 語句就寫成新增一筆</font></font><font size="2" face="Arial" color="#FF0000"><br>
  </font>
  <font size="2" face="Arial" color="#800000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;Insert 
  into award_answer (id,stdno,classno,student,answer) values (&quot; &amp; id &amp; &quot;,'&quot; &amp; 
  session(&quot;glEmpid&quot;) &amp; &quot;','&quot; &amp; session(&quot;glClass&quot;) &amp; &quot;','&quot; &amp; session(&quot;glEmpname&quot;) 
  &amp; &quot;','&quot; &amp; answer &amp; &quot;')&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  conn.execute(sql)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font face="Arial" size="2">
  <font color="#800000">　&nbsp;&nbsp;&nbsp; </font><font color="#FF0000">' 
  執行新增sql</font></font><font size="2" face="Arial" color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;Update 
  award_question set num=num+1 where id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  conn.execute(sql)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000" face="Arial" size="2">&nbsp;&nbsp; ' 執行修改已回答的人數sql</font><font size="2" face="Arial" color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br>
  <br>
  </font>
  <font size="2" face="Arial" color="#FF0000">'  自動寄發email給管理老師段落<br>
  </font>
  <font size="2" face="Arial" color="#800000">&nbsp;&nbsp;&nbsp; name = session(&quot;glempname&quot;) <br>
&nbsp;&nbsp;&nbsp; email = &quot;cc&quot; &amp; session(&quot;stuid&quot;) &amp; &quot;@stu.xxps.tp.edu.tw&quot;</font><font color="#FF0000" face="Arial" size="2">&nbsp;&nbsp;&nbsp; 
  ' 連接成學生的email</font><font size="2" face="Arial" color="#800000"><br>
&nbsp;&nbsp;&nbsp; Subject = &quot;網站有獎徵答有同學填答了!&quot;<br>
&nbsp;&nbsp;&nbsp; Words =answer<br>
&nbsp;&nbsp;&nbsp; Body=&quot;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv='Content-Type' 
  content='text/html; charset=big5'&gt;&lt;/head&gt;&lt;body&gt;&lt;table border=0 bgcolor=#dfefff 
  style=font-size:11pt width=550&gt;&lt;tr&gt;&lt;td bgcolor=#6699cc&gt;&lt;font color= white&gt;&lt;b&gt; 
  ■答題學生姓名：&quot; &amp; Name &amp; &quot;&lt;/b&gt;&lt;/td&gt;&quot; &amp; chr(13)&nbsp; </font>
  <font size="2" face="Arial" color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  ' chr(13)是換行字元</font><font size="2" face="Arial" color="#800000">&nbsp; <br>
&nbsp;&nbsp;&nbsp; Body=Body &amp; &quot;&lt;tr&gt;&lt;td align=center &gt;&lt;font color=darkblue 
  face=標楷體&gt;&lt;h2&gt;有獎徵答學生填答通知&lt;/h2&gt;&quot; &amp; &quot;&lt;/td&gt;&lt;/tr&gt;&quot; &amp; chr(13)<br>
&nbsp;&nbsp;&nbsp; Body=Body &amp; &quot;&lt;tr&gt;&lt;td&gt;■學生email：&quot; &amp; email &amp; chr(13)<br>
&nbsp;&nbsp;&nbsp; Body=Body &amp; &quot;&lt;/td&gt;&lt;/tr&gt;&quot;<br>
&nbsp;&nbsp;&nbsp; Body=Body &amp; &quot;&lt;tr&gt;&lt;td&gt;【題目=&quot; &amp; id &amp; quiz &amp; &quot;】)&lt;/td&gt;&quot; &amp; chr(13) 
  &amp; &quot;學生的答案：&quot; &amp; words &amp; chr(13)<br>
&nbsp;&nbsp;&nbsp; Body=Body &amp; &quot;&lt;tr&gt;&lt;td&gt;&lt;a 
  href = 'http://www.xxps.tp.edu.tw/checkt.asp?topage=/award/manager.asp'&gt;○請出題老師在活動截止前點這裡前往審核○&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&quot; 
  &amp; chr(13)<br>
&nbsp;&nbsp;&nbsp; Body=Body &amp; &quot;&lt;tr&gt;&lt;td align=right&gt;&lt;font color= red &gt;寄發時間：&quot; &amp; 
  now() <br>
&nbsp;&nbsp;&nbsp; Body=Body &amp; &quot;&lt;/tr&gt;&lt;/table&gt;&quot; &amp; chr(13)</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial"><font color="#800000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  Set Mail=Server.CreateObject(&quot;CDONTS.NewMail&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.MailFormat=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.BodyFormat=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.From = &quot;</font><a href="mailto:ysps@mail.ysps.tp.edu.tw"><font color="#800000">ysps@mail.ysps.tp.edu.tw</font></a><font color="#800000">&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.to = &quot;</font><a href="mailto:dd@xxps.tp.edu.tw;teacher@xxpx.tp.edu.tw"><font color="#800000">teacher@xxpx.tp.edu.tw</font></a><font color="#800000">;&quot; 
  &amp; email<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.Subject = subject<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.Body = Body<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mail.Send<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set Mail=Nothing<br>
  </font><font color="#FF0000">' -------自動寄發email 結束 </font><font color="#800000">%&gt;</font></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;html&gt;&lt;head&gt;&lt;title&gt;謝謝您的作答&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;謝謝您參加xx國小有獎徵答作答&lt;/h1&gt;<br>
  &lt;hr&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;b&gt;&lt;font color=&quot;#385B96&quot;&gt;您的答案已經存入資料庫，請等待截止日期老師審查
  ，於<font color="#800000">&lt;% 
  =edate %&gt;</font>後才會公佈正確答案及得獎名單！並於期末頒獎&lt;/b&gt;&lt;/p&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>edit.asp : 出題老師編修題目用
  ，和addnew.asp很像，可以複製addnew.asp來修改</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#800000" face="Arial" size="2">&lt;%<br>
  if session(&quot;glempid&quot;)=&quot;WINER&quot;&nbsp; then permtype=&quot;A&quot;<br>
  if permtype&lt;&gt;&quot;A&quot; then response.redirect &quot;../msg.asp?msg=您無權使用此程式&quot;<br>
&nbsp;&nbsp;&nbsp; thisyear = year(now())-1911<br>
&nbsp;&nbsp;&nbsp; thismonth = month(now())<br>
&nbsp;&nbsp;&nbsp; thisday = day(now())<br>
&nbsp;&nbsp;&nbsp; id = request(&quot;id&quot;)<br>
  <br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  conn.open Application(&quot;spps&quot;)<br>
  <br>
&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_question where id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set rs=conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grade = rs(&quot;grade&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz = rs(&quot;question&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; correct = rs(&quot;correct&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sdate = rs(&quot;start_date&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; syear = year(sdate)</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2"><font color="#800000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; smonth = month(sdate)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sday = day(sdate)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edate = rs(&quot;end_date&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; eyear = year(edate)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; emonth = month(edate)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; eday = day(edate)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pdate = rs(&quot;post_date&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pyear = year(pdate)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pmonth = month(pdate)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pday = day(pdate)<br>
  %&gt;<br>
  </font>&lt;html&gt;&lt;head&gt;&lt;title&gt;編修題目&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;&lt;font face=&quot;標楷體&quot;&gt;新增題目&lt;/font&gt;&lt;/h1&gt;&lt;hr&gt;<br>
  第<font color="#800000">&lt;% =id %&gt;</font>期有獎徵答</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;form method=&quot;POST&quot; action=&quot;save.asp&quot;&gt;<br>
  &lt;input type=hidden name=id value=&quot;<font color="#800000">&lt;% =id %&gt;</font>&quot;&gt;<br>
  &lt;div align=&quot;center&quot;&gt;&lt;center&gt;<br>
  &lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
  &lt;td&gt;適用年段&lt;/td&gt;<br>
  &lt;td&gt;<br>
  &lt;select size=&quot;1&quot; name=&quot;grade&quot;&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;0&quot; <font color="#800000">&lt;% if grade=0 then %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font>&gt;低年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;1&quot; <font color="#800000">&lt;% if grade=1 then %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font>&gt;中年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;2&quot; <font color="#800000">&lt;% if grade=2 then %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font>&gt;高年級&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;option value=&quot;3&quot;<font color="#800000"> &lt;% if grade=3 then %&gt;</font>selected<font color="#800000">&lt;% 
  end if %&gt;</font>&gt;全校&lt;/option&gt;<br>
  &lt;/select&gt; <br>
  &lt;/td&gt;&lt;/tr&gt; <br>
  &lt;tr&gt;<br>
  &lt;td&gt;題目是&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;textarea rows=&quot;5&quot; name=&quot;quiz&quot; cols=&quot;33&quot;&gt;<font color="#990000">&lt;% 
  =quiz %&gt;</font>&lt;/textarea&gt;<br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;正確答案&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<br>
&nbsp;&nbsp;&nbsp; &lt;input type=&quot;text&quot; name=&quot;correct&quot; size=&quot;35&quot; value=&quot;<font color="#990000">&lt;% 
  =correct %&gt;</font>&quot;&gt;<br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#33CCFF&quot;&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;開始日期&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#CCFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;syear&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=thisyear to thisyear+1%&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option 
  <font color="#800000">&lt;% if 
  i=syear then %&gt;</font>selected<font color="#800000">&lt;% end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#800000">&nbsp; &lt;% next %&gt;</font><br>
&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;smonth&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=1 to 12%&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option <font color="#800000">&lt;% if i=smonth then 
  %&gt;</font>selected<font color="#800000">&lt;% end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;</font><br>
&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;sday&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=1 to 31%&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option <font color="#800000">&lt;% if i=sday then 
  %&gt;</font>selected<font color="#800000">&lt;% end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;</font><br>
&nbsp;&nbsp;&nbsp; &lt;/select&gt;日<br>
  &lt;/td&gt;&lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#33CCFF&quot;&gt;&lt;font 
  color=&quot;#FFFFFF&quot;&gt;結束日期&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#CCFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;eyear&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <font color="#800000">&lt;% for 
  i=thisyear to thisyear+1%&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option 
  <font color="#800000">&lt;% if 
  i=eyear then %&gt;</font>selected<font color="#800000">&lt;% end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <font color="#800000">&lt;% next %&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select 
  size=&quot;1&quot; name=&quot;emonth&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;% for i=1 to 
  12%&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option &lt;% if 
  i=emonth then %&gt;selected&lt;% end if %&gt; value=&quot;&lt;% =i %&gt;&quot;&gt;&lt;% =i %&gt;&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;% next %&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select 
  size=&quot;1&quot; name=&quot;eday&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;% for i=1 to 
  31%&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option &lt;% if 
  i=eday then %&gt;selected&lt;% end if %&gt; value=&quot;&lt;% =i %&gt;&quot;&gt;&lt;% =i %&gt;&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;% next %&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日<br>
  &lt;/td&gt;&lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#33CCFF&quot;&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;公告日期&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td bgcolor=&quot;#CCFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select size=&quot;1&quot; name=&quot;pyear&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;% for 
  i=thisyear to thisyear+1%&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option 
  <font color="#800000">&lt;% if 
  i=pyear then %&gt;</font>selected<font color="#800000">&lt;% end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <font color="#800000">&lt;% next %&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;年</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select 
  size=&quot;1&quot; name=&quot;pmonth&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% for i=1 to 12%&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option<font color="#800000"> &lt;% if i=pmonth then 
  %&gt;</font>selected<font color="#800000">&lt;% end if %&gt; </font>value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#800000">&lt;% next %&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;月</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;select 
  size=&quot;1&quot; name=&quot;pday&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <font color="#800000">&lt;% for i=1 to 
  31%&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;option 
  <font color="#800000">&lt;% if 
  i=pday then %&gt;</font>selected<font color="#800000">&lt;% end if %&gt;</font> value=&quot;<font color="#800000">&lt;% =i %&gt;</font>&quot;&gt;<font color="#800000">&lt;% =i %&gt;</font>&lt;/option&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  <font color="#800000">&lt;% next %&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/select&gt;日<br>
  &lt;/td&gt;&lt;/tr&gt;<br>
  &lt;/table&gt;&lt;/center&gt;&lt;/div&gt;<br>
  &lt;p align=&quot;center&quot;&gt;<br>
  &lt;input type=&quot;submit&quot; value=&quot;存檔&quot; name=&quot;B1&quot;&gt;　　　　&lt;input type=&quot;reset&quot; value=&quot;重寫&quot; 
  name=&quot;B2&quot;&gt;&lt;/p&gt;<br>
  &lt;/p&gt;&lt;/form&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>checkit.asp：老師審查答案用</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2"><font color="#800000">&lt;%
  if session(&quot;glempid&quot;)=&quot;WINER&quot; then permtype=&quot;A&quot;<br>
  if permtype&lt;&gt;&quot;A&quot; then response.redirect &quot;/msg.asp?msg=您無權使用此程式&quot;<br>
  %&gt;<br>
  </font>&lt;html&gt;&lt;head&gt;&lt;title&gt;審閱答案&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;<br>
  &lt;h1 align=&quot;center&quot;&gt;&lt;font face=&quot;標楷體&quot;&gt;審閱答案&lt;/h1&gt;&lt;hr&gt;<br>
  <font color="#800000">&lt;%<br>
&nbsp;&nbsp;&nbsp; id = Request(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp; id = replace(id,&quot;'&quot;,&quot;&quot;)<br>
&nbsp;&nbsp;&nbsp; Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
&nbsp;&nbsp;&nbsp; conn.open Application(&quot;spps&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_question 
  where id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set rs1=conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grade = rs1(&quot;grade&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=0 then desc=&quot;低年級&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=1 then desc=&quot;中年級&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=2 then desc=&quot;高年級&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quiz = rs1(&quot;question&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; correct = rs1(&quot;correct&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </font><font color="#FF0000">' 選出所有學生已回答的答案sql</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_answer 
  where id=&quot; &amp; id &amp; &quot; order by classno&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set rs=conn.execute(sql)<br>
  %&gt;<br>
  </font>&lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;對　　象：&lt;/td&gt;&lt;td&gt;<font color="#800000">&lt;% =desc %&gt;</font>　&lt;/td&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;題　　目：&lt;/td&gt;&lt;td&gt;<font color="#800000">&lt;% =quiz %&gt;</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;正確答案：&lt;/td&gt;&lt;td&gt;<font color="#800000">&lt;% =correct %&gt;</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;<br>
  &lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;學號&lt;/td&gt;&lt;td &gt;班級&lt;/td&gt;&lt;td &gt;姓名&lt;/td&gt;&lt;td &gt;答案&lt;/td&gt;&lt;td &gt;答對&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;form method=&quot;POST&quot; action=&quot;update.asp&quot;&gt;<br>
  &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;<font color="#800000">&lt;% =id %&gt;</font>&quot;&gt;<br>
  <font color="#800000">&lt;%<br>
  while not rs.EOF&nbsp;&nbsp;&nbsp;
  </font><font color="#FF0000">' 如果有資料的話</font><font color="#800000"><br>
&nbsp;&nbsp;&nbsp; stdno = rs(&quot;stdno&quot;)<br>
&nbsp;&nbsp;&nbsp; classno = rs(&quot;classno&quot;)<br>
&nbsp;&nbsp;&nbsp; stdname = rs(&quot;student&quot;)<br>
&nbsp;&nbsp;&nbsp; answer = rs(&quot;answer&quot;)<br>
&nbsp;&nbsp;&nbsp; correct = rs(&quot;correct&quot;)<br>
  %&gt; <br>
  </font>&lt;tr&gt;<br>
  &lt;td&gt;<font color="#800000">&lt;% =stdno %&gt;　</font>&lt;/td&gt;<br>
  &lt;td&gt;<font color="#800000">&lt;% =classno %&gt;</font>　&lt;/td&gt;<br>
  &lt;td&gt;<font color="#800000">&lt;% =stdname %&gt;</font>　&lt;/td&gt;<br>
  &lt;td&gt;<font color="#800000">&lt;% =answer %&gt;</font>　&lt;/td&gt;<br>
  &lt;td&gt;<font color="#FF0000">&lt;% ' 如果原先審核過答案的話，答對的CheckBox要打勾%&gt;</font><br>
  &nbsp;&nbsp;&nbsp;
  &lt;input type=&quot;checkbox&quot; name=&quot;<font color="#800000">&lt;% = &quot;a&quot; &amp; stdno %&gt;</font>&quot; 
  value=&quot;ON&quot; <font color="#800000">&lt;% if correct then %&gt;</font>checked<font color="#800000">&lt;% 
  end if %&gt;</font>&gt;<br>
  &lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#800000">&lt;%<br>
&nbsp;&nbsp;&nbsp; rs.movenext<br>
&nbsp;&nbsp;&nbsp; wend<br>
  %&gt;<br>
  </font>&lt;/table&gt;&lt;/center&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;審核完畢，請幫我儲存&quot; name=&quot;B1&quot;&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial" size="2">&lt;input type=&quot;reset&quot; value=&quot;重新審核&quot; 
  name=&quot;B2&quot;&gt;&lt;/p&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>update.asp : 更新出題老師審核表單傳來的資料</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#990000" size="2" face="Arial">&lt;%<br>
  if session(&quot;glempid&quot;)=&quot;WINER&quot;&nbsp; then permtype=&quot;A&quot;<br>
  if permtype&lt;&gt;&quot;A&quot; then response.redirect &quot;../msg.asp?msg=您無權使用此程式&quot;<br>
  <br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  conn.open Application(&quot;spps&quot;)<br>
  <br>
&nbsp;&nbsp;&nbsp; id = Request(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp; id = replace(id,&quot;'&quot;,&quot;&quot;)<br>
  </font>
  <font color="#FF0000" size="2" face="Arial">' 先把答案都設為答錯</font><font color="#990000" size="2" face="Arial"><br>
&nbsp;&nbsp;&nbsp; sql = &quot;Update award_answer set correct=0 where id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp; conn.execute(sql)<br>
  </font>
  <font color="#FF0000" size="2" face="Arial">' 用for each .. in......next&nbsp;&nbsp; 
  以表單傳來的資料筆數數量，作為迴圈的圈數，逐筆取出</font><font color="#990000" size="2" face="Arial"><br>
&nbsp;&nbsp;&nbsp; for each x in Request.Form&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; answer = Request(x)&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000" size="2" face="Arial">’ 取回答案（因為判斷是否被老師勾選了）</font><font color="#990000" size="2" face="Arial"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stdno = mid(x,2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000" size="2" face="Arial">&nbsp;’ 學生學號<br>
  </font>
  <font color="#990000" size="2" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if answer=&quot;ON&quot; then&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000" size="2" face="Arial">' 如果被勾選答對<br>
  </font>
  <font color="#990000" size="2" face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;Update award_answer set 
  correct=1 where id=&quot; &amp; id &amp; &quot; and stdno='&quot; &amp; stdno &amp; &quot;'&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br>
&nbsp;&nbsp;&nbsp; next<br>
  response.redirect &quot;manager.asp&quot;<br>
  %&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>delete.assp : 刪除題目</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial" color="#990000">&lt;%<br>
  if session(&quot;glempid&quot;)=&quot;WINER&quot;&nbsp; then permtype=&quot;A&quot;<br>
  if permtype&lt;&gt;&quot;A&quot; then response.redirect &quot;../msg.asp?msg=您無權使用此程式&quot;<br>
  <br>
&nbsp;&nbsp;&nbsp; id = Request(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp; id = replace(id,&quot;'&quot;,&quot;&quot;)<br>
  <br>
&nbsp;&nbsp;&nbsp; Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
&nbsp;&nbsp;&nbsp; conn.open Application(&quot;spps&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;Delete from award_question 
  where id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp; conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;Delete from award_answer where 
  id=&quot; &amp; id<br>
&nbsp;&nbsp;&nbsp; conn.execute(sql)<br>
  response.redirect &quot;manager.asp&quot;<br>
  %&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>list.ap : 列出某一題答對的學生的排行榜</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial"><font color="#990000">&lt;%<br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  conn.open Application(&quot;spps&quot;)<br>
&nbsp;&nbsp;&nbsp; id = Request(&quot;id&quot;)<br>
&nbsp;&nbsp;&nbsp; id = replace(id,&quot;'&quot;,&quot;&quot;)<br>
&nbsp;&nbsp;&nbsp; if id=&quot;&quot; then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sql = &quot;select max(id) from 
  award_question where post_date &lt; getdate()&quot;<br>
  </font><font color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' 
  SQL中要用getdate()函數來取日期，不可以用now() 函數</font><font color="#990000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set rs=conn.execute(sql)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; if not rs.eof then id = rs(0)<br>
&nbsp;&nbsp;&nbsp; end if<br>
  %&gt;</font><br>
  &lt;html&gt;&lt;head&gt;&lt;title&gt;得獎名單&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;&lt;h1 align=&quot;center&quot;&gt;&lt;font face=&quot;標楷體&quot; color=&quot;#000080&quot;&gt;得獎名單&lt;/font&gt;&lt;/h1&gt;&lt;hr&gt;<br>
  <font color="#990000">&lt;% if id&lt;&gt;&quot;&quot; then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </font>
  <font color="#FF0000">’ 有題號的話</font><font color="#990000"><br>
&nbsp;&nbsp;&nbsp; sql = &quot;select * from award_question where id=&quot; &amp; id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </font>
  <font color="#FF0000">’ 從資料表裡找到這題</font><font color="#990000"><br>
&nbsp;&nbsp;&nbsp; set rs1=conn.execute(sql)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; grade = rs1(&quot;grade&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=0 then desc=&quot;低年級&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=1 then desc=&quot;中年級&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if grade=2 then desc=&quot;高年級&quot;<br>
&nbsp;&nbsp;&nbsp; quiz = rs1(&quot;question&quot;)<br>
&nbsp;&nbsp;&nbsp; correct = rs1(&quot;correct&quot;)<br>
  %&gt;<br>
  </font>第<font color="#990000">&lt;% =id %&gt;</font>期&lt;/b&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;table border=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;對　　象：&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">&lt;% =desc %&gt;　</font>&lt;/td&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;題　　目：&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">&lt;% =quiz %&gt;</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;正確答案：&lt;/font&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">&lt;% =correct %&gt;　</font>&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  &lt;/table&gt;<br>
  &lt;table border=&quot;1&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;學號&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;班級&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;姓名&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;答案&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#990000">&lt;%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">’ 選出題目資料表中，這題答對的同學，照年班級排序</font><font color="#990000"><br>
  sql = &quot;select * from award_answer where id=&quot; &amp; id &amp; &quot; and correct=1 order by 
  classno&quot;<br>
  set rs2=conn.execute(sql)</font></font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial"><font color="#990000">while not rs2.EOF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
  <font color="#FF0000">’ 如果資料錄不是空的</font><font color="#990000"><br>
&nbsp;&nbsp;&nbsp; stdno = rs2(&quot;stdno&quot;)<br>
&nbsp;&nbsp;&nbsp; classno = rs2(&quot;classno&quot;)<br>
&nbsp;&nbsp;&nbsp; stdname = rs2(&quot;student&quot;)<br>
&nbsp;&nbsp;&nbsp; answer = rs2(&quot;answer&quot;)<br>
  %&gt;</font><br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">&lt;% =stdno %&gt;</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">&lt;% =classno %&gt;</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">&lt;% =stdname %&gt;</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td &gt;<font color="#990000">&lt;% =answer %&gt;</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#990000">&lt;%<br>
&nbsp;&nbsp;&nbsp; rs2.movenext<br>
&nbsp;&nbsp;&nbsp; wend<br>
  %&gt;<br>
  </font>&lt;/table&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/center&gt;&lt;/div&gt;<br>
  <font color="#990000">&lt;% else %&gt;</font><br>
  &lt;center&gt;&lt;font size=&quot;5&quot; color=&quot;#FF0000&quot;&gt;得獎名單正在審核中，目前還無法公佈！&lt;/font&gt;&lt;/center&gt; <br>
  <font color="#990000">&lt;% end if %&gt; </font><br>
  &lt;/body&gt;&lt;/html&gt;</font></p>
    </div>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font color="#0000FF" face="Arial" size="2"><b>sort.asp : 列出所有答對的學生的總排行榜</b></font></p>
    <div style="border-style: solid; border-width: 1; padding-left: 4; padding-right: 4; padding-top: 1; padding-bottom: 1">
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial"><font color="#990000">&lt;%<br>
  Set Conn = Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
  conn.open Application(&quot;spps&quot;)<br>
  <br>
&nbsp;&nbsp;&nbsp; sql = &quot;select stdno,classno,student,count(correct) as total 
  from award_answer where correct=1 group by stdno,classno,student order by 
  total desc,classno&quot;<br>
&nbsp;&nbsp;&nbsp; Set rs2=conn.execute(sql)<br>
  %&gt;<br>
  </font>&lt;html&gt;&lt;head&gt;&lt;title&gt;排行榜&lt;/title&gt;&lt;/head&gt;<br>
  &lt;body&gt;</font></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font size="2" face="Arial">&lt;table border=&quot;1&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt;<br>
  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;學號&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;班級&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;姓名&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;答對次數&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#990000">&lt;%<br>
  while not rs2.EOF<br>
&nbsp;&nbsp;&nbsp; stdno = rs2(&quot;stdno&quot;)<br>
&nbsp;&nbsp;&nbsp; classno = rs2(&quot;classno&quot;)<br>
&nbsp;&nbsp;&nbsp; stdname = rs2(&quot;student&quot;)<br>
&nbsp;&nbsp;&nbsp; total = rs2(&quot;total&quot;)<br>
  %&gt;<br>
  </font>&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">&lt;% =stdno %&gt;　</font>&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">&lt;% =classno %&gt;　</font>&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">&lt;% =stdname %&gt;</font>　&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;td&gt;<font color="#990000">&lt;% =total %&gt;</font>　&lt;/td&gt;<br>
  &lt;/tr&gt;<br>
  <font color="#990000">&lt;%<br>
&nbsp;&nbsp;&nbsp; rs2.movenext<br>
&nbsp;&nbsp;&nbsp; wend<br>
  %&gt;</font><br>
  &lt;/table&gt;<br>
  &lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;default.asp&quot;&gt;回有獎徵答首頁&lt;/a&gt;&lt;/p&gt;<br>
  &lt;/center&gt;&lt;/body&gt; &lt;/html&gt;</font></p>
    </div>
<blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  　</p>
</blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700">
  <font size="4">八、</font></span><b><font size="4">測試程式和偵錯</font></b></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  &nbsp;&nbsp;&nbsp; 良好的程式測試程序和偵錯，是需要至少一位專業的測試員來做的專職工作，他需要看得懂 html 
  標籤語法、具備基礎的ＡＳＰ程式撰寫能力、還要有系統管理能力、HTTP協定 Server / Client 
  工作原理的熟悉、和多方試探的好奇心、及超人一等的耐性及偵錯敏感度。</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  去哪裡找這種人？</p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  &nbsp;&nbsp;&nbsp; 一個好的程式設計師一定是個好測試員。找不到幫手，就自己動手吧！</p>
  <ol>
    <li>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  測試程式時我們最好開啟IIS中的內容→應用程式名稱→設定：<br>
  <img border="0" src="images/ASP.31.gif" width="467" height="477"><br>
  〝啟用ＡＳＰ用戶端指令偵錯〞和〝將詳細的ASP錯誤訊息傳送給用戶端〞選項勾選。<br>
  <img border="0" src="images/ASP.32.gif" width="406" height="416"></p>
    </li>
    <li>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  對於SQL語法錯誤的部分，我們可印出SQL字串來判斷。例如：<br>
  <font color="#990000" size="2" face="Arial">..........略..........<br>
  sql = &quot;select stdno,classno,student,count(correct) as total from award_answer 
  where correct=1 group by stdno,classno,student order by total desc,classno&quot;<br>
  </font><font color="#0000FF" size="2" face="Arial"><b>response.wriet sql<br>
  response.end</b><br>
  </font><font color="#990000" size="2" face="Arial">Set rs2=conn.execute(sql)<br>
  .........略...........</font></p>
    </li>
    <li>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">如果是程式運算中的變數值有錯，我們可以秀出來檢查。例如：<br>
  <font color="#990000" size="2">&lt;script&gt;</font><font color="#0000FF"><font size="2"><b>alert('&lt;%=stdn<span lang="en-us">ame</span>%&gt;'</b></font><span lang="en-us">)</span></font><font color="#990000" size="2">&lt;/script&gt;</font></font></p>
    </li>
    <li>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">需要模擬學生的帳號權限，我們可以〝小心地〞考慮使用一組萬用密碼作為開發程式測試用。<br>
  實做上，可以修改 check2.asp 內容讓程式判斷密碼只要是特定字串，檢查就算通過。例如：</font></p>
    <table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="80%" id="AutoNumber31">
      <tr>
        <td width="100%">.....略.......<br>
&nbsp; <font color="#FF0000">&nbsp; if inputpass=&quot;54_Student&quot; then pwd_passed = 
        1<br>
&nbsp;&nbsp;&nbsp;&nbsp; .........<br>
&nbsp;&nbsp;&nbsp; end if</font><p>.....略.......</td>
      </tr>
    </table>
    </li>
    <li>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <font face="Arial">使用萬用密碼時要特別注意：<br>
  選用文數字混用的無規則可循的密碼，不容易被猜到<br>
  此事需嚴格保密<br>
  使用後要清除ＩＥ的密碼記憶功能<br>
  限制網芳讀取該資料夾的權限</font></p>
    </li>
    <li>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">從網路</span><span style="letter-spacing: 1pt; vertical-align: baseline">抓回來了<span lang="en-us">
  </span>ASP<span lang="en-us"> </span>程式，解壓縮開，拷貝放到自己網站上後，發現網頁出現類似〝資料庫必須使用更新查詢....〞等錯誤訊息畫面，這多半是<span lang="en-us"> 
  MDB </span>檔寫入權限設定的問題。因為<span lang="en-us"> </span>WINDOWS 
  NT/2000<span lang="en-us"> </span>的 IIS 伺服器它的執行的身分是：IUSER_你的主機名稱。ASP<span lang="en-us">
  </span>程式要將資料寫入資料庫也是使用這個使用者身分，因此 <span lang="en-us">MDB</span> 
  資料庫檔要記得給這個使用者能讀取和寫入的權限。使用<span lang="en-us"> </span>SQL Server 作為後端資料庫，則可以避免這類錯誤。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">　</span><span style="letter-spacing: 1pt; vertical-align: baseline">舉例來說，以學校神通標案的<span lang="en-us">
  </span>WEB 
  SEVER<span lang="en-us"> </span>來架站，電腦名稱叫做 WEB，網路上所有來<span lang="en-us">
  </span>WEB<span lang="en-us"> </span>這台主機觀賞網頁的瀏覽者，身分都是&#65339;IUSER_WEB&#65341;。</span></p>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">
  　　因為放在<span lang="en-us"> </span>NTFS<span lang="en-us"> </span>上，所以我們還必須把 wwwroot 資料夾中的檔案和<span lang="en-us">
  </span>MDB<span lang="en-us"> </span>資料庫權限， 指定給這個使用者，以下是權限設定：</span></p>
  <div align="center">
    <center>
    <table id="AutoNumber32" style="border-collapse:collapse" cellSpacing="0" cellPadding="0" width="78%" border="1" fpstyle="8,011111100" bordercolor="#111111" bordercolorlight="#808080" bordercolordark="#C0C0C0">
      <tr>
        <td style="font-weight: bold; color: white; border-style: solid; border-width: 1" align="middle" width="31%" bgcolor="#C0C0C0">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline; font-weight: 400">
        <b>物件種類</b></font></span></td>
        <td style="font-weight: bold; color: white; border-style: solid; border-width: 1" align="middle" width="69%" bgcolor="#C0C0C0">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline; font-weight: 400">
        <b>權限設定</b></font></span></td>
      </tr>
      <tr>
        <td style="font-weight: bold; color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="31%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline; font-weight: 400">
        資料夾</font></span></td>
        <td style="color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="69%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline">改為 &#65339;IUSER_你的主機名稱&#65341; 
        可讀取，執行（進入）</font></span></td>
      </tr>
      <tr>
        <td style="font-weight: bold; color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="31%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline; font-weight: 400">
        ASP或HTML檔案</font></span></td>
        <td style="color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="69%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline">改為 &#65339;IUSER_你的主機名稱&#65341; 
        可讀，指令</font></span></td>
      </tr>
      <tr>
        <td style="font-weight: bold; color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="31%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline; font-weight: 400">
        MDB檔</font></span></td>
        <td style="color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="69%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline">改為 
        &#65339;IUSER_你的主機名稱&#65341;可讀取，寫入</font></span></td>
      </tr>
      <tr>
        <td style="font-weight: bold; color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="31%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline; font-weight: 400">
        要提供上傳檔案的資料夾[UPLOAD]</font></span></td>
        <td style="color: white; border-left-style: solid; border-left-width: 1; border-right-style: solid; border-right-width: 1; border-top: 1px solid aqua; border-bottom-style: solid; border-bottom-width: 1" width="69%">
        <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
        <span style="letter-spacing: 1pt">
        <font color="#000000" style="vertical-align: baseline">改為 
        &#65339;IUSER_你的主機名稱&#65341;可讀取，執行，寫入</font></span></td>
      </tr>
    </table>
    </center>
  </div>
    </li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    在校內架設 Windows2000 SERVER+ IIS5.0 WEB 伺服器時，要讓校外也能連到，要處理以下事項： </span>
    <ul>
      <li>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">真實網域的 IP 
      設定，如:163.21.224.4和 NAT 對應設定</span></li>
      <li>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      在防火牆上設定〝AnyNet－to－你的電腦－http通訊協定－[port80]－Any Time放行〞。 
      若有開放FTP還要再加一條:〝AnyNet－to－你的電腦－FTP 通訊協定－[port21]－Any Time放行〞。</span></li>
      <li>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      因為架站要２４小時開機，所以應該準備一台UPS，並在&#65339;控制台&#65341;－&#65339;電源選項&#65341;－&#65339;ＵＰＳ&#65341;中設定好選項，並將ＵＰＳ服務啟動。 </span></li>
      <li>
      <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">必須在校內、對外的兩台DNS 
      上主機上登錄名稱，否則您的網站只能使用IP連結，而不能使用Domain Name。 </span></li>
    </ul>
    </li>
  </ol>
  </blockquote>
<hr>
  <blockquote>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">　</p>
</blockquote>
</font></font></font></font></font></font></font>
<font size="4" color="#800000"&gt;&lt;%&lt;/font&gt;&lt;/font&gt;&lt;font face=" Arial" face="Arial"> 
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
<span style="vertical-align: baseline; font-weight: 700">陸</span></font><font size="2" face="Arial" color="#800000"&gt;&lt;%&lt;/font&gt;&lt;/font&gt;&lt;font face=" Arial"><span style="letter-spacing: 1pt; vertical-align: baseline; font-weight: 700"><font size="4">、
安裝/修改別人寫的<span lang="en-us"> ASP </span>程式</font></span></p>
  <blockquote>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">　</span><span style="letter-spacing: 1pt; vertical-align: baseline">　這裡提供的範例程式都經過測試和篩選，算是適合大多數老師入門所需。其中多半是從網路找來。這些不藏私的程式設計師開發的<span lang="en-us">
  </span>ASP<span lang="en-us"> </span>程式願意分享給大家，是我們的福氣。</span><span style="vertical-align: baseline; letter-spacing: 1pt"><font color="#800000"><a href="http://dd.ysps.tp.edu.tw/html/7.asp">範例程式</a></font>都已用<span lang="en-us"> 
  ZIP </span>打包，使用下載打包版前請詳細閱讀以下步驟：</span></p>
  <ol>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    下載回去後，暫時存到桌面，有安裝ZIP解壓縮程式的話，按滑鼠右鍵選擇&#65339;解壓縮到.....資料夾&#65341;，解壓縮所有檔案到桌面的ＸＸＸ資料夾，要還原壓縮檔原有的目錄結構。 
    </span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    執行&#65339;FrontPage0&#65341;，點&#65339;檔案&#65341;－&#65339;開啟ＷＥＢ&#65341;&#65339;輸入你的網址 ：例如 
    <a href="http://www.ysps.tp.edu.tw/dd/">http://www.ysps.tp.edu.tw/</a>&#65341; 
    在區網的話可以輸入UNC路徑： <a href="file://dd/wwwroot">\\dd\wwwroot</a> 。</span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">輸入您的帳號密碼 
    。若是您沒有輸入密碼就可以進入，您的網站安全漏洞可就大了。 </span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    等資料夾都列出來後，按&#65339;檢視&#65341;－&#65339;資料夾清單&#65341;開啟資料夾清單 。 </span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    按&#65339;顯示桌面&#65341;先切換到&#65339;桌面&#65341;－&#65339;複製 &#65341;剛才解壓縮好的資料夾，－&#65339;貼在資料夾清單&#65341;的&#65339;根目錄&#65341;下，FrontPage會 
    自動把該資料夾自動上傳到您的網站。 </span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">把要設定的檔案和資料夾權限設定好 
    </span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">開啟瀏覽器，輸入網址測試單一ASP套件是否成功 </span>
    </li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    製作網頁來連結這些新網頁的新功能。 </span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    安裝新套件之前，請一定要先詳細閱讀每個套件裡面原作者的說明文件。 </span></li>
    <li>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
    <span style="letter-spacing: 1pt; vertical-align: baseline">
    所有套件程式中的MDB資料庫，只要有帳號密碼資料在的 
    ，一定要放在〝別人不知道和猜不到的位置〞，不然網路上大駭小駭彼彼皆是，萬一重要的資料庫透過網址列被下載抓走，&#65339;<font color="#3776bb"><a href="http://dd.ysps.tp.edu.tw/counter/counter1.mdb">點這裡試試看</a></font>抓資料庫&#65341;，你的網站就完全
    落在別人的掌控之中了。 </span></li>
    <li>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="vertical-align: baseline">SQL的效能高過MDB甚多，如果想要把</span><span style="vertical-align: baseline; letter-spacing: 1pt">MDB檔資料庫轉到SQL 
  Server ，轉換的步驟如下：</span></p>
    </li>
    <li>
  <div align="center">
    <center>
    <table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#111111" width="85%" id="AutoNumber10">
      <tr>
        <td width="100%" style="border-style: none; border-width: medium">
        <blockquote>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟一、確認你的<span lang="en-us"> </span>ASP<span lang="en-us"> </span>程式能以<span lang="en-us">
            </span>mdb<span lang="en-us"> </span>方式正常執行。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟二、開啟MSSQL（需以管理員身分登入）開啟SQL的企業管理員(Enterprise Manager)主控台。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟三、新增一個資料庫，例如取名為「YSPS」。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟四、把資料庫MDB檔拷貝到這台SQL Server 上，例如：桌面。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">步驟五、將 
            此MDB檔匯入資料庫 YSPSWEB。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟六、以文字編輯器開啟你的虛擬目錄下的 global.asa 內容，把開啟資料庫的連結字串變成 Application。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟七、開啟所有套件中的ASP程式裡面，修改開啟資料庫連結的方式和程式碼。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟八、上網測試程式，並修改ASP程式碼到能正常工作。</span></p>
            <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
            <span style="letter-spacing: 1pt; vertical-align: baseline">
            步驟九、安排資料庫備份排程，備份資料庫到安全的地方。</span></p>
          </blockquote>
        </td>
      </tr>
    </table>
    </center>
  </div>
    </li>
  </ol>
  <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8">
  <span style="letter-spacing: 1pt; vertical-align: baseline">以下<span lang="en-us"> 
  ASP </span>程式您可以在<a target="main" href="http://dd.ysps.tp.edu.tw/html/13.asp">這裡 
  http://dd.ysps.tp.edu.tw/html/13.asp</a>下載。</span></p>
  <table style="font-size: 11pt; line-height: 150%; border-collapse: collapse" borderColor="#111111" cellSpacing="0" borderColorDark="#C0C0C0" cellPadding="4" width="90%" borderColorLight="#808080" border="1">
    <tr>
      <td align="middle" width="81%" bgColor="#6397d1" height="22">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <font color="#FFFFFF">ＡＳＰ範例程式</font></span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="169">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font>WEB檔案管理員</a> 
      範例<a href="http://dd.ysps.tp.edu.tw/manager/index.asp">http://dd.ysps.tp.edu.tw/manager/index.asp</a>
      </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">[作者 :
      <font color="#3776bb"><a href="http://mail.spps.tp.edu.tw/~shane">李忠憲</a></font>]&nbsp;。相當不錯的照片、檔案下載工具，透過網芳或ftp上傳，只要分類建好目錄，並拖入各個資料夾，此asp程式會利用FSO物件，即時產生線上網頁，如果資料夾含〔背景】兩字，程式會把該圖片自動作成背景圖。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="139">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/photo/manager.asp">【圖片素材庫】</a>
      <a href="http://dd.ysps.tp.edu.tw/photo/manager.asp">
      http://dd.ysps.tp.edu.tw/photo/manager.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">這是資源豐富的<a href="http://dd.ysps.tp.edu.tw/photo/manager.asp">花蓮教網陳立輝先生</a>修改<font color="#3776bb"><a href="http://mail.spps.tp.edu.tw/~shane">李忠憲</a></font>老師的檔案管理員，並加入了一大堆新功能，包括搜尋、人氣、排行、留言版、網友上傳[當然需安裝<font color="#3776bb"><a href="http://dd.ysps.tp.edu.tw/photo/BASP21.exe">BASP21.exe</a></font>上傳元件才能使用上傳功能]、好站介紹等。維護上因為要做檔案流水號和縮圖，使用管理稍微複雜，mdb路徑記得要修改[0729更正]&nbsp; 
      詳請參閱<a href="http://dd.ysps.tp.edu.tw/photo/使用說明.htm">使用說明</a></span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="161">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/calendar/index.htm">學校行事曆系統</a>&nbsp;
      <a href="http://dd.ysps.tp.edu.tw/calendar/index.htm">
      http://dd.ysps.tp.edu.tw/calendar/index.htm</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">[作者 : 
      萬芳國小]這是大家耳熟能詳的行事曆，也修改了一些小BUG，如果想要把今天的行事放在跑馬燈，<a href="http://www.ysps.tp.edu.tw/">嵌入您的首頁</a>的話，請用 
      &nbsp;[dd改寫]，或<a href="http://dd.ysps.tp.edu.tw/calendar/show_today.asp">今日行事速查</a>&nbsp;[dd改寫]，不含帳號認證模組，下載後解開來，放到c:\inetpub\wwwroot\calendar中，把資料庫權限改為IUSER_主機名稱，可讀寫即可，若放到其他資料夾，需修改資料庫路徑，搭配萬芳的權限認證模組<a href="http://dd.ysps.tp.edu.tw/zip/pwd.zip">[pwd.zip</a>]即可使用。</span></td>
    </tr>
    <tr>
      <td vAlign="top" width="81%" bgColor="#ffffff" height="183">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/board/index.asp">最新消息公告版</a>[逸仙 
      用的行政公佈欄]&nbsp; <a href="http://dd.ysps.tp.edu.tw/board/index.asp">
      http://dd.ysps.tp.edu.tw/board/index.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">[作者 : 
      萬芳國小]dd修改版] 此版加入意表icon和連結<a href="http://dd.ysps.tp.edu.tw/short/index.asp">逸仙短語集</a>，<a href="http://dd.ysps.tp.edu.tw/calendar/show_.asp">今日行事跑馬燈</a>，ettoday 
      等 iframe ，需<font color="#3776bb"><a href="http://dd.ysps.tp.edu.tw/photo/BASP21.exe">BASP21.exe</a></font> 
      上傳檔案用的模組，下載後解開來，放到c:\inetpub\wwwroot\calendar中，若放到其他資料夾，需修改資料庫路徑，把資料庫權限改為IUSER_主機名稱可讀寫，upload資料夾權限可讀寫、及可執行即可。張貼完成會自動寄發電子郵件&#65339;已註解暫停&#65341;給全校老師，但因各校要求老師收電子郵件和推動ＷＥＢ化晨會情況不一，請視情況開放。搭配萬芳的權限認證模組<a href="http://dd.ysps.tp.edu.tw/zip/pwd.zip">[pwd.zip</a>]即可使用。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="95">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/bbs/">動網討論區</a> 
      [動網 Aspsky.com]&nbsp; <a href="http://dd.ysps.tp.edu.tw/bbs/">
      http://dd.ysps.tp.edu.tw/bbs/</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">作者：動網 
      Aspsky.com。中國大陸動網開發的超強多人使用的討論區[論壇系統]，阿言中文化。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="95">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/counter/counter.asp">mdb版計數器</a>&nbsp;
      <a href="http://dd.ysps.tp.edu.tw/counter/counter.asp">
      http://dd.ysps.tp.edu.tw/counter/counter.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      作者：奕名。最多人使用的圖形計數器，可紀錄今天、昨天和訪客總數，若放到其他資料夾，需修改資料庫路徑。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="95">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/研習報名/showclass.asp">研習課程查詢</a>[作者 
      : 李忠憲]&nbsp; <a href="http://dd.ysps.tp.edu.tw/研習報名/showclass.asp">
      http://dd.ysps.tp.edu.tw/研習報名/showclass.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      功能算是完備的研習課程查詢，可自動寄發電子郵件給報名者。至於介面....就...，搭配萬芳的權限認證模組<a href="http://dd.ysps.tp.edu.tw/zip/pwd.zip">[pwd.zip</a>]即可使用。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="95">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/online/onlinemsg.asp">線上人數 
      [含線上飛鴿傳書]</a>&nbsp;
      <a href="http://dd.ysps.tp.edu.tw/online/onlinemsg.asp">
      http://dd.ysps.tp.edu.tw/online/onlinemsg.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      算很有趣的線上人數計數器，可顯示來訪者的ip，不用資料庫，可一對一線上對談，傳書來時，和寄出時都有音效。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="73">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/music/music.asp">隨機撥放背景音樂</a>&nbsp;
      <a href="http://dd.ysps.tp.edu.tw/music/music.asp">
      http://dd.ysps.tp.edu.tw/music/music.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">[作者 : 
      李忠憲]也是用FSO物件讀取目錄內的音樂檔，隨機亂數取一個當背景音樂</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="117">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/short/index.asp">逸仙短語集</a>&nbsp;
      <a href="http://dd.ysps.tp.edu.tw/short/index.asp">
      http://dd.ysps.tp.edu.tw/short/index.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      這是我們校長的點子，他希望能一進網頁順便看到一些勵志話語，我使用下面這個 
      <a href="http://dd.ysps.tp.edu.tw/vbjoke/index.asp">每日一笑</a>&nbsp; 改出來的， 
      <a href="http://dd.ysps.tp.edu.tw/short/add.asp">新增短語</a> 
      的功能需加上權限認證&#65339;為方便測試已移除張貼權限&#65341;，若放到其他資料夾，需修改資料庫路徑。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="95">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/小桶子留言版/CuteBook.asp">小桶子留言版</a>&nbsp;[作者 
      : 小桶子] <a href="http://dd.ysps.tp.edu.tw/小桶子留言版/CuteBook.asp">
      http://dd.ysps.tp.edu.tw/小桶子留言版/CuteBook.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      用氣泡顯示方式顯示留言，蠻可愛的留言版。回硬漢管理功能的刪除留言的位置設計的有點怪，不過用過一次就知道了。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="84">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/線上日誌/news.asp">每日芝麻事</a>&nbsp;
      <a href="http://dd.ysps.tp.edu.tw/線上日誌/news.asp">
      http://dd.ysps.tp.edu.tw/線上日誌/news.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      線上新聞或班級的活動紀錄，作為線上日誌也不錯，若放到其他資料夾，需修改資料庫路徑</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="84">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/線上測驗/enter.asp">線上考試系統</a> 
      題目 <a href="http://dd.ysps.tp.edu.tw/線上測驗/enter.asp">
      http://dd.ysps.tp.edu.tw/線上測驗/enter.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      線上能算初應試者成績，題目需要用ACCESS開資料庫編是比較麻煩的地方</span></td>
    </tr>
    <tr>
      <td width="80%" bgColor="#ffffff" height="84">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/tf/index.asp">ＫＭ知識管理系統－資料庫(Access)版</a>[作者 
      : simon] <a href="http://dd.ysps.tp.edu.tw/tf/index.asp">
      http://dd.ysps.tp.edu.tw/tf/index.asp</a>&nbsp; </span></td>
    </tr>
    <tr>
      <td width="80%" bgColor="#ffffff" height="32">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a>陽春型<a href="http://dd.ysps.tp.edu.tw/安安行事曆/login.asp">安安行事曆</a>
      <a href="http://dd.ysps.tp.edu.tw/安安行事曆/login.asp">
      http://dd.ysps.tp.edu.tw/安安行事曆/login.asp</a> </span></td>
    </tr>
    <tr>
      <td width="80%" bgColor="#ffffff" height="32">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a>陽春型<a href="http://dd.ysps.tp.edu.tw/goodweb/index.asp">網站評鑑</a>
      <a href="http://dd.ysps.tp.edu.tw/goodweb/index.asp">
      http://dd.ysps.tp.edu.tw/goodweb/index.asp</a> </span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="106">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/doc/fm.asp">水瓶柘榴子檔案總管</a>
      <a href="http://dd.ysps.tp.edu.tw/doc/fm.asp">
      http://dd.ysps.tp.edu.tw/doc/fm.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      簡單方便，純文字，無圖片，能瀏覽開啟檔案，也能上傳的web檔案管理員</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="74">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/win2000線上變更密碼/w2kchpasswd.asp">win2000線上變更密碼</a>[作者 
      : 蔡俊彥] <a href="http://dd.ysps.tp.edu.tw/win2000線上變更密碼/w2kchpasswd.asp">
      http://dd.ysps.tp.edu.tw/win2000線上變更密碼/w2kchpasswd.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">這是<a href="http://dd.ysps.tp.edu.tw/win2000線上變更密碼/winchpasswd.htm">Server管理員用專用，不適合一般老師</a>　說明檔:<a href="http://dd.ysps.tp.edu.tw/win2000線上變更密碼/winchpasswd使用手冊.htm">winchpasswd 
      v1.0 線上更改密碼程式</a></span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="95">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/ip/index.asp">校園網路IP管理</a>
      <a href="http://dd.ysps.tp.edu.tw/ip/index.asp">
      http://dd.ysps.tp.edu.tw/ip/index.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">這是逸仙早期的ip管理[C 
      Class等級固定ip]，現行的版本加上了各欄位排序功能，和使用者上網次數統計&#65339;尚未整理完成&#65341;。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="106">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/笑傲江湖/1index.htm">笑傲江湖網路社區聊天室1.0</a>[原著:<a href="mailto:yebi001@sohu.com">野比俱樂部</a>修改 
      :正和] <a href="http://dd.ysps.tp.edu.tw/笑傲江湖/1index.htm">
      http://dd.ysps.tp.edu.tw/笑傲江湖/1index.htm</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      非常有趣的另類聊天室，就像闖蕩江湖探險般，有武俠風格的ＭＵＤ多人聊天室。同是中國大陸網站的作品，一定要修改資料庫密碼和路徑。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="202">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a><a href="http://dd.ysps.tp.edu.tw/repair/index.htm">修繕登記</a> 
      [作者 : 萬芳國小] <a href="http://dd.ysps.tp.edu.tw/repair/index.htm">
      http://dd.ysps.tp.edu.tw/repair/index.htm</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      既然登記了就是希望能查閱追修時程，全校一份就好了，這一份我修改過部份內容，因為本校負責的人各有不同，於是分為三個表單，分別處理<br>
      〔教學設備報修】→總務處、設備組負責<br>
      〔電腦軟體報修】系統師、資訊組負責<br>
      〔電腦硬體報修】的報修→總務處負責。</span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      報修完成會自動寄發電子郵件給負責人，工作完成也能自動寄發給報修人。</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="61">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/score/score.asp"><font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a>
      <font color="#3776bb"><a href="http://dd.ysps.tp.edu.tw/score/score.asp">
      學生榮譽點數超級比一比</a></font> <a href="http://dd.ysps.tp.edu.tw/score/score.asp">
      http://dd.ysps.tp.edu.tw/score/score.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">這是以Java 
      Script作資料的排序，滿好用的。SCRIPT下載 :<font color="#3776bb"><a href="http://www.dob.com.tw">http://www.dob.com.tw</a></font>&nbsp; 
      ，本範例加上了ＡＳＰ＋ＭＤＢ作為資料庫讀取動作，寫入／管理部分尚未完成。--黃自強]</span></td>
    </tr>
    <tr>
      <td width="81%" bgColor="#ffffff" height="224">
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      <a href="http://dd.ysps.tp.edu.tw/manager/index.asp">
      <font color="#3776bb">
      <img src="images/HA010[1].gif" align="absMiddle" border="0" width="32" height="32"></font></a>WEB<a href="http://dd.ysps.tp.edu.tw/Alpha/Default.asp">線上檔案管理系統</a> 
      [作者 : <font color="#ffffff"><a href="http://www.bckps.edu.hk">Copyright by 
      Dino Cho 2001</a></font>]
      <a href="http://dd.ysps.tp.edu.tw/Alpha/Default.asp">
      http://dd.ysps.tp.edu.tw/Alpha/Default.asp</a> </span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8">
      <span style="letter-spacing: 1pt; vertical-align: baseline">
      超強網站管理員，可線上新增、刪除檔案和資料夾，並可線上編輯文字檔，包括ａｓｐ程式，ｈｔｍｌ文件等。整包丟入wwwroot再把mdb檔放在其他地方，程式中的資料庫路徑一定要改掉，密碼也要改掉。</span></p>
      <p style="word-spacing: 1; margin-top: 8; margin-bottom: 8"></font>
      <span style="letter-spacing: 1pt; vertical-align: baseline">使用請注意:<br>
      １.只有管理員才能用，虛擬目錄不適用。<br>
      ２.本程式資料庫密碼要用鎖定開啟才能修改。&#65339;密碼為：＊＊＊＊&#65341;</span></td>
    </tr>
  </table>
<p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
<span style="letter-spacing: 1pt; vertical-align: baseline">
最後請把您寫的或修改的ASP程式分享給大家<font color="#3776bb">→<a href="http://dd.ysps.tp.edu.tw/downasp/add.asp">發表您的程式</a></font></span><span style="vertical-align: baseline; letter-spacing: 1pt">。</span></p>
  <blockquote>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">　</p>
  </blockquote>
</blockquote>

	</font>

    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <font size="2" face="Arial" color="#800000"&gt;&lt;%&lt;/font&gt;&lt;/font&gt;&lt;font face=" Arial">
	<span style="letter-spacing: 1pt; vertical-align: baseline; font-weight:700">
    <font size="4">柒、</font></span></font><font size="2" face="Arial" color="#800000"&gt;&lt;%&lt;/font&gt;&lt;/font&gt;&lt;font face=" Arial"><span style="letter-spacing: 1pt; vertical-align: baseline; font-weight:700"><font size="4">參考資料 </font> </span></p>

    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="vertical-align: baseline">石牌國小李忠憲老師　<a href="http://www.spps.tp.edu.tw/documents/Detail.asp?TitleID=115">ASP 
    概論</a>　<a href="http://www.spps.tp.edu.tw/documents/Detail.asp?TitleID=115">http://www.spps.tp.edu.tw/documents/Detail.asp?TitleID=115</a>　</span></p>
    <p style="line-height: 150%; word-spacing: 1; margin-top: 8; margin-bottom: 8" align="left">
    <span style="letter-spacing: 1pt; vertical-align: baseline">SQL tutorial at 
    W3School </span></p>
      </font>
</body>
</html>