    'oSw旒篇杭痞r
    '_Num : OnullNメXnullAΤ趣~o计r
		'_Val : nBzValue
    'i : 1 应旒 2 B旒 3 κ旒 H姑崩
    Function getDigi(ByVal _Num As Object, ByVal _Val As Object, ByVal i As Integer) As String
        Dim dOrigi As Decimal
        Dim lPrem As Long
        If isNull(_Num) Then Return ""
        dOrigi = CDec(nvl(_Val, "0"))
        lPrem = CLng(dOrigi Mod (10 ^ i))
        lPrem = CLng(lPrem) \ CLng(10 ^ (i - 1))
        If i = 1 Then
            Return lPrem.ToString
        ElseIf i > 1 AndAlso dOrigi >= CLng(10 ^ (i - 1)) Then
            Return lPrem.ToString
        End If
        Return ""
    End Function
    
    'NDataRowODBNull耗姒臁A峨Jw]取ANullNumberValueMNullStringValuepGSΤ]ANO]wDBNull
    Private Sub setEmptyAndDBNull(ByRef _dr As Object, Optional ByVal NullNumberValue As Decimal = -1, Optional ByVal NullStringValue As String = Nothing)
        If IsNothing(_dr) OrElse Not TypeOf _dr Is DataRow Then Exit Sub
        Dim dr As DataRow = CType(_dr, DataRow)

        For Each col As DataColumn In dr.Table.Columns
            Dim tp As Type = col.DataType
            If Not col.ColumnName.Equals("IOBJ_ID_1") Then
                If IsDBNull(dr(col.ColumnName)) OrElse dr(col.ColumnName).ToString.Trim.Length = 0 Then
                    If tp Is GetType(String) Then
                        If IsNothing(NullStringValue) Then
                            If col.AllowDBNull Then dr(col.ColumnName) = DBNull.Value
                        Else
                            dr(col.ColumnName) = NullStringValue
                        End If
                    ElseIf tp Is GetType(Decimal) OrElse tp Is GetType(Integer) Then
                        If NullNumberValue = -1 Then
                            If col.AllowDBNull Then dr(col.ColumnName) = DBNull.Value
                        Else
                            dr(col.ColumnName) = NullNumberValue
                        End If
                    End If
                End If
            End If
        Next
    End Sub

    Private Enum Align
        Left
        Right
    End Enum
    ']wオ/kaB恶骸Swrじ
    Private Function PadFormatString(ByVal obj As Object, _
    ByVal maxLength As Integer, _
    ByVal fillChar As String, _
    Optional ByVal align As Align = Align.Right) As String
        Dim oCommon As New PUBEntity.CmnFunction
        Dim sResult As String
        'obj:块Jr
        'maxLength:r瓿踏j
        'fillChar:恶Jrじ
        'align:癸霍よΑ
        If IsNothing(obj) OrElse IsDBNull(obj) OrElse CStr(obj).Trim.Length < 1 Then
            sResult = ""
        Else
            sResult = CStr(obj)
        End If

        If align = align.Left Then
            sResult = Left(oCommon.ansiFillStr(sResult, maxLength, fillChar), maxLength)
        ElseIf align = align.Right Then
            sResult = Right(oCommon.ansiFillStrLeft(sResult, maxLength, fillChar), maxLength)
        End If
        Return sResult
    End Function
    
    'BzUnicode螟r锣传bigyΘ喊莞
    Private Function treatQuestionMark(ByVal _Src As Object) As String
        Dim data() As Byte
        If isNull(_Src) Then Return ""
        data = System.Text.Encoding.Default.GetBytes(_Src.ToString)             ''ずe锣ΘByte
        Dim BigStr As String = System.Text.Encoding.GetEncoding("big5").GetString(data)       ''ずe锣ΘBig5sX寐唳ér
        'r辘お?ノㄢ营钮炸NA锣^Byte
        Return BigStr.Replace("?"c, Space(2))
    End Function    
   
        'P_O坝~(FC)@毽恙v(FR)临O~a侯X(FP)
    Function getIINSKIND(ByVal sIPolicy As String) As String
        If isNull(sIPolicy) OrElse sIPolicy.Length < 7 Then
            Throw New Exception("ERROR IPOLICY")
        End If
        'O虫腹X材せXAYA,C,I,S,W,X,Y 妮蟀臃~Aㄤウhk摸 @毽恙vM~a侯X
        Dim enterprise As Char() = {"A"c, "C"c, "I"c, "S"c, "W"c, "X"c, "Y"c}
        'O虫腹X材せXAYP 妮螬~a侯XAㄤウhk摸挨@毽恙v
        Dim house_combine As String = "P"
        If sIPolicy.Substring(5, 1).IndexOfAny(enterprise) = -1 Then
            '恙v
            If sIPolicy.Substring(5, 1).IndexOf(house_combine) > -1 Then
                '~a侯X
                Return "FP"
            Else
                '@毽恙v
                Return "FR"
            End If
        Else
            '坝~
            Return "FC"
        End If
    End Function
    
    '┰B计r锣いゅ计r,bBig=False pgいゅ bBig=True jgいゅ
    Public Shared Function ConvertCHNum(ByVal Num As Integer, Optional ByVal bBig As Boolean = False) As String
        If Num = 0 Then
            Return "s"
        Else
            Dim cName() As String = {"", "", "Q", "κ", "d", "U", "Q", "κ", "d", "货", "Q", "κ", "d"}
            Dim ar() As String = {"s", "@", "G", "T", "|", "き", "せ", "C", "K", "E"}
            Dim cNum As Integer
            Dim cunit As String
            Dim i, j As Integer
            Dim cZero As Integer
            Dim conver As New StringBuilder
            Dim cLast As String = ""
            Dim Text1 As String = CStr(Num)

            'いゅjg
            If bBig Then
                cName = New String() {"", "", "B", "ㄕ", "a", "U", "B", "ㄕ", "a", "货", "B", "ㄕ", "a"}
                ar = New String() {"s", "滁", "L", "把", "v", "ヮ", "嘲", "m", "", "h"}
            End If

            cZero = 0
            i = 1
            For j = Len(Text1) To 1 Step -1
                cNum = CInt(Val(Mid(Text1, i, 1)))
                cunit = cName(j) 'X旒 
                If cNum = 0 Then 'P_X杭痞rO_0,pGO0,hO魁@ΤX0 
                    cZero = cZero + 1
                    If cunit.IndexOf("U货") > -1 AndAlso (cLast = "") Then 'pGX含OU,货,h旒匹HU货ㄓ干 
                        cLast = cunit
                    End If
                Else
                    If cZero > 0 Then 'pGX杭痞r0Τn,hHsN蠢┮Τ0 
                        If conver.ToString.Substring(conver.Length - 1, 1).IndexOf("U货") = -1 Then
                            conver.Append(cLast) 'pG程幛@欷，O货,U,h程幛@旄嗓W"货U" 
                        End If
                        conver.Append("s")
                        cZero = 0
                        cLast = ""
                    End If
                    If j = 2 AndAlso cNum = 1 AndAlso Len(Text1) = 2 Then
                        conver.Append(cunit)  'pGX杭痞rSΤ0,hOいゅ计r+虫(Q旒啤A氓BO1N菠L) 
                    Else
                        conver.Append(ar(cNum) + cunit) 'pGX杭痞rSΤ0,hOいゅ计r+虫 
                    End If
                End If
                i += 1
            Next
            'P_计r撼太幛@飕O_0,pG程幛@飕0,hрU货干W 
            If InStr("U货", conver.ToString.Substring(conver.Length - 1, 1)) = 0 Then
                conver.Append(cLast) 'pG程幛@欷，O货,U,h程幛@旄嗓W"货U" 
            End If

            Return conver.ToString
        End If
    End Function
    
    '浪芝涟軎~るO_タT
    Public Shared Function isValidRocYYYMM(ByVal sYYYMM As String) As Boolean
        Dim iYYY As Integer
        Dim iMM As Integer

        If IsNothing(sYYYMM) OrElse sYYYMM.Trim = "" OrElse Not IsNumeric(sYYYMM) Then Return False
        If sYYYMM.Length = 4 Then
            sYYYMM = "0" & sYYYMM
        ElseIf sYYYMM.Length <> 5 Then
            Return False
        End If
        iYYY = CInt(sYYYMM.Substring(0, 3))
        iMM = CInt(sYYYMM.Substring(3, 2))
        If iYYY < 60 OrElse iYYY > 200 Then Return False
        If iMM > 12 Then Return False
        Return True
    End Function    

    Private Function IIF(ByVal boo As Boolean, ByVal sTrue As String, ByVal sFalse As String) As String
        If boo Then Return sTrue
        Return sFalse
    End Function

    Private Function substr(ByVal d As Object, ByVal iIndex As Integer, Optional ByVal iLen As Integer = -1) As String
        If isNull(d) OrElse iIndex >= CStr(d).Length Then Return ""

        If iLen < 0 Then
            Return CStr(d).Substring(iIndex)
        Else
            Return CStr(d).Substring(iIndex, iLen)
        End If
    End Function

    'pGj蟮ォ0ANメX"+"A_hNメX"-"
    Function AddOrNot(ByVal amt As Object) As String
        If isNull(amt) Then Return "+"
        Return IIF(CDec(amt) >= 0, "+", "-")
    End Function

    Public Shared Function getWhere(ByVal sProgramID As String, ByVal sOfficerID As String) As String
        Return "WHERE '" & sProgramID & "_" & sOfficerID & "' = '" & sProgramID & "_" & sOfficerID & "'"
    End Function


    